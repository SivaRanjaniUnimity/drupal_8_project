/*! 
    Version: 8.x-6.7.0
    (c) 2021 Acquia Engineering
    Your only rights to use this software are as set out in the Cohesion DX8 terms and conditions available at www.cohesiondx.com/tandc

 */

"use strict";function ownKeys(o,e){var t,n=Object.keys(o);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(o),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),n.push.apply(n,t)),n}function _objectSpread(o){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(o,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(t,e))})}return o}function _defineProperty(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,o){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,r=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(r.push(n.value),!o||r.length!==o);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==t.return||t.return()}finally{if(l)throw i}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,o){if(e){if("string"==typeof e)return _arrayLikeToArray(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(t="Object"===t&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,o):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,n=new Array(o);t<o;t++)n[t]=e[t];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function imceFileBrowserCallback(e,o){var t=angular.element(drupalSettings.cohesion.selectedElement)[0].scope,n=o.imce,i=n.getSelection();t.$apply(function(){t.model=drupalSettings.cohesion.imageBrowser.streamWrapper.name+"://"+n.getItemPaths(i)}),t.closeBrowser()}function entityBrowserCallback(e){var n,o,t,i,r;void 0!==e.contentWindow.drupalSettings&&(n=angular.element(drupalSettings.cohesion.selectedElement)[0].scope,o=e.contentWindow.jQuery,t=e.contentWindow.document,o&&t&&(o(t).ajaxError(function(e,o,t,n){return!1}),o(t).ajaxComplete(function(e,o,t){o=o.responseJSON;new URLSearchParams("?".concat(t.data)).has("media_library_select_form_selection")&&o[1]&&(n.model={entityUUID:o[1].values.attributes["data-entity-uuid"],entityId:o[1].values.attributes["data-entity-uuid"],entityType:o[1].values.attributes["data-entity-type"]},n.closeBrowser())})),void 0!==e.contentWindow.drupalSettings.entity_browser&&(void 0!==e.contentWindow.drupalSettings.entity_browser.modal?i=e.contentWindow.drupalSettings.entity_browser.modal.entities.shift():void 0!==e.contentWindow.drupalSettings.entity_browser.iframe&&(i=e.contentWindow.drupalSettings.entity_browser.iframe.entities.shift()),i&&(r=["entityId","entityUUID","entityType"],n.model=_.reduce(i,function(e,o,t){return e[r[t]]=o,e},{}),n.model.entityId=n.model.entityUUID),n.closeBrowser()))}function cohTagsInput(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",form:"="},bindToController:!0,controllerAs:"cti",templateUrl:"scripts/directives/coh-tags-input/coh-tags-input.html",controller:["$scope","cohModelManager",function(e,o){var t,n={displayProperty:"label",valueProperty:"value",placeholder:"Add a tag",replaceSpacesWithDashes:!1,selectFirstMatch:!1,addFromAutocompleteOnly:!1,addOnBlur:!1};function i(e){return e[t.options.valueProperty]=_.kebabCase(e[t.options.displayProperty]),_.isArray(e)||(e=[e]),o.setValue("colorPaletteTags",_.unionBy(e,o.getValue("colorPaletteTags"),t.options.displayProperty))}function r(e){return o.getValue("colorPaletteTags")}this.$onInit=function(){(t=this).options=_.defaults({},_.get(t,"form.options"),n),i(t.ngModel||[]),t.getTags=r,t.addTag=i}}]}}angular.lowercase=function(e){return e.toLowerCase()},angular.uppercase=function(e){return e.toUpperCase()},angular.module("templates",[]),angular.module("cohesionApp",["ui.sortable","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngAnimate","ngTouch","ui.bootstrap","ng.deviceDetector","schemaForm","pascalprecht.translate","angularSpectrumColorpicker","templates","ngFileUpload","ngOnload","ngToast","angular-uuid","ngTagsInput","mdMarkdownIt"]).config(["$routeProvider","$translateProvider","sfBuilderProvider","$compileProvider","$rootScopeProvider","$animateProvider","$httpProvider","markdownItConverterProvider",function(e,o,t,n,i,r,a,l){n.imgSrcSanitizationWhitelist(/^\s*(https?|local|data|chrome-extension|public|cohesion):/),a.useApplyAsync(!0);a=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}("debug");a&&"false"!==a&&"0"!==a||n.debugInfoEnabled(!1),i.digestTtl(100),r.classNameFilter(/^(?:(?!ng-animate-disabled).)*$/),o.useSanitizeValueStrategy("sanitize"),o.translations("en",{buttons:{add:"Add",upload:"Upload"},modules:{upload:{descriptionSinglefile:"Upload Single File",descriptionMultifile:"Upload Multiple Files",field:{preview:"Preview",filename:"Filename",progress:"Progress",required:{caption:"Caption?"}}}}}),o.preferredLanguage("en"),l.config("commonmark",{breaks:!0}),l.use(markdownitLinkAttributes,{attrs:{target:"_blank",rel:"noopener"}})}]),angular.module("cohesionApp").constant("cohTransparent",{value:{hex:"transparent",rgba:"rgba(0, 0, 0, 0)"},name:"Transparent",wysiwyg:!0,uid:"dx8-transparent",class:".dx8-transparent",variable:"$coh-dx8-transparent",inuse:!0}),function(I,E){function e(r,a,o,e,t,n,i,l,s,c,d,m,p,u,h,f,g,v){var b,y,w,k,S=this,$={modal:"coh-element-browser-modal",backdrop:"coh-element-browser-backdrop",open:"coh-element-browser-modal-open"},x=I("body"),C=(I(".coh-element-list-container"),document.getElementsByClassName("coh-element-browser"));function M(t,n,i){"function"!=typeof n&&(n=angular.noop),"function"!=typeof i&&(i=angular.noop),_.forOwn(t,function(e,o){n(t,e,o),_.isArray(e)?e.forEach(function(e){M(e,n,i)}):_.isObject(e)?M(e,n,i):i(t,e,o)})}function A(){_.debounce(function(){r.sortableOptions.disabled=c.innerWidth<=992,r.$digest(),r.$digest()},400)()}function T(){d(function(){I(".coh-element-browser-search input:visible").focus()},200)}r.toolbar=h,S.initResizeClasses=function(){angular.element(c).bind("resize",A).trigger("resize")},S.loadElements=function(){var e="/cohesionapi/element/elements?withcategories=true";void 0!==E.cohesion.entityTypeId&&(e+="&entityTypeId="+E.cohesion.entityTypeId);o.get(e).then(function(e){var n=E.cohesion.responsive_grid_settings.gridType;r.nodes.Elements=e.categories,r.nodes.Elements.forEach(function(e,o){e.children.map(function(e){e.parentIndex=o}),M(e.children,function(e,o,t){"$$defaultBreakpoint$$"===t&&(e["desktop-first"===n?"xl":"xs"]=e[t],delete e[t])})})})},S.loadHelpers=function(){var e={entity_type:"cohesion_helper",access_elements:f.hasPermission("access elements")};angular.extend(e,E.cohesion.restrictedComponents),o.get("/cohesionapi/element-group-info",{params:e,cache:!1}).then(function(e){r.nodes.Helpers=e.categories.filter(function(e){return e.children.length}),r.nodes.Helpers.forEach(function(e,o){e.children.map(function(e){e.parentIndex=o})})})},S.loadComponents=function(){var e={entity_type:"cohesion_component",componentPath:!(void 0===E.cohesion.isComponentForm||!_typeof(E.cohesion.isComponentForm))&&E.path.currentPath};angular.extend(e,E.cohesion.restrictedComponents),o.get("/cohesionapi/element-group-info",{params:e,cache:!1}).then(function(e){r.nodes.Components=e.categories.filter(function(e){return e.children.length}),r.nodes.Components.forEach(function(e,o){e.children.map(function(e){e.parentIndex=o})})})},S.loadComponentContent=function(){var e={componentPath:"component_content"===E.cohesion.entityTypeId&&E.path.currentPath};o.get("/cohesionapi/component-contents",{params:e,cache:!1}).then(function(e){r.nodes["Component content"]=e,r.nodes["Component content"].forEach(function(e,o){e.children.map(function(e){e.parentIndex=o})})})},S.loadFields=function(){var e="/cohesionapi/element/form_elements";void 0!==E.cohesion.entityTypeId&&(e+="?entityTypeId="+E.cohesion.entityTypeId);o.get(e).then(function(e){var o=[];_.forOwn(e,function(e){o.push(e)}),r.nodes.Fields=[{id:"form_layout",label:"Form layout",class:"coh-element-browser-form-layout",children:_.filter(o,{parentIndex:"form-layout"})},{id:"form_help",label:"Form help",class:"coh-element-browser-form-help",children:_.filter(o,{parentIndex:"form-help"})},{id:"form_fields",label:"Form fields",class:"coh-element-browser-form-fields",children:_.filter(o,{parentIndex:"form-fields"})}],r.nodes.Fields=r.nodes.Fields.filter(function(e){return e.children.length}),r.nodes.Fields.forEach(function(e,o){e.children.map(function(e){e.parentIndex=o})})})},S.traverse=M,r.setPreviewImage=function(e){c.innerWidth!==I(".coh-element-browser-modal").width()&&(e&&_.get(e,"preview_image.url")||(r.previewImageUrl=void 0),r.previewImageUrl=_.get(e,"preview_image.url"))},r.showThumbToggleButton=function(e){return!0},r.toggleNav=function(e){r.navOpen=void 0!==e?e:!r.navOpen},r.toggleThumbnailView=function(e){r.showThumbs=void 0!==e?e:!r.showThumbs,s.put("sidebarShowThumbs",r.showThumbs,{path:"/"})},r.noSearchResults=function(e){return!!r.search.title&&!e.filter(function(e){return e.children.length}).length},r.navAnimStart=function(){r.navCollapseCount++},r.getAccessKey=function(e){return{Elements:"e",Components:"c","Component content":"g",Helpers:"h",Fields:"f"}[e]},r.navAnimComplete=function(){r.navCollapseCount--,r.navCollapseCount<=0&&(r.navCollapseCount=0);r.heightChange(r.toolbar.getToolbarHeight())},r.toggled=!0,r.showThumbs=s.get("sidebarShowThumbs")?"true"==s.get("sidebarShowThumbs"):"thumbnails"===E.cohesion.sidebar_view_style,r.navOpen=!1,r.nodes={},r.windowHeight=0,r.navCollapseCount=0,n.available=f.removeRestrictedElementBrowserTabs(n.available),r.tabs=n,r.search={},r.tabs.selected=-1!==r.tabs.available.indexOf(n.defaultSelected)?n.available.indexOf(n.defaultSelected):0,-1!==n.available.indexOf("Elements")&&S.loadElements(),-1!==n.available.indexOf("Helpers")&&S.loadHelpers(),-1!==n.available.indexOf("Components")&&S.loadComponents(),-1!==n.available.indexOf("Component content")&&S.loadComponentContent(),-1!==n.available.indexOf("Fields")&&S.loadFields(),r.$watch(function(){return g.getSelectedTab()},function(e){r.tabs.selected=e}),r.$watch("tabs.selected",function(e){g.selectTab(e),r.navOpen=!1,r.heightChange(r.toolbar.getToolbarHeight()),T()}),r.$watch("navOpen",function(e){r.heightChange(r.toolbar.getToolbarHeight())}),r.$watch(function(){return x.css("paddingTop")},r.toolbar.setToolbarHeight,!0),r.$watch(function(){return r.toolbar.getToolbarOrientation()},function(e,o){r.orientationChange(e,o)}),r.$watch(function(){return r.toolbar.getToolbarHeight()},function(e,o){r.heightChange(e,o)}),r.$watch(function(){return r.toolbar.getToolbarState()},function(e,o){r.stateChange(e,o)}),e.rendered.then(function(){v.stopBodyScrolling(!0),b=angular.element(document.querySelector("."+$.modal)),y=angular.element(document.querySelector("."+$.backdrop)),x.addClass($.open),d(function(){angular.element(".modal-header-nav .close").css({opacity:1})}),r.heightChange(r.toolbar.getToolbarHeight(),0),"vertical"===r.toolbar.getToolbarOrientation()&&!0===r.toolbar.getToolbarState()&&r.toolbar.toggleState()}),r.sortableOptions={connectWith:'.coh-layout-canvas-list-dropzone:not(".coh-sortable-disabled")',items:".coh-layout-canvas-list-item, .coh-layout-canvas-list-item-thumb",cancel:"a,button,input,textarea,button,select,option",scroll:!1,helper:"clone",disabled:!1,appendTo:C,placeholder:"coh-layout-canvas-placeholder",opacity:.9,animation:!1,type:"element-browser",tolerance:"pointer",zIndex:1100,start:function(e,o){w=o.helper[0],(k=o).item.show().addClass("coh-layout-canvas-list-item-placeholder"),x.addClass("coh-layout-canvas-dragging"),w.style.height=parseInt(w.style.height-2)+"px",w.style.width=parseInt(w.style.width-2)+"px"},stop:function(e,o){var n,i,t=o.item.sortable;o.item.removeClass("coh-layout-canvas-list-item-placeholder"),x.removeClass("coh-layout-canvas-dragging"),!t._isCanceled&&I(t.droptarget).hasClass("coh-layout-canvas-list-dropzone")&&(n=t.droptargetModel,i=t.dropindex,l.initNewItem(t.model).then(function(e){var o=e.newItems,t=e.deletedItems;l.insertAndInitElements(o,n,i,!0),Object.keys(l.canvases).forEach(function(e){l.removeDeletedComponents(l.canvases[e],t)}),k=void 0}))},beforeStop:function(e,o){_.set(o,"item.sortable.model.uuid","placeholder-"+m.getUUID())},update:function(e,o){r.validateDropZone(e,o).valid||o.item.sortable.cancel(),l.bAllowColumnRow=!1},remove:function(e,o){var t=o.item.sortable.model,n=t.parentIndex,i=o.item.sortable.index;if(!o.item.sortable._isCanceled)switch(o.item.sortable.model.type){case"helper":r.nodes.Helpers[n].children.splice(i,0,_.cloneDeep(t));break;case"component":r.nodes.Components[n].children.splice(i,0,_.cloneDeep(t));break;case"component-content":r.nodes["Component content"][n].children.splice(i,0,_.cloneDeep(t));break;case"form-field":case"form-container":case"form-field-container":case"form-help":r.nodes.Fields[n].children.splice(i,0,_.cloneDeep(t));break;default:r.nodes.Elements[n].children.splice(i,0,_.cloneDeep(t))}}},S.initResizeClasses(),r.validateDropZone=function(e,o){return p.validateDropZone(e,o)},r.appendElement=function(e,n){var o,t,i;""!==l.data.selected.model?(r.toggleNav(!1),t={item:{sortable:{model:n}}},o=l.getSelected(),t=p.validateDropZone({target:o.element},t),i=void 0!==l.data.selected.top&&!0===l.data.selected.top,t.valid?l.initNewItem(n).then(function(e){var o=e.newItems,t=e.deletedItems;l.insertAndInitElements(o,l.data.selected.model.children,i?0:-1),Object.keys(l.canvases).forEach(function(e){l.removeDeletedComponents(l.canvases[e],t)}),0<I(".coh-element-browser-backdrop").width()&&a.notify({className:"success success-canvas",content:n.title+" added to Layout canvas"})}):a.notify({content:t.message,className:"warning"})):d(function(){document.getElementsByClassName("coh-default-browser-launcher")[0].click(),r.appendElement(e,n)})},r.cancel=function(){e.close(),l.deSelectAllNodes(!0)},r.close=function(e){r.toggled&&(r.toggled=!1,g.isShown=!1,x.removeClass($.open),r.heightChange(r.toolbar.getToolbarHeight(),0),v.scrollToIfMobile()),e&&e.stopPropagation()},r.open=function(e){r.toggled||(v.savePosIfMobile(),r.toggled=!0,g.isShown=!0,x.addClass($.open),r.heightChange(r.toolbar.getToolbarHeight(),0),T()),e&&e.stopPropagation()},r.toggleElementBrowser=function(){x.toggleClass($.open),r.toggled=!r.toggled,g.isShown=r.toggled,r.heightChange(r.toolbar.getToolbarHeight(),0),T()},r.$on("modal.closing",function(){k&&(k.helper.remove(),k=void 0),g.isShown=!1,x.removeClass($.open)}),r.orientationChange=function(e){"vertical"===e&&!0===r.toolbar.getToolbarState()&&x.hasClass($.open)&&r.toggleElementBrowser()},r.heightChange=function(t){var n;d(function(){var e,o;b&&b.length&&(e=t,o=angular.element(".coh-element-browser-modal .nav-tabs"),n=o.length?parseInt(t)+parseInt(o.height()):t,n+=I(".coh-nav-dropdown").outerHeight(),n+=65,b.css("marginTop",e-1+"px"),r.toggled?(b.css("zIndex",h.getToolbarZindex()-60),y.css("zIndex",h.getToolbarZindex()-61)):(b.css("zIndex",""),y.css("zIndex","")),angular.element(".coh-element-list-container").css({height:"calc(100vh - "+n+"px)"}))})},r.stateChange=function(e){"vertical"===r.toolbar.getToolbarOrientation()&&!0===e&&x.hasClass($.open)&&r.close()},g.hide=r.close,g.show=r.open}e.$inject=["$scope","notificationSvc","ajaxSvc","$uibModalInstance","element","tabs","$q","CohLayoutCanvas","$cookies","$window","$timeout","cohUUID","cohSortableValidation","$filter","cohDrupalToolbar","cohPermissionService","cohElementBrowserModalService","cohScrollPosSvc"],angular.module("cohesionApp").controller("CohElementBrowserModalController",e)}(jQuery,drupalSettings),function(C,M){function e(r,e,a,o,t,n,i,l,s,c,d,m,p,u,h,f){var g=r;g.tmgmt=_.get(M,"cohesion.tmgmt",!1),r.forms={},i.forms=r.forms,g.onInit=function(e,o,t){{var i;g.form.group=o,g.form.bundle=t,(b=-1!==v.indexOf(g.form.group))&&(s.state.variableFields=_.cloneDeep(g.form.model.variableFields)||[],s.state.previewModel=_.cloneDeep(g.form.model.previewModel)||{},i=function i(e,r){if(!_.isArray(e))return;var a={};var l={child:0,pseudo:0,modifier:0,prefix:0};var s={child:"children",pseudo:"pseudos",modifier:"modifiers",prefix:"prefix"};_.forEach(e,function(n){n.selectorType&&n.uuid&&_.forEach(l,function(e,o){var t;n.selectorType===o&&(t=r+"."+s[o]+"."+e,l[o]=e+1,a[t]=n.uuid,_.isArray(n.items)&&(a=Object.assign(a,i(n.items,t))))})});return a}(_.get(g.form,"mapper.styles.items"),""),_.forEach(s.state.variableFields,function(t,n){_.forEach(i,function(e,o){0===t.indexOf("styles"+o+".styles")&&(s.state.variableFields[n]=t.replace("styles"+o+".styles","styles."+e+".styles"))})}))}g.form.ajaxComplete=!1;o=M.cohOnInitForm;g.form.schema=o.schema,function(e){(e||[]).forEach(function e(t){t.$validators&&_.each(t.$validators,function(e,o){t.$validators[o]=new Function("value",e)}),(t.items||[]).forEach(e)})}(o.form),o.model&&"color_palette"!==t&&_.defaultsDeep(g.form.model,o.model);{var n;g.form.form=o.form,"component_content"===M.cohesion.entityTypeId?(t=!1,o=M.cohesion.entityForm.json_values[M.cohesion.apps[0]],M.cohesion.component_content_add?(n="/cohesionapi/element-group-info",t={params:{entity_type:"cohesion_component",element_id:M.cohesion.component_content_add}}):n="/cohesionapi/cohesion-component/".concat(o.canvas[0].uid),p.get(n,t).then(function(o){M.cohesion.component_content_add?h.initNewItem(o).then(function(e){e=e.newItems;e[0].type="component",e[0].uid=M.cohesion.component_content_add,e[0].enabled=!0,h.insertAndInitElements(e,h.canvases["layout_canvas_0-canvas"].children,0),g.form.model.mapper=o.mapper,g.form.model[M.cohesion.apps[0]].canvas[0].disabled=!0,g.form.ajaxComplete=!0}):(g.form.model.mapper=o.mapper,g.form.ajaxComplete=!0)})):g.form.ajaxComplete=!0}g.beforeUnload=r.$on("onBeforeUnload",function(e,o){_.get(r,"forms.formRenderer.$dirty")&&!window.Cypress&&(o.message="All unsaved data will be lost.",e.preventDefault())})},g.remove=function(e){g.form.model[e.key[0]].splice(e.key[1],1);var o=angular.copy(g.form.model[e.key[0]]);a(function(){g.form.model[e.key[0]]=o})},g.add=function(e,o){var t={};return _.forEach(JSON.parse(o),function(e,o){_.set(t,o,e)}),g.form.model[e].push(t)},g.copyValueTo=function(t,e,o){_.forEach(e,function(e){var o=t.key.slice(0,-1);o.push(e),_.set(g.form.model,o,_.get(g.form.model,t.key))})},g.mergeObject=function(e,o,t){t=void 0===t?o.valueProperty:t;var e=_.findIndex(o.options,[t,e]),n=t.split("."),t=_.filter(o.key,function(e){return!_.includes(n,e)});_.merge(_.get(g.form.model,t),o.options[e]),$(o,["class"],".coh-font-"),x(o,["variable"],"$coh-font-")},g.setColorPaletteAttributes=function(e,o){var t=o.key.slice(0,-1),n=_.concat(angular.copy(t),"inuse"),i=_.concat(angular.copy(t),"link");a(function(){!1!==e&&!0!==_.get(g.form.model,n)&&!1!==_.get(g.form.model,i)&&y(0,o)})},g.updateColorPaletteAttributes=y,g.setFontStackAttributes=function(e,o){var t=o.key.slice(0,-1),n=_.concat(angular.copy(t),"inuse"),i=_.concat(angular.copy(t),"link");a(function(){!1!==e&&!0!==_.get(g.form.model,n)&&!1!==_.get(g.form.model,i)&&w(0,o)})},g.updateFontStackAttributes=w,g.inUseModal=function(e,o,t){e=e.key.slice(0,-1);e=e.concat(t);e={url:"/admin/cohesion/"+o+"/"+_.get(r.form.model,e)+"/in_use",dialogType:"modal"};m.openDialog(e)},g.toggleLocked=function(e,o,t){e=e.key.slice(0,-1).concat(t),t=_.get(r.form.model,e);void 0===t&&(t=!1);_.set(r.form.model,e,!t)},g.sortBreakpoints=function(){t.sortBreakpoints(g.form.model.gridType,g.form)},g.validateForm=function(o){angular.forEach(r.forms.formRenderer.$$controls,function(e){o&&e.$setDirty(),e.$validate()})},g.toggleVariableMode=function(e){e.preventDefault(),s.toggleVariableMode()},g.onSubmit=function(e,o){if(o.$invalid)return e.preventDefault(),!1;if(s.state.submitting=!0,r.$broadcast("schemaFormValidate"),i.$broadcast("schemaFormValidate"),o.$invalid)return e.preventDefault(),s.state.submitting=!1;g.layoutCanvases.length?angular.forEach(g.layoutCanvases,function(o){var t=angular.copy(g.form.model[o]);t.model={},t.mapper={},_.forEach(g.form.model[o],function(e){h.recurseNodes(e,[function(e){e=e,_.set(t.model,[e.componentContentId||e.uuid],g.form.model[o].model[e.componentContentId||e.uuid]),_.set(t.mapper,[e.componentContentId||e.uuid],g.form.model[o].mapper[e.componentContentId||e.uuid])}])});var e=c.getUUIDList(),n=_.get(t,"meta.fieldHistory")||[];e.length&&_.each(e,function(e){n.unshift(e)}),_.set(t,"meta.fieldHistory",_.uniqBy(n,"uuid")),C("."+o+"_modelAsJson").val(angular.toJson(t,!1))}):(b&&(!0===s.state.variableMode&&s.toggleVariableMode(),i.$broadcast("cohFormSaving"),_.isEmpty(s.state.previewModel)||_.set(g.form.model,"previewModel",s.state.previewModel),_.set(g.form.model,"variableFields",s.state.variableFields||[])),C("._modelAsJson").val(angular.toJson(g.form.model,!1)),C("._mapperAsJson").val(angular.toJson(t.produceFormDefinitionForTree(s.state.mapper,!1),!1)));g.beforeUnload()},g.formLoaded=function(){return g.form.loaded&&g.form.ajaxComplete},g.formSubmitting=function(){return s.state.submitting},g.registerLayoutCanvas=function(i){g.layoutCanvases.push(i);var e=angular.copy(M.cohOnInitForm.form);(function t(n){_.forEach(n,function(e,o){"key"===o&&(n[o]=i+"."+e),"object"===_typeof(e)&&t(e)})})(e),!_.isArray(g.form.form)&&void 0!==g.form.form||(g.form.form={});_.set(g.form.form,i,e)},g.openDrupalDialog=function(e,o){e.preventDefault(),f.openDrupalDialog(e,o)};var l=l.cohesionSettings.entityForm,v=["custom_styles","base_styles"],b=!1;function y(e,o){var t=o.key.slice(0,-1),n=_.concat(angular.copy(t),"link");_.set(o,["key"],_.concat(angular.copy(t),"name")),!0===_.get(g.form.model,n)&&S(o,["uid"],""),$(o,["class"],".coh-color-"),x(o,["variable"],"$coh-color-")}function w(e,o){var t=o.key.slice(0,-1),n=_.concat(angular.copy(t),"link");_.set(o,["key"],_.concat(angular.copy(t),"name")),!0===_.get(g.form.model,n)&&S(o,["uid"],""),$(o,["class"],".coh-font-"),x(o,["variable"],"$coh-font-")}function k(t,e,n,i,r){n=void 0===n?"coh-":n,i=void 0===i?/\s+/g:i,r=void 0===r?"-":r;var a=/[^a-zA-Z0-9\s\-_]/g;_.forEach(e,function(e){var o=t.key.slice(0,-1);o.push(e);e=n+_.get(g.form.model,t.key).replace(a,"").replace(i,r).toLowerCase();_.set(g.form.model,o,e)})}function S(e,o,t){return t=void 0===t?"coh-":t,k(e,o=void 0===o?["uid"]:o,t=_.includes(_.get(g.form.model,e.key),t)?"":t),0}function $(e,o,t){return t=void 0===t?".coh-":t,k(e,o=void 0===o?["class"]:o,t=_.includes(_.get(g.form.model,e.key),t)?"":t),0}function x(e,o,t){return t=void 0===t?"$coh-":t,k(e,o=void 0===o?["variable"]:o,t=_.includes(_.get(g.form.model,e.key),t)?"":t),0}g.layoutCanvases=[],g.form={bundle:"",loaded:!1,ajaxComplete:!1,schema:{properties:{cohesion:{type:"object"}}},hasFormBuilder:!1,form:[],model:{},options:{},mapper:{}},void 0!==l&&(g.form.options=d.getOptions(),g.form.model=l.json_values,g.form.mapper=l.json_mapper,s.state.mapper=g.form.mapper,s.state.model=g.form.model),M.cohesion.showJsonFields&&(r.$watch("form.model",function(){g.layoutCanvases.length?angular.forEach(g.layoutCanvases,function(e){C("."+e+"_modelAsJsonView").text(u("json")(g.form.model[e]))}):C("._modelAsJsonView").text(u("json")(g.form.model))},!0),r.$watch(function(){return s.state.mapper},function(){C("._mapperAsJsonView").val(angular.toJson(t.produceFormDefinitionForTree(s.state.mapper,!1),!0))},!0)),r.$on("sf-render-finished",function(){g.form.hasFormBuilder||(g.form.loaded=!0),"responsive_grid_settings"===g.form.bundle&&g.form.form.length&&void 0!==g.form.model.gridType&&t.sortBreakpoints(g.form.model.gridType,g.form)}),r.$on("coh-style-builder-rendering",function(){g.form.loaded=!1,g.form.hasFormBuilder=!0}),r.$on("coh-style-builder-rendered",function(){g.form.loaded=!0})}e.$inject=["$scope","$http","$timeout","$uibModal","styleBuilderSvc","cohFormBuilderRenderSvc","$rootScope","drupalSvc","formStateSvc","cohUUID","cohSchemaFormSvc","drupalDialog","ajaxSvc","$filter","CohLayoutCanvas","cohTokenSvc"],angular.module("cohesionApp").controller("CohFormRendererCtrl",e)}(jQuery,drupalSettings),function(I){angular.module("cohesionApp").controller("CohLayoutCanvasModalController",["$scope","cohUUID","$uibModalInstance","$window","element","model","previewModel","variableFields","forms","formDefinition","cohVarSvc","cohTokenSvc","formStateSvc","$timeout","ajaxSvc","cohSchemaFormSvc","cohElementBrowserModalService","$injector","cohPermissionService","drupalSvc","CohLayoutCanvas","cohFormBuilderRenderSvc","$cohModal","notificationSvc",function(n,i,r,e,a,l,o,t,s,c,d,m,p,u,h,f,g,v,b,y,w,k,S,$){n.tmgmt=_.get(drupalSettings,"cohesion.tmgmt",!1),n.loaded=!1;var x=I("html"),C=I("body"),M=g.isShown,A=c&&c.restrictSaveComponentContent;function T(e,o){var t={};n.element.componentContentId&&(t.canAccessTokens=!1,t.hideTitle=!0);t=k.initialiseForm(e,o,n.element,t);l&&_.merge(n.model,{settings:{title:a.title}},l),function o(e,t){_.forEach(e,function(e){"form-help"===e.type&&_.set(n.model,[e.uuid],t[e.uuid]),_.isUndefined(e.children)||_.isEmpty(e.children)||o(e.children,t)})}(e,t.model),n.sf=t,n.sf.options=f.getOptions(),window.parent.postMessage("dx8.componentformloaded","*")}n.element=a,n.model={},p.state.previewModel=_.cloneDeep(o),p.state.variableFields=_.cloneDeep(t),n.sf={schema:null,form:null,options:null},n.save=function(){!0===p.state.variableMode&&p.toggleVariableMode();var o;k.isSavingAsContent=!1;var e=_.get(n,"model.settings.machineName");"form-field"!==n.element.type&&"form-field-container"!==n.element.type||i.findByMachineName(e)||(o=_.find(w.canvasData.meta.fieldHistory,{machineName:e}),n.$emit("cohBeforeSidebarApply"));{var t;e=o?(t="/cohesionapi/element/form_elements",void 0!==drupalSettings.cohesion.entityTypeId&&(t+="?entityTypeId="+drupalSettings.cohesion.entityTypeId),S.showModal({resolve:{fieldType:function(){return h.get(t).then(function(e){return _.get(e,[o.type,"title"])||"unknown"})}}},{showSuppression:!1,bodyText:"`You have chosen a machine name that was used as a form field (${$scope.$resolve.fieldType}) on a previous version of this component and might have data associated with it already. Are you sure you want to re-establish a link with that data?`"})):S.showModal({},{forceSuppress:!0})}e.result.then(function(){o&&(delete w.canvasData.model[a.uuid],n.element.uuid=o.uuid),u(function(){n.elementForm.$setDirty(),n.elementForm.$setSubmitted(),n.$broadcast("schemaFormValidate"),n.elementForm.$valid&&r.close({model:n.model,element:n.element,previewModel:p.state.previewModel,variableFields:p.state.variableFields})})})},n.saveContent=function(){!0===p.state.variableMode&&p.toggleVariableMode();k.isSavingAsContent=!0,u(function(){var e;n.elementForm.title.$validate(),n.elementForm.$setDirty(),n.elementForm.$setSubmitted(),n.$broadcast("schemaFormValidate"),n.elementForm.$invalid||n.element.componentContentId||(n.loaded=!1,(e=w.getNodesData(n.element))[n.element.uuid]=n.model,k.saveComponentContent(n.element,e).then(function(e){var o=angular.copy(n.element);o.componentContentId=e.componentId,o.title=e.title,o.url=h.wrap(e.url),r.close({model:n.model,element:o}),_.get(n,"element.componentContentId")&&$.notify({className:"success success-canvas",content:"Component content saved."})}).finally(function(){n.loaded=!1}))})},n.close=function(){r.dismiss("cancel")},n.handleModalClick=function(e){p.variableModeAvailable&&e.altKey&&(p.toggleVariableMode(),e.stopPropagation(),e.preventDefault())},n.toggleVariableMode=function(){p.toggleVariableMode()},n.openDrupalDialog=function(e,o){e.preventDefault(),m.openDrupalDialog(e,o)},n.canSaveAsComponentContent=function(e){var o=!1;if(A)return!1;"component"===e.type&&b.hasPermission("administer component content")&&(o=!0);return o},n.varModeOrHasVariable=function(e){return p.state.variableMode||-1!==p.state.variableFields.indexOf(e)},p.initXssDisabledFields(a.uuid),x.addClass("coh-layout-canvas-settings-open"),p.variableModeAvailable=!1,g.hide(),n.canvasName=p.state.canvasName,n.$on("sf-render-finished",function(){u(function(){n.loaded=!0})}),n.$on("modal.closing",function(){u(function(){e.dispatchEvent(new Event("resize"))},1),!0===p.state.variableMode&&p.toggleVariableMode(),I(".coh-layout-canvas-settings-open").removeClass("coh-layout-canvas-settings-open"),M&&g.show(),y.drupal.toolbar&&v.invoke(["cohDrupalToolbar",function(e){C.css("paddingTop",e.getToolbarHeight())}])}),r.rendered.then(function(){var e,o=0===a.type.indexOf("form-")?"form_element_forms":"element_forms";n.loaded=!1,n.ellipsis=[],"component"===a.type&&a.componentContentId?T({},c.model):"component"===a.type&&c?T(c.componentForm,c.model):"style-guide"===a.type&&c?T(c.styleGuideForm,c.model):s&&a.uid&&!_.isEmpty(s[o][a.uid])&&(_.merge(n.model,{settings:{title:a.title}},l),_.defaultsDeep(n.model,s[o][a.uid].model),"cohPickerMenu"!==(e=s[o][a.uid].form)[0].type&&e.unshift({type:"cohPickerMenu"}),n.sf={schema:s[o][a.uid].schema,form:s[o][a.uid].form,options:f.getOptions()})})}])}(jQuery),angular.module("cohesionApp").config(["$provide",function(e){e.decorator("schemaValidateDirective",["$delegate","cohApiSvc","formStateSvc","styleBuilderSvc","drupalSvc","cohUUID","cohFormBuilderRenderSvc",function(e,m,p,u,h,f,g){var o=e[0],v=o.link;return o.compile=function(){return function(i,e,o,r,t){var a=_.mapKeys(h.cohesionSettings.scss_variables,function(e,o){return"$"+o}),l={breakpointWidth:function(e,o){var t=_.get(a,e||o,e||o),n=!0,e=i.$parent.form.key[1],o=u.order["desktop-first"].indexOf(e),e=u.order["desktop-first"][o-1],o=u.order["desktop-first"][o+1];return void 0!==o&&parseInt(t)<=parseInt(_.get(p,"state.model.breakpoints."+o+".width"))&&(n=!1),(n=void 0!==e&&parseInt(t)>=parseInt(_.get(p,"state.model.breakpoints."+e+".width"))?!1:n)&&(delete r.$error.breakpointWidth,delete r.$error.schemaForm),n},componentMachineNameUnique:function(e,o){return r.cohOriginalValue||(r.cohOriginalValue=e),!r.$dirty||!f.findByMachineName(e)||r.cohOriginalValue===e},validConditionStatement:function(e,o){if(e&&""!==e&&r.$dirty)try{if(e=g.getCondition(e),"boolean"!=typeof i.$eval(e))return!1}catch(e){return!1}return!0},conditionStatementVariableWarning:function(e,o){return-1===e.indexOf("[style")}},n=_.get(i,"$parent.form.type");-1!==["cohTextBox","cohTextarea","number","cohMediaEmbed","cohFieldMachineName"].indexOf(n)&&(n=_.get(i,"$parent.form.ngModelOptions"),r.$overrideModelOptions(angular.extend({debounce:300},n))),null===_.get(i,"$parent.form.schema.maxLength")&&delete i.$parent.form.schema.maxLength;var s=this,c=arguments;v.apply(s,c);var d=_.get(i,"$parent.form.schema.cohValidate");d&&m.get("form_validation.form_validation").then(function(o){var n=[];_.forEach(d,function(e){o[e].regx&&(o[e].regx=new RegExp(o[e].regx)),o[e].function&&(o[e].function=l[e]),n.push(o[e])}),n.length&&(delete r.$validators.schemaForm,_.forEach(_.filter(n,"function"),function(e,o){var t={};t[o]=e.function,_.set(i,"$parent.form.$validators",t),_.setWith(i,["$parent","form","validationMessage",o],e.message,Object),v.apply(s,c)}),_.set(i,"$parent.form.$validators",{regxValidator:function(e,o){var t=!1;return!!r.$isEmpty(e)||(!(e=_.filter(n,"regx")).length||(_.forEachRight(e,function(e){e.regx.test(o)?t=!0:_.setWith(i,["$parent","form","validationMessage","regxValidator"],e.message,Object)}),t))}}),v.apply(s,c))})}},e}])}]),function(l){angular.module("cohesionApp").config(["$provide",function(e){e.decorator("ngDisabledDirective",["$delegate","formStateSvc",function(e,a){var o=e[0].compile;return e[0].compile=function(){var r=o.apply(this,arguments);return function(e,o,t,n){var i=(i=_.get(e,"form.key"))&&i.join(".");return-1!==a.state.xssDisabledFields.indexOf(i)&&(e.form.readonly=!0,l(o).replaceWith('<textarea disabled class="form-control">This field has been disabled because it contains XSS vulnerable content and you do not have sufficient permissions to edit it.</textarea>')),r.apply(this,arguments)}},e}])}])}(jQuery),function(r){angular.module("cohesionApp").directive("cohAccordion",function(){return{scope:!0,restrict:"E",templateUrl:"scripts/directives/coh-accordion/coh-accordion.html",controller:["$scope","$element","formStateSvc","$window","styleBuilderSvc",function(t,e,o,n,i){t.getHelpUrl=function(e){var o;return t.form&&(t.helpUrl=o=!1,t.form.helpKey&&(o=_.get(r,"cohesion.support_url"))&&(t.form.helpKeyUnique?t.helpUrl=o+i.propertyOptionsKey+"-"+t.form.helpKey:t.helpUrl=o+t.form.helpKey)),t.helpUrl},this.$onInit=function(){0}}]}})}(drupalSettings),function(){function e(g,v,b){return{restrict:"E",templateUrl:"scripts/directives/coh-array/coh-array.html",bindToController:!0,controllerAs:"caw",controller:["$scope","$timeout","notificationSvc",function(i,n,r){var a=this,e=!(!i.form.sortableOptions||!i.form.sortableOptions.handle)&&".coh-array-sortable-handle",l={};function s(){_.each(a.form.items,function(e,o){!function o(e,t){e.condition&&(e.originalArrayCondition||(e.originalArrayCondition=angular.copy(e.condition)),e.condition=e.originalArrayCondition.split("'arrayIndex'").join(t)),_.each(e.items,function(e){o(e,t)})}(e,o)})}function c(e){_.each(a.form.items,function(e,o){!function o(e,t){e.key&&(e.endKey||(e.originalKeyValue?e.endKey=angular.copy(e.originalKeyValue):(e.originalKeyValue=angular.copy(e.key),e.endKey=angular.copy(e.key))),_.isArray(e.endKey)||(e.endKey=e.endKey.split(".")),e.key=angular.copy(i.form.key.concat([parseInt(t)]).concat(e.endKey))),_.each(e.items,function(e){o(e,t)})}(e,o)}),f(e=!1===e?angular.copy(u()):e)}function d(e){var o=_.get(i.model,i.form.key)||[],t=a.form,n=t.max,t=t.increment;e=e||t,n&&a.form.items.length>=n?r.notify({content:"You have reached the maximum number of fields allowed for this component.",className:"warning warning-canvas"}):(n=_toConsumableArray(new Array(e)).map(function(){}),_.set(i.model,i.form.key,o.concat(n)),a.form.items=a.form.items.concat(_toConsumableArray(new Array(e)).map(function(){return angular.copy(l)})),e=angular.copy(u()),s(),c(e),v.applyDefaultValues(a.form.items[a.form.items.length-1],i.model))}function m(t,e){!e&&a.form.items.length<=1||(_.remove(u(),function(e,o){return o===t}),_.remove(h(),function(e,o){return o===t}),_.remove(g.state.variableFields,function(e){return 0===e.indexOf(i.form.key.join(".")+"."+t)}),e=angular.copy(u()),a.form.items.pop(),s(),c(e),g.toggleVariableMode(g.state.variableMode))}function p(e,o,t){if(t>=e.length)for(var n=t-e.length;1+n--;)e.push(void 0);return e.splice(t,0,e.splice(o,1)[0]),e}function u(){return _.get(i.model,i.form.key)}function h(){return _.get(g.state.variableModeModel,i.form.key)}function f(e){_.set(i.model,i.form.key,e)}a.sortableOptions={axis:"y",opacity:.5,handle:e,update:function(e,o){!function(e,o){f(p(u(),e,o));var t=h();_.isArray(t)&&function(e){_.set(g.state.variableModeModel,i.form.key,e),i.form.key,g.runVariableWatchers()}(p(t,e,o));p(a.form.items,o,e)}(o.item.sortable.index,o.item.sortable.dropindex),i.$broadcast("coh-array-update")},start:function(e,o){o.item.parent().sortable("refreshPositions")}},n(function(){a.sortableOptions.handle=e},100),_.merge(a.sortableOptions,i.form.sortOptions),a.sortableOptions.handle&&(a.sortableOptions.handle="> .coh-array-sortable-handle"),a.addItem=d,a.deleteItem=m,i.form.originalArrayRow?l=i.form.originalArrayRow:i.form.originalArrayRow=l={items:angular.copy(i.form.items),htmlClass:i.form.htmlClass,key:angular.copy(i.form.key),originalKeyValue:angular.copy(i.form.originalKeyValue)},i.isHidden="is-hidden",a.form=i.form,this.$onInit=function(){i.isHidden="",i.form.setValue&&b.getValue("customFields")&&f(_.get(b.getValue("customFields"),"options"));var t=u();a.form.items=[];var o,e=void 0===(e=a.form.min)?1:e;!t||_.isEmpty(t)||t.length<e?d(e):(Array.isArray(t)||(i.form.legacyStringMapper&&"string"==typeof t&&(t={},_.forOwn(i.form.legacyStringMapper,function(e,o){t[e]=_.get(i.model,o)})),f(t=[t])),o=_.get(t,"[0].backgroundImageGradient")&&!_.get(t,"[0].backgroundLayerType"),_.each(t,function(e){a.form.items.push(angular.copy(l)),o&&(e.backgroundLayerType={value:"gradient"})}),o&&f(t)),c(!1),s(),v.cohArrayList.push({debug:a.form.key,rewriteArrayConditions:s,rewriteArrayKeys:c}),i.$on("coh-remove-array-row",function(e,o){o=o.key;_.isEqual(a.form.key,o.slice(0,o.length-2))&&m(o.slice(o.length-2,o.length-1)[0])}),i.$on("coh-remove-empty-array-rows-"+a.form.key[0],function(e){var t=a.form.items.length;_.forEachRight(a.form.items,function(e){var o=!1;t--,_.forEach(e.items,function(e){e=_.get(i.model,e.key)||_.get(g.state.variableModeModel,e.key);if(o=!_.isNil(e)&&""!==e?!0:o)return!1}),o||m(t,!0)})}),i.form.setValue&&n(function(){a.modelWatch=i.$watch(u,function(e,o){var t=angular.copy(u());b.setValue(i.form.setValue,t),f(t)},!0)})},this.$onDestroy=function(){i.form.setValue&&a.modelWatch()}}]}}e.$inject=["formStateSvc","menuSvc","cohModelManager"],angular.module("cohesionApp").directive("cohArray",e)}(),angular.module("cohesionApp").run(["$templateCache",function(e){e.put("directives/decorators/bootstrap/array.html",'<div class="schema-form-array coh-bootstrap-array"\n                      ng-class="form.htmlClass"\n                      ng-model="$$value$$"\n                      ng-model-options="form.ngModelOptions"\n                      sf-array="form">\n                      <ol class="list-group"\n                          ng-attr-aria-label="{{::form.title}}"\n                          ng-model="modelArray"\n                          ui-sortable="form.sortOptions">\n                          <li class="list-group-item" ng-class="form.fieldHtmlClass" ng-repeat="item in modelArray track by $index">\n                              <span class="coh-drag-handle coh-icon-move" ng-if="form.sortOptions.handle"></span>\n                              <div class="list-group-item-inner" form="copyWithIndex($index)" ng-init="arrayIndex = $index" sf-decorator></div>\n                          </li>\n                      </ol>\n                      <div class="coh-bootstrap-array-btn-wrapper" ng-if="form.addToArrayLabel">\n                          <button ng-class="form.style" ng-click="appendToArray()" type="button">{{ form.addToArrayLabel }}</button>\n                      </div>\n                </div>')}]),angular.module("cohesionApp").directive("cohAutoFocus",function(){return{restrict:"A",scope:{cohAutoFocus:"@"},controller:["$scope","$rootScope","$element",function(e,o,t){var n;this.$onInit=function(){n=this,e.cohAutoFocus?n.unbind=o.$on(e.cohAutoFocus,function(){t.focus()}):t.focus()},this.$onDestroy=function(){"function"==typeof n.unbind&&n.unbind()}}]}}),function(){function e(i,r){return{restrict:"E",templateUrl:"scripts/directives/coh-available-color-select/coh-available-color-select.html",scope:{model:"=",ngModel:"=ngModel",form:"="},controllerAs:"acs",bindToController:!0,controller:["cohTransparent",function(e){var t;function o(e){var o=t.selectedColours.indexOf(e.variable);-1===o?t.selectedColours.push(e.variable):t.selectedColours.splice(o,1),o=t.selectedColours,t.ngModel=o.join(",")}function n(e){return-1!==t.selectedColours.indexOf(e.variable)}this.$onInit=function(){(t=this).onClickThumb=o,t.isSelected=n,t.palette=[e],t.selectedColours=[],t.unsetColor={variable:"unset"},t.ngModel&&(t.selectedColours=t.ngModel.split(",")),i.get(r.colour_palette,{cache:!1}).then(function(e){t.palette=t.palette.concat(e)})}}]}}e.$inject=["ajaxSvc","apiUrls"],angular.module("cohesionApp").directive("cohAvailableColorSelect",e)}(),function(F,B){function e(A,T,I,E,O,e,P,D){return{restrict:"E",templateUrl:"scripts/directives/coh-blades-menu/coh-blades-menu.html",scope:{form:"=",model:"=",openTreeFn:"=",initialiseTreeMenu:"=",changeFormFn:"=",loaded:"="},bindToController:!0,controllerAs:"cbm",controller:["$scope","$timeout",function(e,o){var i,r,a=this,l={},s=null,c=[{value:">",label:">"},{value:"+",label:"+"},{value:"~",label:"~"}],t=[{selectorType:"pseudo",name:":hover"},{selectorType:"pseudo",name:":active"},{selectorType:"pseudo",name:":focus"},{selectorType:"pseudo",name:":before"},{selectorType:"pseudo",name:":after"},{selectorType:"pseudo",name:":first-child"},{selectorType:"pseudo",name:":last-child"},{selectorType:"pseudo",name:":nth-child",label:"Nth-child",hasOptions:!0,subType:"nth-child"},{selectorType:"pseudo",name:"Custom pseudo",label:"Custom pseudo",hasOptions:!0,subType:"custom-pseudo"},{selectorType:"modifier",name:"Modifier",label:"Modifier",hasOptions:!0},{selectorType:"child",name:"Child selector",label:"Child selector",hasOptions:!0},{selectorType:"combinator",name:"Combinator",hasOptions:!0},{selectorType:"prefix",name:"Prefix",label:"Prefix",hasOptions:!0}];function d(e){27===e.which&&(e.preventDefault(),e.stopPropagation(),m())}function m(){o(function(){n(),a.menu.blades.pop(),0===a.menu.blades.length?u():angular.element(".blade2 .coh-back-btn").focus()})}function p(){A.addModelsToTree(a.model[a.form.mapperKey],s)}function u(){o(function(){n(),a.menu.open=!1,a.menu.blades=[],angular.element("body").unbind("keydown",d)})}function n(){a.combinatorInput=null,a.selectorInput=null}function h(e,o){o&&(a.selectorInput=o);o={title:"",type:"selectorInput",editing:!!o};o.selectorType=e.selectorType,e.subType&&(o.subType=e.subType),o.option=e,a.menu.blades.push(o)}function f(e){e={title:e.name,type:"container",items:[],form:null,selectorType:e.selectorType,uuid:D.getUUID()};a.menu.addToItem.items.push(e),a.menu.blades.splice(-1,1),p()}function g(e,o){a.selectorInputValid&&e&&""!==e?(a.menu.addToItem.title=e,b(o,a.menu.addToItem.model=e),a.selectorInput=null,a.menu.blades.splice(-2,2),angular.element(".blade3 .coh-back-btn").focus(),x(a.menu.addToItem,!0)):a.selectorInputValid=!1}function v(e,o,t){a.selectorInputValid&&e&&""!==e?("nth-child"===t?a.menu.addToItem.title=":nth-child("+e+")":"custom-pseudo"===t&&(a.menu.addToItem.title=e),a.menu.addToItem.model=e,b(o,a.menu.addToItem.title),a.selectorInput=null,a.menu.blades.splice(-2,2),angular.element(".blade3 .coh-back-btn").focus(),x(a.menu.addToItem,!0)):a.selectorInputValid=!1}function b(e,o){var t;"pseudo"===e&&(t="pseudo"),"modifier"!==e&&"prefix"!==e||(t="class"),"child"===e&&(t="element"),F.get(a.model.styles,a.menu.addToItem.uuid).settings[t]=o}function y(e,o){if(a.selectorInputValid&&e&&""!==e){if("modifier"===o&&(n="."===(t=e).charAt(0),i="#"===t.charAt(0),t="["===t.charAt(0)&&t.indexOf(!0),!(n||i||t)))return I.notify({className:"danger",content:"Use (.) for class (#) for id or ( [ attribute name ] ) for attribute"}),!1;var t,n,i,e={title:e,type:"container",items:[],form:null,selectorType:o,model:e,uuid:D.getUUID()};(a.menu.addToItem&&"topLevel"!==a.menu.addToItem.selectorType?a.menu.addToItem:a.menu.blades[0].selectorArray).items.push(e),a.menu.blades.splice(-2,2),angular.element(".blade3 .coh-back-btn").focus(),a.selectorInput=null,p()}else a.selectorInputValid=!1}function w(e,o,t){if(a.selectorInputValid&&e&&""!==e){var n={};if("nth-child"===t)n={title:":nth-child("+e+")",type:"container",items:[],form:null,selectorType:o,subType:t,model:e,uuid:D.getUUID()};else if("custom-pseudo"===t){if(":"!==e.charAt(0))return I.notify({content:"Custom pseudo selectors must start with :",className:"danger"}),!1;n={title:e,type:"container",items:[],form:null,selectorType:o,subType:t,model:e,uuid:D.getUUID()}}(a.menu.addToItem&&"topLevel"!==a.menu.addToItem.selectorType?a.menu.addToItem:a.menu.blades[0].selectorArray).items.push(n),a.menu.blades.splice(-2,2),angular.element(".blade3 .coh-back-btn").focus(),a.selectorInput=null,p()}else a.selectorInputValid=!1}function _(e){"pseudo"!==a.menu.addToItem.selectorType&&(a.menu.addToItem.combinator=e,F.set(a.model.styles,[a.menu.addToItem.uuid,"settings","combinator"],e),a.menu.blades.splice(-2,2),angular.element(".blade3 .coh-back-btn").focus(),a.combinatorInput=null,p(),x(a.menu.addToItem,!0))}function k(e){var o={title:"",type:"selector"};"topLevel"!==(a.menu.addToItem=e).selectorType&&(o.deletable=!0);-1===["child","modifier","combinator","prefix"].indexOf(e.selectorType)&&"custom-pseudo"!==e.subType&&"nth-child"!==e.subType||(o.editable=!0),a.menu.blades.push(o)}function S(){var e;h({label:"Edit "+("pseudo"!==(e=a.menu.addToItem).selectorType?F.find(t,{selectorType:e.selectorType}):F.find(t,{subType:e.subType})).label,selectorType:a.menu.addToItem.selectorType,subType:a.menu.addToItem.subType},a.menu.addToItem.model||a.menu.addToItem.title)}function $(){T.showModal({},{showSuppression:!0,suppressionCookieKey:"coh.suppressModal.selectors"}).result.then(function(){var t=a.menu.addToItem.uuid;a.menu.addToItem.deleted=!0,function o(e){var t;t=e.uuid,F.unset(a.model,["styles",t]),e.items&&e.items.length&&F.each(e.items,function(e){o(e)})}(a.menu.addToItem),F.remove(a.menu.blades[0].selectorArray.items,function(e){return e.uuid===t||void function o(e){F.remove(e,function(e){return e.uuid===t||void o(e.items)})}(e.items)}),a.selectFormLevel(a.menu.blades[0].selectorArray),m()})}function x(e,o){a.currentLevelHashKey!==e.uuid||o?(O.setValue("activeStyle",e.uuid),a.currentLevelHashKey=e.uuid,e.form.currentLevelTitle=e.combinator?e.combinator+e.title:e.title,P.$broadcast("cohFormSaving",{key:e.form.mapperKey}),a.changeFormFn(e.form,e,!0),o||u()):u()}function C(e){a.menu.blades.length>e&&(n(),e=a.menu.blades.length-e,F.times(e,function(){a.menu.blades.pop()}))}function M(){return F.filter(t,function(e){return("pseudo"!==a.menu.addToItem.selectorType||"modifier"!==e.selectorType)&&("combinator"!==a.menu.addToItem.selectorType||"modifier"!==e.selectorType)})}this.$onInit=function(){var t,n;a.sortableOptions={appendTo:".tree",connectWith:".children",placeholder:"sortable-placeholder",opacity:.5,tolerance:"intersect",delay:150,distance:3,helper:"clone",cursor:"pointer",start:function(e,o){n=B(this).data("ui-sortable").scrollParent,o.item.show(),o.item.addClass("original-placeholder"),i=this.getElementsByClassName("ui-sortable-placeholder")[0],t=n[0].scrollHeight-n.height()-o.helper.height()},over:function(e,o){var t=this.attributes["allowed-types"].value;r="any"===t||F.includes(JSON.parse(t),o.item.sortable.model.selectorType),i.classList.add((r?"":"in")+"valid"),i.classList.remove((r?"in":"")+"valid")},update:function(e,o){var t;o.item.sortable.received||o.item.sortable.source[0]===o.item.sortable.droptarget[0]||"any"!==(t=o.item.sortable.droptarget[0].attributes["allowed-types"].value)&&(F.includes(JSON.parse(t),o.item.sortable.model.selectorType)||o.item.sortable.cancel()),0},stop:function(e,o){o.item.removeClass("original-placeholder"),0},sort:function(e,o){n.scrollTop()>t&&n.scrollTop(t)}},a.back=m,a.closeMenu=u,a.addMenuLevel2=k,a.addSelector=f,a.addSubSelectorBlade=h,a.editCustomSelector=g,a.editCustomPseudoSelector=v,a.addCustomSelector=y,a.addCustomPseudoSelector=w,a.addCombinator=_,a.deleteItem=$,a.editItemName=S,a.selectFormLevel=x,a.treeReorganised=p,a.selectBladeLevel=C,a.getSubselectorOptions=M,a.selectorInputValid=!0,a.selectorInputValidating=!1,this.$onDestroy=function(){angular.element("body").unbind("keydown",d)},a.openTreeFn=function(){e.activeClass=O.getValue("activeStyle")?"":"coh-blades-menu-active",a.menu.blades=[l],angular.element("body").bind("keydown",d)},e.$watch("cbm.loaded",function(){a.loaded&&((s=angular.copy(a.form)).items=[],a.menu={blades:[]},l={title:a.form.label,type:"tree",selectorArray:E.state.mapper[a.form.mapperKey]},a.topLevel=E.state.mapper[a.form.mapperKey],a.combinatorOptions=c,O.setAndWatch("formBladeMenu"+a.form.mapperKey,null,function(e){e&&(l.selectorArray.items=e)}))})}}]}}e.$inject=["menuSvc","$cohModal","notificationSvc","formStateSvc","cohModelManager","$timeout","$rootScope","cohUUID"],angular.module("cohesionApp").directive("cohBladesMenu",e)}(_,jQuery),function(){function e(n,i){return{restrict:"E",templateUrl:"scripts/directives/coh-blades-menu/ui-sortable-item.html",scope:!0,link:function(e,o,t){e.innerItem=e.$eval(t.ngModel),e.activeClass=i.getValue("activeStyle")===e.innerItem.uuid?"coh-blades-menu-active":"",n.enabled(o,!1)}}}e.$inject=["$animate","cohModelManager"],angular.module("cohesionApp").directive("treeItem",e)}(),function(v){function e(e,o,m,t,p,u,n,h,f,i,r,g){return{restrict:"E",scope:{form:"=",model:"="},templateUrl:"scripts/directives/coh-breakpoint-selector/coh-breakpoint-selector.html",controllerAs:"bps",bindToController:!0,controller:["$scope","styleBuilderSvc","formStateSvc",function(e,o,a){var l,s={};function t(o){var t,e,n,i,r;d(o)?h.showModal({},{showSuppression:!0,suppressionCookieKey:"coh.suppressModal.breakpoints"}).result.then(function(){m(function(){c(o)})}):(t=f.getCachedForm(p.forms[l.form.formKey])[0],_.each(t.items,function(e){!function o(e,t,n){var i;e.key&&((i=[]).push(l.form.mapperKey.split(".")[0]),t.breakpoints&&(i=a.state.currentLevel?i.concat(a.state.currentLevel):i).push("styles"),i.push(n.name),i=i.concat(e.key.split(".")),e.originalKeyValue=angular.copy(e.key.split(".")),e.breakpointName=n.name,e.key=i),_.each(e.items,function(e){o(e,t,n)})}(e,t,o)}),(e={custom:!o.iconName,key:[o.name],title:o.name,label:o.label,type:"cohBreakpointFieldset",items:t.items}).custom&&(e.label=o.label),n=function(o){var t=0,n=0;if("mobile-first"===a.state.gridSetting){var i=!0;return _.each(l.form.items[0].items,function(e){o<s[e.key[0]]&&i&&(i=!1,n=t),t++}),i?l.form.items[0].items.length:n}if("desktop-first"===a.state.gridSetting){var t=0,n=0,r=!0;return _.each(l.form.items[0].items,function(e){o>s[e.key[0]]&&r&&(r=!1,n=t),t++}),r?l.form.items[0].items.length:n}}(o.breakWidth),l.form.items[0].items.splice(n,0,e),i={iconName:o.iconName,name:o.name},e.items.forEach(function(e){r=r||e.endpoint}),l.form.currentBreakpoints.splice(n,0,i),l.selectedBreakpoints.push(o.name),o.selected=!0,u.addModelsToTree(l.model,null,l.form.mapperKey,!0),u.applyDefaultValues(l.form.items[0].items[n],l.model))}function c(i){i.selected=!1,_.pull(l.selectedBreakpoints,i.name),function e(o){if(void 0!==o)for(var t=0;t<o.length;t++){var n=o[t];if(n.key&&1===n.key.length){if(n.key[0]===i.name)return void e(n.items)}else n.key&&n.key.length&&_.unset(l.model,n.key),e(n.items)}}(l.form.items),delete l.model[i.name],_.remove(l.form.items[0].items,function(e){if(e.key[0]===i.name)return!0}),_.remove(l.form.currentBreakpoints,function(e){if(e.name===i.name)return!0})}function d(o){if(l.breakpointOptions)return _.some(l.selectedBreakpoints,function(e){return e===o.name})}this.$onInit=function(){var o;(l=this).selectedBreakpoints=[],l.toggleOption=t,l.isSelected=d,l.onToggleDrop=g.onToggleDrop,l.sGridSetting=v.cohesion.responsive_grid_settings.gridType,l.sGridOrder="mobile-first"===l.sGridSetting?["asc"]:["desc"],l.selectedBreakpoints=(o=[],_.each(l.form.items[0].items,function(e){o.push(e.key[0])}),o),l.breakpointOptions=_.orderBy(f.getCachedObject(p.breakpointOptions),["breakWidth"],l.sGridOrder),_.each(l.breakpointOptions,function(e){s[e.name]=e.breakWidth}),_.each(l.selectedBreakpoints,function(o){var e=_.find(l.breakpointOptions,function(e){return e.name===o});e&&(e.selected=!0)}),e.$on("coh-remove-breakpoint-row",function(e,o){o.parentKey===l.form.formKey&&c(_.find(l.breakpointOptions,{name:o.key}))})}}]}}e.$inject=["$q","$interval","$timeout","$uibModal","apiUrls","menuSvc","formStateSvc","$cohModal","cohApiSvc","ajaxSvc","notificationSvc","cohDropdownFix"],angular.module("cohesionApp").directive("cohBreakpointSelector",e)}((jQuery,Drupal,drupalSettings)),function(e){e.contains||(e.contains=e.includes)}(_),angular.module("cohesionApp").directive("cohButton",function(){return{templateUrl:"scripts/directives/coh-button/coh-button.html",restrict:"E",scope:{form:"="},bindToController:!0,controllerAs:"cb",replace:!0,controller:["$scope",function(t){this.$onInit=function(){this.buttonClick=function(e,o){angular.isFunction(o.onClick)?o.onClick(e,o):angular.isString(o.onClick)&&t.$eval(o.onClick,{$event:e,form:o})}}}]}}),function(L){function e(P,D,e,o,t,n,F,B,V,U,i,j){return{restrict:"E",templateUrl:"scripts/directives/coh-canvas-preview/coh-canvas-preview.html",controllerAs:"cp",scope:{cohKey:"=",cohCanvasName:"=",options:"="},controller:["$scope","$element",function(n,e){var r,a=angular.element(),i=angular.element(),o=angular.element(),l=V.state,t={"desktop-first":"xl","mobile-first":"xs"},s={};function c(){l.autoScaleOn=!l.autoScaleOn,o[0].scrollLeft=0}function d(e){var o=_.get(r.breakpoints,[l.selectedBreakpoint,"width"]),t=i.width();return l.scaleButtonText=_.divide(t,o),t<o&&l.autoScaleOn?l.scale=l.scaleButtonText:l.scale=1,l.autoScaleOn||e?l.scale=t<o?_.divide(t,o):1:l.scale=1,l.scale}function m(){l.autoScaleOn&&n.$apply(),f()}function p(){var e=_.get(r.breakpoints,[l.selectedBreakpoint,"width"]),o=i.width();return!l.autoScaleOn&&o<e}function u(e){l.columnWidth=e,a[0].contentWindow.postMessage(JSON.stringify({type:"setWidth",width:e}),"*")}function h(e){a.length&&a[0].contentWindow.postMessage(JSON.stringify({type:"setBgColor",color:_.get(e,"value.rgba")}),"*")}function f(){a.length&&a[0].contentWindow.postMessage(JSON.stringify({type:"updateHeight"}),"*")}function g(){a.length&&a[0].contentWindow.postMessage(JSON.stringify({type:"setContainerType",boxedWidth:l.boxedWidth}),"*")}function v(e){a.length&&(l.gridType=e,a[0].contentWindow.postMessage(JSON.stringify({type:"setGridType",gridType:e}),"*"))}function b(){return"("+_.round(_.multiply(l.scaleButtonText,100),0)+"%)"}function y(){!r.options.canvasPreview||r.options.standAlone?!r.options.sgmPreview||r.options.standAlone?r.previewSrc||B.broadcastXtabs("needUrl",{scope:P.settings.path.currentQuery.parent}):r.previewSrc="/":V.updateFrameUrl(n.cohKey,n.cohCanvasName).then(function(e){w(e.iframe_url)})}function w(e){var o=e.split("#");1<o.length&&o.splice(1,0,"#");e=-1===e.indexOf("?")?"?":"&";o.splice(1,0,e+(new Date).getTime()+"&popped="+r.options.standAlone),r.previewSrc=o.join("")}function k(){A();var i=0;Object.keys(r.css).length?_.forEach(r.css,function(e,o){var t,n=a.contents().find("#cohlink_"+s[o]);n.length||(n=a.contents().find('link[href^="'+o+'"]'),t=j.getUUID(),s[o]=t),n.length&&(i++,t=n[0],(n=document.createElement("link")).setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("id","cohlink_"+s[o]),n.setAttribute("href",e+"&time="+(new Date).getTime()),n.onload=function(){--i<=0&&T()},n.onerror=function(){--i<=0&&T()},(a[0].document||a[0].contentWindow.document).getElementsByTagName("head").item(0).replaceChild(n,t))}):T()}function S(){return!r.options||r.options.hideIframe?{opacity:0}:!r.options.standAlone&&r.options.canvasPreview?{height:"calc((100vh - 210px)",width:_.multiply(r.breakpoints[l.selectedBreakpoint].mobilePlaceholderWidth||r.breakpoints[l.selectedBreakpoint].width,l.scale)}:!r.options.standAlone&&r.options.sgmPreview?{height:"100%",minHeight:"calc((100vh - 240px)",width:_.multiply(r.breakpoints[l.selectedBreakpoint].mobilePlaceholderWidth||r.breakpoints[l.selectedBreakpoint].width,l.scale),maxWidth:"100%",opacity:1}:void 0}function $(){return r.options?!r.options.standAlone&&r.options.canvasPreview?{height:"calc((100vh - 210px) *  (1 / "+l.scale+")",width:_.get(r.breakpoints,[l.selectedBreakpoint,"width"])||"100%",transform:"scale("+r.getScale()+","+r.getScale()+")"}:!r.options.standAlone&&r.options.sgmPreview?{height:"calc(100% * (1 / "+l.scale+")",width:_.get(r.breakpoints,[l.selectedBreakpoint,"width"])||"100%",transform:"scale("+r.getScale()+","+r.getScale()+")"}:{width:_.get(r.breakpoints,[l.selectedBreakpoint,"width"])||"100%"}:{}}function x(){return r.options.standAlone?_.get(P,"settings.path.currentQuery.parent"):window.location.pathname}function C(e){if(window.location.href!==e.url&&"cohBroadcast"===e.key&&e.newValue){var o,t=JSON.parse(e.newValue);if(!t.data.scope||t.data.scope===x())switch(t.key){case"highlightElement":r.options.standAlone&&(o=t.data.uuid,a.length&&a[0].contentWindow&&a[0].contentWindow.postMessage(JSON.stringify({type:"setHighlightedElement",uuid:o}),"*"));break;case"newUrl":r.options.standAlone&&(r.disconnectedFromParent=!1,t.data.css&&(r.css=t.data.css),w(t.data.frameSrc),n.$apply());break;case"newCSSLoading":A();break;case"newCSS":r.css=t.data.data,k();break;case"needUrl":r.options.standAlone||(r.options.sgmPreview?B.broadcastXtabs("newUrl",{frameSrc:r.previewSrc,scope:window.location.pathname,css:r.css}):V.updateFrameUrl(n.cohKey,n.cohCanvasName));break;case"leftUrl":r.options.standAlone&&(r.disconnectedFromParent=!0,n.$apply());break;default:return}}}function M(){window.close()}function A(){D(function(){-1===r.iframeClasses.indexOf("coh-preview-css-loading")&&r.iframeClasses.push("coh-preview-css-loading")})}function T(){D(function(){r.iframeClasses.splice(r.iframeClasses.indexOf("coh-preview-css-loading"),1)})}function I(){a=angular.element("iframe",e),i=angular.element(".coh-canvas-preview-container",e),o=angular.element(".coh-canvas-preview",e),r.resizeOptions={handles:{s:angular.element(".coh-iframe-resize",e)},alsoResize:".coh-canvas-preview-iframe",stop:function(){l.autoScaleOn=!1,n.$apply()},disabled:r.options.standAlone||U.isIOS()},r.options.sgmPreview&&(A(),a.on("load",function(){var e;!function(){var e=a[0].contentWindow.document,o=e.createElement("script");o.type="text/javascript",o.src=L.canvas_preview_js;var t=e.createElement("link");t.rel="stylesheet",t.media="all",t.href=L.canvas_preview_css,L.canvas_preview_js&&e.body.appendChild(o),L.canvas_preview_css&&e.head.appendChild(t)}(),k(),a.contents().find('[data-block-plugin-id="local_tasks_block"]').remove(),o=a[0].contentWindow.Drupal.toolbar.views.toolbarVisualView.model.attributes.height,e=parseFloat(a.contents().find("body").css("paddingTop")),a.contents().find("#toolbar-bar").hasClass("js-settings-tray-edit-mode")&&a.contents().find('[data-drupal-settingstray="toggle"]').click(),a.contents().find("body").css("paddingTop",e-o+"px").removeClass("toolbar-tray-open toolbar-fixed toolbar-vertical toolbar-horizontal").find("#toolbar-administration").remove(),a.contents().find("[data-contextual-id]").remove();var o=a[0].contentWindow;o.addEventListener("pageshow",function(){T()}),o.addEventListener("unload",function(){A()})}))}function E(e){var o,t;try{t=(o=JSON.parse(e.data)).type}catch(e){return}switch(t){case"contentResized":n.$apply();break;case"placeholderResized":r.options.standAlone?B.broadcastXtabs("storePlaceholderHeight",{scope:x(),height:o.height,uuid:o.uuid}):_.set(F.getNodeData(F.getNodeByUUID(o.uuid),"model"),"settings.placeholderHeight",o.height);break;case"elementMouseEnter":case"elementMouseLeave":r.options.standAlone&&B.broadcastXtabs("elementMouseEnter"===t?"highlightElement":"unHighlightElement",{scope:x(),uuid:o.uuid});break;case"ready":u(l.columnWidth),g(),v(l.gridType),h(l.colorModel);break;default:return}}function O(){r.columnMenuOpen&&(r.columnMenuOpen=!1,n.$apply())}this.$onInit=function(){(r=this).state=l,r.getFrameStyle=$,r.getContainerStyle=S,r.setWidth=u,r.onToggleContainerType=g,r.setGridType=v,r.refreshFrame=_.throttle(y,1500,{}),r.onBrowserResize=_.debounce(m,300,{}),r.toggleScale=c,r.getScale=d,r.isPreviewScrollable=p,r.getZoom=b,r.closeWindow=M,r.registerElements=I,r.getCurrentCommsScope=x,r.css={},r._range=_.range,r.iframeClasses=[],void 0===_.get(n,"options")&&_.set(n,"options",{}),r.options=n.options,r.resizable=!r.options.standAlone&&r.options.canvasPreview,r.showPopout=r.options.sgmPreview,r.breakpoints=P.cohesionSettings.responsive_grid_settings.breakpoints,r.columnMenuOpen=!1,r.disconnectedFromParent=!1,r.previewSrc="",r.colorPickerOptions={showMode:"palette"},r.toolbar=r.options.toolbar,function(){window.addEventListener("message",E),window.addEventListener("storage",C),window.addEventListener("resize",r.onBrowserResize),window.addEventListener("blur",O),n.$watch(function(){return l.selectedBreakpoint},function(e,o){e!==o&&f()}),r.toolbar.colorpicker&&n.$watch(function(){return l.colorModel},function(e,o){h(e)},!0);n.$on("coh:newCSS",function(e,o){Object.keys(o.data).length&&(r.css=o.data),k()})}(),r.options.standAlone||(l.selectedBreakpoint=l.selectedBreakpoint||t[P.cohesionSettings.responsive_grid_settings.gridType]),_.get(n,"options.toolbar.colorpicker")&&r.iframeClasses.push("has-color-picker"),r.refreshFrame()},this.$onDestroy=function(){window.removeEventListener("storage",C),window.removeEventListener("resize",r.onBrowserResize),window.removeEventListener("message",E),window.removeEventListener("blur",O)}}]}}e.$inject=["drupalSvc","$timeout","$location","formStateSvc","ajaxSvc","cohFormPreviewModelSvc","CohLayoutCanvas","cohBroadcastSvc","cohCanvasPreviewSvc","cohDeviceService","cohSgmPreviewSvc","cohUUID"],angular.module("cohesionApp").directive("cohCanvasPreview",e)}(drupalSettings.cohesion),angular.module("cohesionApp").directive("cohCheckboxGroup",function(){return{scope:!0,restrict:"A",controllerAs:"ccg",controller:["$scope","ajaxSvc",function(o,e){function t(e){_.map(e,function(e){o.form.items.push({type:"section",htmlClass:o.form.toggleSectionClass,items:[{type:"checkboxToggle",title:e.label,key:o.form.key.concat([e.value]),isStyle:!0,schema:{type:"boolean"},defaultValue:o.form.defaultValue}]})})}this.$onInit=function(){o.form.items=[],o.form.endpoint?e.get(o.form.endpoint).then(function(e){t(e)}):t(o.form.fields)}}]}}),angular.module("cohesionApp").directive("cohCheckboxToggle",function(){return{templateUrl:"scripts/directives/coh-checkbox-toggle/coh-checkbox-toggle.html",require:"ngModel",bindToController:{model:"="},controllerAs:"ctw",controller:["$scope",function(o){var t,n={falseValue:!1,trueValue:!0};this.$onInit=function(){(t=this).form=_.defaultsDeep(o.form,n);var e=[];(_.isUndefined(t.model)||_.isNull(t.model))&&void 0!==t.form.defaultValue&&(t.model=t.form.defaultValue),null!==(e=t.model?/^{{([^{}]+)}}$/g.exec(t.model):e)&&e[1]&&(t.model=_.get(t.form,e[1])),(void 0!==t.form.trueValue&&t.form.trueValue===t.model||!0===t.model||"true"===t.model)&&(t.startActive=!0)}}]}}),function(){function e(s){return{restrict:"E",templateUrl:"scripts/directives/coh-clean-form-button/coh-clean-form-button.html",scope:{form:"=",model:"="},controllerAs:"ceb",bindToController:!0,controller:["$rootScope","$cohModal",function(t,e){var n;function o(){e.showModal({},{headerText:"Confirmation",bodyText:"Are you sure you want to hide all empty fields, breakpoints and sections in this form? Any data you have entered will remain.",showSuppression:!0,suppressionCookieKey:"coh.suppressModal.hiddenFields"}).result.then(function(){var e=l(n.form,{},i);l(n.form,e,r);e="styles";t.$broadcast("coh-remove-empty-array-rows-"+e),t.$broadcast("coh-remove-empty-breakpoint-rows-"+e),t.$broadcast("coh-remove-empty-sections-"+e,{form:n.form})})}function i(e,o){var t=_.get(n.model,e.key)||_.get(s.state.variableModeModel,e.key);void 0!==t&&""!==t&&(o[a(e.key)]=t)}function r(e,o){!_.isNil(o[a(e.key)])&&""!==o[a(e.key)]||t.$broadcast("coh-remove-field",{key:e.key.slice(e.key.length-2)})}function a(e){return e[e.length-2]}function l(e,o,t){return o=o||{},_.forEachRight(e.items,function(e){e.key&&e.key.length&&e.type&&-1===n.arrayTypes.indexOf(e.type)&&("show"!==e.selectorOverride&&("hide"===e.selectorOverride||_.has(e,"condition"))||t(e,o)),e.items&&l(e,o,t)}),o}this.$onInit=function(){(n=this).arrayTypes=["cohArray","fieldsetArray","cohBreakpointFieldset"],n.expanded=s.state.accordionsOpen,n.cleanForm=o}}]}}e.$inject=["formStateSvc"],angular.module("cohesionApp").directive("cohCleanFormButton",e)}(),function(){function e(r,a,l){return{scope:{model:"=ngModel",form:"=",options:"="},restrict:"E",templateUrl:"scripts/directives/coh-colour-picker-opener/coh-colour-picker-opener.html",bindToController:!0,controllerAs:"ccpo",controller:["$attrs","$scope","$element",function(e,o,t){var n;function i(){r.setPicker({type:"colour",form:n.form,model:n.model,modelKey:e.ngModel},t)}this.$onInit=function(){n=this,_.get(n.model,"variable")&&"$coh-dx8-transparent"!==_.get(n.model,"variable")&&(n.loading=!0,l.get(a.colour_palette+"/"+n.model.variable,{cache:!1}).then(function(e){n.model=e,n.model.value=_.get(n.model,"value.value"),_.isArray(n.model.tags)&&(n.model.tags=n.model.tags.map(function(e){return e.label})),n.loading=!1})),n.openPickerMenu=i,n.options||(n.options={}),n.options.preferredFormat=n.options.preferredFormat||"hex",n.form.colourPickerOptions=angular.extend({},{flat:!0},n.form.colourPickerOptions)}}]}}e.$inject=["cohPickerSvc","apiUrls","ajaxSvc"],angular.module("cohesionApp").directive("cohColourPickerOpener",e)}(),function(p){function e(s,b,y,w,c,k,d,m){return{restrict:"E",scope:{options:"=?",model:"=ngModel",colour:"=?",form:"=",reset:"=?",spinnerSize:"="},templateUrl:"scripts/directives/coh-colour-picker/coh-colour-picker.html",bindToController:!0,controllerAs:"ccp",compile:function(){return{post:function(i,r,e,a){var l=new MutationObserver(function(){var e,o=r.find(".sp-container");if(1===o.length){l.disconnect(),o.css("zIndex",d.getToolbarZindex()+1);var t;(t=new MutationObserver(function(){e&&(c.cancel(e),t.disconnect()),e=c(function(){a.form&&a.form.menuPicker&&r.find(".sp-replacer").off()},200)})).observe(r.find(".sp-palette-container")[0],{childList:!0,subtree:!0});var n=r.find(".sp-replacer");if(n.attr({role:"button",tabindex:0}),n.off("keypress").on("keypress",function(e){e=e.which;if(32===e||13===e)return p(this).click(),!1}),m.hasPermission("access color_picker")||"picker"===a.options.showOnly){if(!m.hasPermission("access color_picker"))return void r.find(".sp-replacer").css({cursor:"not-allowed"}).attr("title","You do not have permission to access to the color picker")}else a.options.showOnly="palette";n='<div class="menu colour-picker-tabs">';a.options&&a.options.showOnly&&"default"!==a.options.showOnly?("palette"===a.options.showOnly&&(n+='<div class="active coh-colour-palette-tab">Palette</div>'),"picker"===a.options.showOnly&&(n+='<div class="active coh-colour-picker-tab">Picker</div>')):(n+='<div class="coh-colour-palette-tab" ng-attr-tabindex="{{ccp.showMode===1 ? -1 : 0}}" ng-class="{active: ccp.showMode===1}" ng-click="ccp.setShowMode(1)" ng-disabled="ccp.showMode===1">Palette</div>',n+='<div class="coh-colour-picker-tab" ng-attr-tabindex="{{ccp.showMode===2 ? -1 : 0}}" ng-class="{active: ccp.showMode===2}" ng-click="ccp.setShowMode(2)" ng-disabled="ccp.showMode===2">Picker</div>'),o.prepend(n+="</div>");o.append('<div class="colour-picker-actions"><span ng-click="ccp.cancelClick()" class="coh-btn coh-picker-btn--revert">Revert</span><span ng-click="ccp.selectClick()" class="coh-btn coh-btn-alt coh-picker-btn--select">Select</span></div>');n=o.find(".sp-palette-container"),o=o.find(".sp-picker-container");n.append('<div class="sp-palette"><div class="sp-palette-row"><span class="sp-thumb-el sp-clear sp-clear-display" ng-class="{\'sp-thumb-active\': !ccp.model}" ng-if="ccp.options.showUnset" ng-click="ccp.clearPaletteColour()" role="button" uib-tooltip="Unset colour" tooltip-placement="auto bottom" ><span class="sp-thumb-inner"></span></span><span class="sp-thumb-el" data-color="{{color.value.rgba}}" ng-class="{\'sp-thumb-active\': ccp.model.variable === color.variable}" ng-repeat="color in ccp.options.palette" ng-click="ccp.selectPaletteColour(color.value.rgba)" role="button" uib-tooltip="{{color.name}}" tooltip-placement="auto bottom" ><span class="sp-thumb-inner" ng-style="{backgroundColor:color.value.rgba}"></span></span></div></div>'),o.find(".sp-clear").attr("ng-click","ccp.clearPaletteColour()"),a.selectClick=function(){r.find("input.input-small").spectrum("hide"),a.colour={value:_.get(a,"model.value")},a.revertValue=_.cloneDeep(a.model)},a.cancelClick=function(){a.revertValue?(a.model=a.revertValue,c(function(){a.currentModel=_.get(a.model,"value.rgba",void 0)})):(a.model=void 0,c(function(){a.currentModel=void 0})),r.find("input.input-small").spectrum("hide")},a.options&&(a.options.showMode?"palette"===a.options.showMode?a.showMode=1:"picker"===a.options.showMode&&(a.showMode=2):"palette"===a.options.showOnly?a.showMode=1:"picker"===a.options.showOnly&&(a.showMode=2)),1===a.showMode&&(n.addClass("tab-active"),o.removeClass("tab-active")),2===a.showMode&&(n.removeClass("tab-active"),o.addClass("tab-active")),s(r.find(".colour-picker-tabs"))(i),s(r.find(".colour-picker-actions"))(i),s(n)(i),s(o)(i),r.find(".sp-palette-toggle").unbind("click.spectrum")}a.revertValue=_.cloneDeep(a.model)});l.observe(r[0],{childList:!0,subtree:!0})}}},controller:["$scope","$element","$attrs","$timeout","uibDropdownService","cohTransparent",function(e,n,o,t,i,r){var a,l,s,c,d=[];function m(e){var o=e.length-1;return e="rgba("+(e=e.substring(4,o))+", 1)"}function p(e,o){var t,n,i,r;o?(a.currentModel=o,t=f(r=a.currentModel)?v(r):"rgb("===r.substring(0,4)?m(r):r,r=angular.copy(_.find(d,{value:{rgba:t}})),_.unset(r,"value.uid"),a.model=r||{},_.isArray(a.model.tags)&&(a.model.tags=a.model.tags.map(function(e){return e.label})),u()):(t=a.currentModel,f(a.currentModel)&&(t=v(t)),l&&"rgb("===l.substring(0,4)&&(l=m(l)),_.isEqual(l,t)||e||null===t||(a.model={value:_.get(a,"model.value")},a.currentModel?a.model.value?(h(a.currentModel)?(a.model.value.rgba=a.currentModel,a.model.value.hex=g(a.currentModel)):f(a.currentModel)&&(a.model.value.hex=a.currentModel,a.model.value.rgba=v(a.currentModel)),u()):(h(a.currentModel)?(i=a.currentModel,n=g(a.currentModel)):f(a.currentModel)&&(n=a.currentModel,i=v(a.currentModel)),a.model.value={hex:n,rgba:i}):a.model={})),e&&(_.get(a.model,"uid")&&(r=_.find(d,{uid:a.model.uid}))&&(a.currentModel=r.value.rgba,a.model.value=r.value),u()),_.get(a.model,"value")?a.model.value=angular.copy(a.model.value):a.model={},f(l=angular.copy(a.currentModel))&&(l=v(l))}function u(){var e;_.get(a.model,"value.rgba")&&("rgba"!==a.model.value.rgba.substring(0,4)||"1"===(e=a.model.value.rgba.substring(5,a.model.value.rgba.length-1).split(", "))[3]?a.opacity=", 100%":(1===(e=e[3].substring(2,4)).length&&"0"!==e&&(e+="0"),a.opacity=", "+(e=""===e?"0":e)+"%"))}function h(e){return e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i)}function f(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}function g(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function v(e){e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return e?"rgba("+parseInt(e[1],16)+", "+parseInt(e[2],16)+", "+parseInt(e[3],16)+", 1)":null}this.$onInit=function(){l=(a=this).currentModel,a.options=angular.copy(a.options||{}),a.options.appendTo=n,a.modelChange=p,a.showMode=a.showMode||1,a.model||(a.model={}),a.options.cancelText=a.options.cancelText||"Cancel",a.options.chooseText=a.options.chooseText||"Done",a.options.preferredFormat=a.options.preferredFormat||"hex",a.options.showAlpha=a.options.showAlpha||!0,a.options.showInput=a.options.showInput||!0,a.options.showPalette=!1,a.options.allowEmpty=!0,a.options.flat=a.options.flat||!1,a.spinnerSize=a.spinnerSize||"medium",_.get(a,"model.value")&&(a.model.value.rgba?a.currentModel=a.model.value.rgba:a.model.value.hex&&(a.currentModel=a.model.value.hex)),a.options&&"picker"!==a.options.showOnly?(a.loading=!0,_.get(a,"form.availableColors")&&(s=a.form.availableColors.split(",")),_.get(a,"form.availableColorTags")&&(c=_.keys(_.pickBy(a.form.availableColorTags))),b.get(y.colour_palette,{cache:!1}).then(function(e){d=[r],_.size(e)&&(d=d.concat(e)),d=_.map(d,function(e){return(void 0===s||-1!==s.indexOf(e.variable))&&(!!(!c||_.intersection(c,_.map(e.tags,"value")).length&&e.tags)&&(void 0!==e&&void 0!==e.value.value&&(e.value=e.value.value),e))}),a.options.showUnset=_.isEmpty(s)||-1!==s.indexOf("unset"),d=_.compact(d),a.options.palette=d,p(!0),a.loading=!1,t(function(){jQuery(".blade .input-small").spectrum("show")})})):p(),e.$watch("ccp.model",function(){var e;w.state.variableMode||(a.model&&a.model.value&&(a.currentModel=a.model.value.rgba),(e=_.find(d,{value:{rgba:_.get(a.model,"value.rgba")}}))?p(!1,e.value.rgba):p(!0))},!0),a.setShowMode=function(e){var o=_.get(a.options,"showOnly");"picker"===o?e=2:"palette"===o&&(e=1);var t=n.find(".sp-container");a.showMode=e;o=t.find(".sp-palette-container"),t=t.find(".sp-picker-container");1===e&&(o.addClass("tab-active"),t.removeClass("tab-active")),2===e&&(o.removeClass("tab-active"),t.addClass("tab-active"),"rgba(0, 0, 0, 0)"===_.get(a.model,"value.rgba")&&(a.model.value.rgba="rgba(0, 0, 0, 1)"))},a.selectPaletteColour=function(e){p(!1,e)},a.clearPaletteColour=function(){e.ccp.model={},n.find("input.input-small").spectrum("set",void 0)},a.reset=function(){a.setShowMode(1)},a.openPickerMenu=function(){a.form.menuPicker&&k.setPicker({type:"colour",form:a.form,model:a.model,modelKey:o.ngModel},n)},a.setShowMode(_.isEmpty(_.get(a.model,"value"))||a.model.variable?1:2),a.onBeforeShow=function(e){i.open(),a.revertValue=_.cloneDeep(a.model)}}}]}}e.$inject=["$compile","ajaxSvc","apiUrls","formStateSvc","$timeout","cohPickerSvc","cohDrupalToolbar","cohPermissionService"],angular.module("cohesionApp").directive("cohColourPicker",e)}(jQuery),function(){e.$inject=["CohLayoutCanvas"],angular.module("cohesionApp").directive("cohColumnClasses",e);var s=["column","component-drop-zone"];function e(l){return{restrict:"A",scope:!0,require:"^ngModel",link:function(e,o,t){var t=t.cohColumnClasses,a=l.getNodeByUUID(t);e.$watch(function(){return l.canvasData.model[a.componentContentId||a.uuid]},function(){var e,n,i,r;_.includes(s,a.uid)&&(e=a,n=[],i=_.get(l.canvasData.previewModel[e.componentContentId||e.uuid],"settings.styles"),(r=_.get(l.canvasData.model[e.componentContentId||e.uuid],"settings.styles"))&&(Object.getOwnPropertyNames(r).forEach(function(e){var o=_.get(r,[e,"col"]),t=_.get(i,[e,"col"]);-1===o||-1===t?n.push("coh-layout-col-"+e+"-hidden"):-2===o||-2===t?n.push("coh-layout-col-"+e):-3===o||-3===t?n.push("coh-layout-col-"+e+"-auto"):t?n.push("coh-layout-col-"+e+"-"+String(i[e].col).replace(".","-")):o&&n.push("coh-layout-col-"+e+"-"+String(r[e].col).replace(".","-"))}),n.length&&(n.push("coh-layout-column-width"),l.setNodeStatus(e,"breakpointClasses",n.join(" ")))))})}}}}(),angular.module("cohesionApp").directive("cohComponentForm",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-component-form/coh-component-form.html",controller:["$scope","formStateSvc","cohPermissionService","cohTokenSvc",function(e,o,t,n){this.$onInit=function(){e.form.isOpen=!0,e.loaded=!1,o.variableModeAvailable=!!_.get(e.schema,"cohConfig.variableModeAvailable")&&t.hasPermission("access tokens"),n.applyListener()},this.$onDestroy=function(){n.removeListener()}}]}}),angular.module("cohesionApp").directive("cohComponentTranslationSettings",function(){return{restrict:"E",scope:{form:"=",model:"="},templateUrl:"scripts/directives/coh-component-translation-settings/coh-component-translation-settings.html",controller:["$scope","$rootScope","$timeout","cohApiSvc",function(a,e,t,o){var l;function s(e){return e.reduce(function(e,o){o.type,o.title;var t=o.uuid,n=o.uid,i=o.children,r=void 0===i?[]:i,o=["config_layout_canvas","model",t,"settings"];return l[n].translate&&_.get(a.model,o)&&(t=(i=_.get(a.model,o)).machineName,n=i.title,i=void 0===(i=i.translate)||i,e.push({title:n,machineName:t,showMachineName:!0,key:o.concat(["translate"]),type:"checkboxToggle",disableVarSwitcher:!0,defaultValue:i,schema:{type:"boolean"}})),e=r&&Array.isArray(r)?e.concat(s(r)):e},[])}this.$onInit=function(){o.get("form_elements").then(function(e){l=e;a.$watch("model.config_layout_canvas.componentForm",function(e){a.form.items=s(e)})}),e.$on("cohFormSaving",function(e,o){o&&o.key&&"styles"===o.key||t(function(){a.form.items=s(_.get(a,"model.config_layout_canvas.componentForm"))})})}}]}}),function(){function e(i){return{restrict:"A",require:"ngModel",link:function(e,o,t,n){n.$formatters.push(function(e){return i.UUIDtoMachine(e)}),n.$parsers.push(function(e){return i.machineToUUID(e)})}}}e.$inject=["cohUUID"],angular.module("cohesionApp").directive("cohComponentVariableFormatter",e)}(),jQuery,angular.module("cohesionApp").directive("cohContextEditWrapper",function(){return{restrict:"E",controllerAs:"cfs",controller:["$scope","ajaxSvc","$rootScope","cohSchemaFormSvc","drupalSvc","$uibModal","$http","cohPermissionService",function(i,e,r,o,a,t,l,n){this.$onInit=function(){_.deepFindFirst(a.cohesionSettings.entityForm.json_values.canvas,"children",function(e){return e.uuid===a.cohesionSettings.componentInstanceUuid&&(i.element=e,!0)}),n.canEditNode(i.element)?(i.modal=t.open({templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-settings-modal.html",size:"lg",controller:"CohLayoutCanvasModalController",windowClass:"coh-layout-canvas-settings coh-layout-canvas-settings-hide-header coh-in-context-editing",openedClass:"coh-layout-canvas-settings-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-layout-canvas-settings-backdrop",animation:!1,resolve:{element:i.element,model:function(){return a.cohesionSettings.entityForm.json_values.model[i.element.uuid]},previewModel:function(){return _.get(a.cohesionSettings.entityForm.json_values,["previewModel",i.element.uuid])||{}},variableFields:function(){return _.get(a.cohesionSettings.entityForm.json_values,["variableFields",i.element.uuid])||[]},forms:{},formDefinition:function(){if(a.cohesionSettings.isComponentContent)return{isInContextModal:!0,restrictSaveComponentContent:!0};var e=JSON.parse(a.cohesionSettings.componentFormJson);return e.isInContextModal=!0,e.restrictSaveComponentContent=!0,e}}}),i.modal.result.then(function(o){r.$broadcast("cohFormSaving");var e,t=jQuery("#cohesion-layout-edit-form"),n=t.serializeArray(),t=t[0].action;if(_.forEach(n,function(e){if("json_values"===e.name)return _.set(a.cohesionSettings,["entityForm","json_values","model",i.element.uuid],o.model),_.set(a.cohesionSettings,["entityForm","json_values","previewModel",i.element.uuid],o.previewModel),_.set(a.cohesionSettings,["entityForm","json_values","variableFields",i.element.uuid],o.variableFields),e.value=angular.toJson(a.cohesionSettings.entityForm.json_values),!1}),_.remove(n,function(e){return"json_mapper"===e.name}),n.length){try{e=jQuery.param(n)}catch(e){return}window.parent.postMessage("dx8.componentformajaxstart","*"),l({method:"POST",url:t+(-1===t.indexOf("?")?"?":"&")+"_wrapper_format=drupal_ajax&ajax_form=1",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){window.parent.postMessage("dx8.componentformapplied."+a.cohesionSettings.componentInstanceUuid,"*")}).finally(function(){window.parent.postMessage("dx8.componentformajaxend","*")})}},function(e){window.parent.postMessage("dx8.componentformcancelled","*")})):window.parent.postMessage("dx8.componentformcancelled","*")}()}]}}),angular.module("cohesionApp").directive("cohDraggableModal",function(){return{restrict:"C",link:function(e,o){_.includes(document.documentElement.className,"coh-is-ios")||o.children("div").first().draggable({refreshPositions:!0,handle:".modal-header"})}}}),angular.module("cohesionApp").directive("cohResizableModal",function(){return{restrict:"C",link:function(e,o){var t;_.includes(document.documentElement.className,"coh-is-ios")||(t=o.find(".modal-dialog > .modal-content").first(),o=o.find("div").first(),t.resizable({alsoResize:"#modal-body, #modal-body > iframe",minWidth:o.width()}))}}}),angular.module("cohesionApp").directive("cohEditedFieldIndicator",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-edited-field-indicator/coh-edited-field-indicator.html",controllerAs:"efi",controller:["$scope","drupalSvc","$timeout",function(o,e,t){var n;function i(e){return void 0===e||""===e||"object"===_typeof(e)&&_.isEmpty(e)}function r(e){e?-1===o.model.changedFields.indexOf(n.formKeyStr)&&o.model.changedFields.push(n.formKeyStr):-1!==(e=o.model.changedFields.indexOf(n.formKeyStr))&&o.model.changedFields.splice(e,1)}function a(){return-1!==o.model.changedFields.indexOf(n.formKeyStr)}function l(){_.set(o.model,n.formKey,s(n.initialModel)),t(function(){r(!1)})}function s(e){return e=e||o.model,_.get(e,n.formKey)}this.$onInit=function(){(n=this).isEdited=a,n.revert=l,n.formKey=o.form.key,n.formKeyStr=o.form.key.join("."),n.formKeyAngularStr=o.form.key.reduce(function(e,o,t){return 0===t?o:e+"['".concat(o,"']")}),n.initialModel=e.cohesionSettings.parentEntityForm.json_values,_.isArray(o.model.changedFields)||(o.model.changedFields=[]),t(function(){n.unregister=o.$watch("model."+n.formKeyAngularStr,function(e,o){e!==o&&(i(e)&&i(o)||_.isEqual(s(),s(n.initialModel))||r(!0))},!0)})},this.$onDestroy=function(){"function"==typeof n.unregister&&n.unregister()}}]}}),angular.module("cohesionApp").directive("cohElementBrowserNodesRenderer",["$compile","$animate",function(e,t){return{restrict:"E",template:'<ng-include src="dynamicTemplateUrl"></ng-include>',scope:!0,link:function(o,e){t.enabled(e,!1),o.$watch("showThumbs",function(e){o.dynamicTemplateUrl="scripts/directives/coh-element-browser/"+(e?"coh-element-browser-thumbs-nodes-renderer.html":"coh-element-browser-nodes-renderer.html")})},controller:["$scope","$filter",function(t,n){var i;this.$onInit=(i=_.cloneDeep(t.node.children),t.node.children=n("filter")(t.node.children,t.search),t.$watch("search.title",function(e,o){e&&e.length?t.node.children=n("filter")(i,t.search):t.node.children=i}),void t.$on("$destroy",function(){t.node.children=i}))}]}}]),angular.module("cohesionApp").directive("cohElementSettings",function(){return{scope:{form:"=",model:"="}}}),function(p,u){angular.module("cohesionApp").directive("cohEntityBrowser",function(){return{restrict:"E",require:"ngModel",scope:{form:"=",ngModel:"=",model:"="},templateUrl:"scripts/directives/coh-entity-browser/coh-entity-browser.html",controllerAs:"cmeb",controller:["$scope","ajaxSvc","$rootScope",function(a,l,n){var s,o,t,i;function r(){return!p.isUndefined(p.get(a,"form.hideRowHeading"))&&!0===p.get(a,"form.hideRowHeading")}function c(){return!p.isUndefined(p.get(a,"form.showConfig"))&&!0===p.get(a,"form.showConfig")}function d(){var e=p.get(a,"form.options.entityBrowserBundlesDisabled");p.get(a,"ngModel.entityType")&&(!e&&p.get(a,"ngModel.bundles")||p.set(a,"ngModel.bundles",p.clone(p.get(a,"form.options.bundles"))),l.get("/cohesionapi/entity_types/"+p.get(a,"ngModel.entityType")+"/bundles").then(function(e){var o=[{type:"section",htmlClass:"col-xxs-12",condition:!c(),items:[{type:"checkboxToggle",title:"Disable bundle selection",key:["settings","options","entityBrowserBundlesDisabled"],isStyle:!0,defaultValue:!0,condition:!c(),schema:{type:"boolean"},disableVarSwitcher:!0}]}];s.bundles.items=p.concat(o,p.map(e,function(e){return{type:"section",htmlClass:t,items:[{type:"checkboxToggle",title:e.label,key:a.form.key.concat(["bundles",e.value]),isStyle:!0,schema:{type:"boolean"},disableVarSwitcher:!0}]}}))||[],m()}))}function m(){var e=["/cohesionapi/entity_browser_url"],o=["/cohesionapi/autocomplete"],t=!1,n=p.get(a,"ngModel.entityBrowserType"),i=p.get(a,"ngModel.entityType"),r=p.get(a,"ngModel.bundles");o.push("/".concat(i)),o.push("/default:".concat(i,"?")),n&&(e=p.concat(e,"?entity_browser_id=",n),i&&(e=p.concat(e,"&entity_type=",i),t=!0),r&&(e=p.concat(e,p.reduce(r,function(e,o,t){return!0===o?p.concat(e,"&target_bundles[]="+t):e},[])),r=p.reduce(r,function(e,o,t){return!0===o&&e.push(t),e},[]),o.push("&".concat(u.param({bundles:r}))))),t&&l.get(e.join("")).then(function(e){s.entityBrowser.url=e.url,void 0!==e.uuid&&(void 0===drupalSettings.entity_browser&&(drupalSettings.entity_browser={}),drupalSettings.entity_browser[e.uuid]={cardinality:e.cardinality,selection_mode:e.selection_mode})}),o.push("&q="),s.entityBrowserTypeahead.endpoint="".concat(o.join(""))}this.$onInit=function(){s=this,p.isEmpty(a.ngModel)&&p.isArray(a.ngModel)&&(a.ngModel={});{var e,o;c()?(p.get(a,"model.settings.options.entityBrowserType")&&p.set(a,"ngModel.entityBrowserType",p.get(a,"model.settings.options.entityBrowserType")),p.get(a,"model.settings.options.entityType")&&p.set(a,"ngModel.entityType",p.get(a,"model.settings.options.entityType")),p.get(a,"model.settings.options.bundles")&&p.set(a,"ngModel.bundles",p.clone(p.get(a,"model.settings.options.bundles")))):(e=p.get(a,"form.options.entityBrowserTypeDisabled"),o=p.get(a,"form.options.entityTypeDisabled"),!e&&p.get(a,"ngModel.entityBrowserType")||!p.get(a,"form.options.entityBrowserType")||p.set(a,"ngModel.entityBrowserType",p.get(a,"form.options.entityBrowserType")),!o&&p.get(a,"ngModel.entityType")||!p.get(a,"form.options.entityType")||p.set(a,"ngModel.entityType",p.get(a,"form.options.entityType")))}var t=!0;s.unwatchGroup=a.$watchGroup(["ngModel.entityBrowserType","ngModel.entityType"],function(e,o){e===o&&!t||(t=!1,p.get(a,"ngModel.entityType")&&p.set(a,"ngModel.entity.entityType",p.get(a,"ngModel.entityType")),d())},!0),s.unwatchModel=a.$watch("ngModel",function(){m()},!0),s.unWatchSaving=n.$on("cohFormSaving",function(){c()?(p.get(a,"ngModel.entityBrowserType")&&p.set(a,"model.settings.options.entityBrowserType",p.get(a,"ngModel.entityBrowserType")),p.get(a,"ngModel.entityType")&&p.set(a,"model.settings.options.entityType",p.get(a,"ngModel.entityType")),p.get(a,"ngModel.bundles")&&p.set(a,"model.settings.options.bundles",p.clone(p.get(a,"ngModel.bundles"))),p.unset(a,"ngModel.entityBrowserType"),p.unset(a,"ngModel.entityType"),p.unset(a,"ngModel.bundles")):(p.get(a,"ngModel.entityBrowserType")===p.get(a,"form.options.entityBrowserType")&&p.unset(a,"ngModel.entityBrowserType"),p.get(a,"ngModel.entityType")===p.get(a,"form.options.entityType")&&p.unset(a,"ngModel.entityType"),p.isEqual(p.get(a,"ngModel.bundles"),p.get(a,"form.options.bundles"))&&p.unset(a,"ngModel.bundles")),s.unwatchModel(),s.unwatchGroup()}),d()},this.$onDestroy=function(){s.unWatchSaving()},this.$postLink=function(){var e=p.get(a,"form.key")||[];e.length&&(i=p.isArray(a.form.key)?'["'+a.form.key.join('"]["')+'"]':"["+a.form.key+"]");o="col-xxs-12",t="col-xxs-6 col-xs-3 col-md-2",!0===c()&&(o="col-xxs-12 col-xs-6");s.bundles={type:"section",htmlClass:"row",items:[]},s.entityBrowser={isStyle:!0,type:"cohFileBrowser",key:e.concat(["entity"]),title:p.get(a,"form.title")||"Entity",url:"",options:{buttonText:"Browse",imageUploader:!1,modelAsEntity:!0,removeLabel:"Remove",isEntityBrowser:!0},condition:"model"+i+'.entityBrowserType != "typeahead" && model'+i+".entityType",schema:{type:"object"},disableVarSwitcher:!0,tooltipText:a.form.entityBrowserTooltipText,tooltipPlacement:a.form.entityBrowserTooltipPlacement},s.entityBrowserTypeahead={type:"cohTypeahead",title:p.get(a,"form.title")||"Entity",key:e.concat(["entity"]).concat(["entityId"]),isStyle:!0,placeholder:"Type entity name",typeaheadEditable:!0,labelProperty:"name",valueProperty:"id",endpoint:"",condition:"model"+i+'.entityBrowserType == "typeahead" && model'+i+".entityType",schema:{type:"string"},disableVarSwitcher:!0,tooltipText:a.form.entityBrowserTooltipText,tooltipPlacement:a.form.entityBrowserTooltipPlacement},s.items=[{type:c()?"cohAccordion":"cohSection",htmlClass:c()?"coh-accordion-panel-body--dark coh-entity-browser-section coh-entity-browser-section--type":"coh-entity-browser-section coh-entity-browser-section--type",isOpen:!0,title:c()?"Field settings":"Entity browser settings",breakpoints:!1,propertiesMenu:!1,disableScrollbar:!0,disableEllipsisMenu:!0,condition:!p.get(a,"form.options.entityBrowserTypeDisabled")+" || "+!p.get(a,"form.options.entityTypeDisabled"),hideRowHeading:r(),removePadding:!0,helpKey:c()?"component-fields-field-settings-entity-browser":void 0,items:[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:o,items:[{type:"cohSelect",key:e.concat(["entityBrowserType"]),title:"Entity browser type",nullOption:!1,valueProperty:"value",labelProperty:"label",endpoint:"/cohesionapi/entity_browsers",defaultValue:"typeahead",readonly:p.get(a,"form.options.entityBrowserTypeDisabled"),condition:p.get(a,"form.options.entityBrowserTypeDisabled"),schema:{type:"string"},isStyle:!0,disableVarSwitcher:!0,tooltipText:a.form.entityBrowserTypeTooltipText,tooltipPlacement:a.form.entityBrowserTypeTooltipPlacement}]},{type:"section",htmlClass:o,condition:!c(),items:[{type:"checkboxToggle",title:"Disable Entity browser type selection",key:["settings","options","entityBrowserTypeDisabled"],isStyle:!0,defaultValue:!0,schema:{type:"boolean"},disableVarSwitcher:!0}]},{type:"section",htmlClass:o,condition:"model"+i+".entityBrowserType",items:[{type:"cohSelect",key:e.concat(["entityType"]),title:"Entity type",nullOption:!1,valueProperty:"value",labelProperty:"name",endpoint:"/cohesionapi/entity_types",readonly:p.get(a,"form.options.entityTypeDisabled"),defaultValue:"media",condition:p.get(a,"form.options.entityTypeDisabled")+' !== "undefined"',schema:{type:"string"},isStyle:!0,disableVarSwitcher:!0,tooltipText:a.form.entityTypeTooltipText,tooltipPlacement:a.form.entityTypeTooltipPlacement}]},{type:"section",htmlClass:o,condition:!c(),items:[{type:"checkboxToggle",title:"Disable Entity type selection",key:["settings","options","entityTypeDisabled"],isStyle:!0,defaultValue:!0,condition:"model"+i+".entityBrowserType",schema:{type:"boolean"},disableVarSwitcher:!0}]}]}]},{type:c()?"cohAccordion":"cohSection",htmlClass:c()?"coh-accordion-panel-body--dark coh-entity-browser-section coh-entity-browser-section--toggles":"coh-entity-browser-section coh-entity-browser-section--toggles",isOpen:!0,title:"Bundles",breakpoints:!1,propertiesMenu:!1,disableScrollbar:!0,disableEllipsisMenu:!0,condition:"model"+i+".entityBrowserType && model"+i+".entityType && "+!p.get(a,"form.options.entityBrowserBundlesDisabled"),hideRowHeading:r(),removePadding:!0,helpKey:c()?"component-fields-field-settings-entity-browser-bundles":"element-entity-browser-bundles",items:[s.bundles]},{type:c()?"cohAccordion":"cohSection",htmlClass:c()?"coh-accordion-panel-body--dark coh-entity-browser-section coh-entity-browser-section--browser":"coh-entity-browser-section coh-entity-browser-section--browser",isOpen:!0,title:c()?"Default":void 0,breakpoints:!1,propertiesMenu:!1,disableScrollbar:!0,disableEllipsisMenu:!0,hideRowHeading:r(),removePadding:!0,helpKey:c()?"component-fields-field-settings-entity-browser-default":void 0,items:[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-xxs-12",items:[s.entityBrowser,s.entityBrowserTypeahead]}]}]}]}}]}})}(_,jQuery),angular.module("cohesionApp").directive("cohEntityPicker",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-entity-picker/coh-entity-picker.html",controllerAs:"cep",controller:["$scope","$timeout",function(n,e){var i;this.$onInit=function(e,o,t){i=this},this.$postLink=function(){var e="",o=_.get(n,"form.key")||[];o.length&&(e=_.isArray(n.form.key)?'["'+n.form.key.join('"]["')+'"]':"["+n.form.key+"]");var t="col-xxs-12";n.form.showConfig&&(t="col-xxs-12 col-xs-6");i.items=[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:t,items:[{type:"cohSelect",key:o.concat(["entity_type"]),title:"Entity type",nullOption:!1,valueProperty:"value",labelProperty:"name",defaultValue:"node",readonly:_.get(n,"form.options.entity_type_disabled"),endpoint:'"/cohesionapi/entity_types"',schema:{type:"string"},isStyle:!0,disableVarSwitcher:!0,tooltipText:n.form.entityTypeTooltipText,tooltipPlacement:n.form.entityTypeTooltipPlacement}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:t,items:[{isStyle:!0,type:"cohSelect",key:o.concat(["view_mode"]),title:"View mode",nullOption:!1,valueProperty:"value",labelProperty:"name",readonly:_.get(n,"form.options.view_mode_disabled"),endpoint:'"/cohesionapi/view-modes/" + model'+e+".entity_type",model:"model",modelToWatch:"model"+e+".entity_type",schema:{type:["string","null"]},condition:"model"+e+".entity_type",disableVarSwitcher:!0,tooltipText:n.form.viewModeTooltipText,tooltipPlacement:n.form.viewModeTooltipPlacement}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:t,items:[{type:"cohTypeahead",title:"Entity",key:o.concat(["entity"]),isStyle:!0,placeholder:"Type entity name",typeaheadEditable:!0,labelProperty:"name",valueProperty:"id",endpoint:'"/cohesionapi/autocomplete/" + model'+e+'.entity_type + "/default:" + model'+e+'.entity_type + "?q="',schema:{type:"string"},condition:"model"+e+".view_mode",disableVarSwitcher:!0,tooltipText:n.form.entityTooltipText,tooltipPlacement:n.form.entityTooltipPlacement}]}]}],n.form.showConfig&&(i.items[0].items.splice(1,0,{type:"section",htmlClass:t,items:[{type:"checkboxToggle",key:["settings","options","entity_type_disabled"],title:"Prevent editing of Entity type",defaultValue:!1,schema:{type:"boolean"},disableVarSwitcher:!0}]}),i.items[1].items.splice(1,0,{type:"section",htmlClass:t,items:[{type:"checkboxToggle",key:["settings","options","view_mode_disabled"],title:"Prevent editing of View mode",defaultValue:!1,schema:{type:"boolean"},condition:"model.settings.options.entity_type_disabled",disableVarSwitcher:!0}]}))}}]}}),angular.module("cohesionApp").directive("cohFieldMachineName",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-field-machine-name/coh-field-machine-name.html",controllerAs:"cmn",require:"ngModel",scope:{form:"=",model:"=",ngModel:"="},bindToController:!0,controller:["$scope","cohUUID",function(e,t){var n;function o(){n.editable=!0,n.modelWatcher(),n.linked=!1}this.$onInit=function(){n=this,e.form=n.form,n.makeEditable=o,n.editable=!1,n.linked=!1,n.modelWatcher=angular.noop,void 0===n.ngModel&&(n.linked=!0,n.modelWatcher=e.$watch("cmn.model.settings.title",function(e){if(n.ngModel=e.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\_\-]+/g,""),t.findByMachineName(n.ngModel)){for(var o=1;t.findByMachineName(""+n.ngModel+o);)o++;n.ngModel=""+n.ngModel+o}}))}}]}}),function(s){function e(i,r,a,l){return{restrict:"E",scope:{model:"=ngModel",form:"=",options:"=",remove:"=",preview:"="},template:'<div ng-include="getTemplateUrl()"></div>',link:function(t,e,o){var n;(e[0].scope=t).getEntityToken=function(e){return _.concat([],"[media-reference:",e.entityType,":",e.entityUUID,"]").join("")},t.isEntityToken=function(e){return/^(\[media\-reference\:)(\S+)(\:\S+)(\])$/gm.test(e)},t.model&&(_.isObject(t.model)&&t.model.entityType&&t.model.entityUUID||t.isEntityToken(t.model))&&(n=t.isEntityToken(t.model)?t.model:t.getEntityToken(t.model),r.get("/cohesionapi/entity-preview/"+n,{cache:!0}).then(function(e){t.preview=e}).catch(function(e){delete t.preview;a.notify({className:"error error-canvas element-block-save",content:"Failed to load preview image."})})),t.getTemplateUrl=function(){return t.form.options.imageUploader?"scripts/directives/coh-file-browser/coh-file-browser-image-uploader.html":"scripts/directives/coh-file-browser/coh-file-browser.html"},s.cohesion.fileBrowser={},s.cohesion.fileBrowser={scope:t,element:e,attrs:o},t.unregister=t.$watch("model",function(o,e){o!==e&&(o?t.form.isVariableMode?(t.model=o,delete t.preview):_.includes(o,"://")?r.get("/cohesionapi/uri-to-entity-reference?uri="+encodeURIComponent(o),{cache:!1}).then(function(e){t.preview=e.preview,t.model=e.reference}).catch(function(e){a.notify({className:"error error-canvas element-block-save",content:"Failed to load image entity."}),delete t.model,delete t.preview}):(_.isObject(o)||t.isEntityToken(o))&&(n=_.isObject(o)?t.getEntityToken(o):o,t.isEntityToken(n)&&r.get("/cohesionapi/entity-preview/"+n,{cache:!1}).then(function(e){t.preview=e,t.model=o,_.get(t,"form.options.modelAsEntity")||(t.model=n)}).catch(function(e){a.notify({className:"error error-canvas element-block-save",content:"Failed to load preview image."}),delete t.model,delete t.preview})):(delete t.preview,t.model=""))}),l.$on("cohFormSaving",function(){t.unregister()}),t.launchBrowser=function(){if(s.cohesion.selectedElement=e,_.get(t,"form.url")||!_.isUndefined(_.get(s,"cohesion.imageBrowser"))||t.form.options.isEntityBrowser){if(t.form.url||t.form.options.isEntityBrowser){if(!t.form.url)return void a.notify({className:"danger",content:"This entity browser is misconfigured and cannot be opened."});t.title=_.get(t,"form.title"),t.type=_.get(t,"form.title"),t.url=_.get(t,"form.url")}else t.url=s.cohesion.imageBrowser.url,t.title=s.cohesion.imageBrowser.title,t.type=s.cohesion.imageBrowser.title;t.browseModal=i.open({templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-image-browser-modal.html",size:"lg",windowClass:"coh-modal coh-layout-canvas-image-browser-modal coh-draggable-modal coh-resizable-modal",openedClass:"coh-layout-canvas-image-browser-modal-open coh-modal-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-element-browser-backdrop",animation:!0,bindToController:!0,controllerAs:"cibm",scope:t,controller:function(){var e;this.$onInit=function(){(e=this).loaded=!1,e.iframeLoaded=function(){e.loaded=!0,t.$apply()}}}})}else a.notify({className:"warning warning-canvas element-block-save",content:"No image browser has been defined."})},t.closeBrowser=function(){t.browseModal.dismiss("cancel")},t.remove=function(){t.model=""}}}}e.$inject=["$uibModal","ajaxSvc","notificationSvc","$rootScope"],angular.module("cohesionApp").directive("cohFileBrowser",e)}(drupalSettings),function(n){function e(t,r,a){return{restrict:"E",scope:{model:"=ngModel",form:"=",formModel:"=",options:"="},templateUrl:"scripts/directives/coh-file-uploader/coh-file-uploader.html",bindToController:!0,controllerAs:"cfu",controller:["$scope",function(o){var i;function e(n,e){i.file=n,o.errFile=e&&e[0],n&&(i.loading=!0,n.upload=t.upload({url:i.form.endpoint,data:{file:n}}),n.upload.then(function(t){r(function(){return!i.form.successKeys||(o=t.data,e=i.form.successKeys,0<_.filter(e,function(e){return!_.isUndefined(_.get(o,e))&&!_.isNull(_.get(o,e))}).length)?(n.result=t.data,i.model=t.data,i.loading=!1,void(i.success=!0)):(i.loading=!1,i.success=!1,void a.notify({content:i.form.successKeysUploadError,className:"danger"}));var o,e})},function(e){0<e.status&&(e=e.data,o.errorMsg=e.status+": "+e.data,a.notify({content:e.message+": "+e.error,className:"danger"}),i.success=!1,i.loading=!1)},function(e){n.progress=Math.min(100,parseInt(100*e.loaded/e.total))})),e&&_.forEach(e,function(e){"maxSize"===e.$error?a.notify({content:"Error uploading file "+e.name+". The maximum allowed file size is "+function(e){for(var o=[" Bytes"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],t=1;t<o.length;t++)if(e<Math.pow(1024,t))return Math.round(e/Math.pow(1024,t-1)*100)/100+o[t-1];return e}(e.$errorParam),className:"danger"}):a.notify({content:"Error uploading"+e.name,className:"danger"})})}this.$onInit=function(){i=this,o.maxSize=_.isUndefined(n.cohesion.upload_max_filesize)?1e6:n.cohesion.upload_max_filesize,i.uploadFile=e}}]}}e.$inject=["Upload","$timeout","notificationSvc"],angular.module("cohesionApp").directive("cohFileUploader",e)}(drupalSettings),angular.module("cohesionApp").directive("cohFormBuilderToolbar",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-form-builder-toolbar/coh-form-builder-toolbar.html",controllerAs:"fbtb",transclude:!0,controller:["$scope","$rootScope","$attrs","formStateSvc","cohTokenSvc",function(e,o,t,n,i){var r;function a(){n.toggleVariableMode(),r.isVariableMode=n.state.variableMode}function l(){i.openDrupalDialog(void 0,"cohesion.drupalTokensUri")}this.$onInit=function(){(r=this).variableModeAvailable=n.variableModeAvailable,r.variableModeAvailable&&(r.toggleVariableMode=a,r.isVariableMode=n.state.variableMode,r.buttonOptions={variableSwitcher:{ariaLabel:"Toggle variable mode",tooltip:"Toggle variable mode",tooltipAppendBody:"true",tooltipPlacement:"top-left",tooltipClass:"coh-tooltip",style:"coh-toggle-variable-mode-btn coh-icon-toggle-variable-mode",onClick:a,hideText:!0},tokenBrowser:{ariaLabel:"Open token browser",tooltip:"Open token browser",tooltipAppendBody:"true",tooltipPlacement:"top-left",tooltipClass:"coh-tooltip",style:"coh-token-browser-btn coh-icon-open-token-browser",onClick:l,hideText:!0}},i.applyListener())},this.$onDestroy=function(){i.removeListener()}}]}}),angular.module("cohesionApp").directive("cohFormBuilder",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-form-builder/coh-form-builder.html",controller:["$scope","$rootScope","$timeout","$window","styleBuilderSvc","cohApiSvc","cohModelManager","menuSvc","formStateSvc","apiUrls","cohTokenSvc","cohSchemaFormSvc","cohPermissionService",function(i,e,r,o,a,l,t,s,c,d,n,m,p){this.$onInit=function(){i.$emit("coh-style-builder-rendering"),i.openTreeMenu=function(){i.openTreeFn()},i.openPropertiesMenu=function(){i.openPropertiesMenuFn()},i.openStyleHelperMenu=function(){i.openStyleHelperMenuFn()},i.changeForm=function(e,o,t){m.setGlobalDestroyStrategy("retain"),t&&(i.form={});_.has(o,"uuid")?(o=angular.copy(o.uuid),c.state.currentLevel=[o],e.currentLevel={uuid:[o]}):c.state.currentLevel=[];e.currentLevelTitle=e.currentLevelTitle||"Default",t?r(function(){i.form=e}):i.form=e;r(function(){m.setGlobalDestroyStrategy("remove")})},i.getChildStyleCount=function(){var t=0;return _.forEach(i.model.styles,function(e,o){"styles"!==o&&void 0!==e&&e.length&&(t+=e.length)}),t},i.showChildStyleCount=function(){return"object"!==_typeof(i.form.currentLevel)&&i.getChildStyleCount()},i.openTreeFn=null,i.openPropertiesMenuFn=null,i.initialiseTreeMenu=null,i.form.isOpen=!0,i.loaded=!1,i.form.mapperKey||(i.form.mapperKey="styles"),i.form.propertyOptionsKey&&(a.propertyOptionsKey=i.form.propertyOptionsKey),t.setAndWatch("formBuilderForm"+i.form.mapperKey,i.form.items,function(e){i.form.items=angular.copy(e)}),i.form.currentLevelTitle="Default";var n={form:angular.copy(i.form),schema:angular.copy(i.schema),model:i.model};c.variableModeAvailable=!!_.get(i.schema,"cohConfig.variableModeAvailable")&&p.hasPermission("access tokens"),l.getAll().then(function(){!function(){var e=i.form.mapperKey,o=!1;i.model[e]||(i.model[e]={});{var t;!c.state.mapper[e]||_.isEmpty(c.state.mapper[e])?(t=l.getCachedObject(d.form_defaults[i.form.defaultKey]))&&t[e]?(a.populateDefaultsWithBreakpoints(t[e]),c.state.mapper[e]=_.merge({},t[e],{title:i.form.label,selectorType:"topLevel"})):c.state.mapper[e]={formDefinition:null,title:i.form.label,selectorType:"topLevel",items:[]}:o=!0}a.initialiseStyleBuilder(i.form,n,i.changeForm),s.addModelsToTree(i.model,i.form,e,o),_.isUndefined(c.state.initialMapper)&&(c.state.initialMapper=angular.copy(c.state.mapper));i.loaded=!0,i.$emit("coh-style-builder-rendered")}()})}}]}}),function(){function e(i,r){return{scope:!1,restrict:"A",link:function(t,e,o){t.form=t.$eval(o.form);var n=t.form.key;n&&(t.$on("$destroy",function(){if(t.form.condition&&!t.$eval(t.form.condition)){var e=_.get(t.model,n);switch(i.getFieldDestroyStrategy(t.form)||i.getGlobalDestroyStrategy()){case"null":_.set(t.model,n,null);break;case"empty":_.set(t.model,n,"");break;case"remove":_.unset(t.model,n);break;case"retain":_.set(t.model,n,e);break;case"conditionalRetain":_.set(t.form,"defaultValue",angular.copy(_.get(t.model,n))),_.unset(t.model,n);break;default:_.unset(t.model,n)}}for(var o=0;o<n.length-1;o++)_.isEmpty(_.get(t.model,n.slice(0,-1-o)))&&_.isPlainObject(_.get(t.model,n.slice(0,-1-o)))&&_.unset(t.model,n.slice(0,-1-o))}),r(function(){void 0!==t.form.defaultValue&&(_.isUndefined(_.get(t,["model"].concat(t.form.key)))||_.isNull(_.get(t,["model"].concat(t.form.key))))&&_.set(t,["model"].concat(t.form.key),t.form.defaultValue)}))}}}e.$inject=["cohSchemaFormSvc","$timeout"],angular.module("cohesionApp").directive("cohFormModelManager",e)}(),angular.module("cohesionApp").directive("cohFormPreview",["cohFormBuilderRenderSvc",function(a){return{restrict:"E",templateUrl:"scripts/directives/coh-form-preview/coh-form-preview.html",scope:{options:"=?",model:"=ngModel",form:"="},bindToController:!0,controllerAs:"fpw",controller:["$scope","$document","cohFormPreviewModelSvc",function(o,e,n){var i;function r(e){i.formTitle=e.target.value,o.$apply()}this.$onInit=function(){(i=this).formTitle=e[0].getElementById("edit-label").value,i.key=i.form.key.slice(0,-1),i.formCanvasKey=i.form.formCanvasKey,e[0].getElementById("edit-label").addEventListener("change",r),i.sf={model:n.model,schema:{type:"object",properties:{cohesion:{type:"object"}},required:[]},form:[]},i.loaded=!0;var t=_.debounce(function(e,o){o=a.convert(angular.copy(e),angular.copy(o));o.form.unshift({type:"cohPickerMenu"}),o.form=[{type:"cohComponentForm",title:"settings",mapperKey:"settings",disableTreeMenu:!0,hideActionsBar:!0,propertyOptionsKey:"customComponent",defaultKey:"customComponent",preview:!0,items:o.form}],i.sf=o,n.model=i.sf.model},150,{trailing:!0});o.$watch(function(){return{form:i.model[i.key][i.formCanvasKey],model:i.model[i.key].model}},function(e,o){void 0===e.form&&void 0===e.model||t(e.form,e.model)},!0)}}]}}]),jQuery,angular.module("cohesionApp").directive("cohFrontEndEditWrapper",function(){return{restrict:"E",controllerAs:"cfs",controller:["$scope","ajaxSvc","$rootScope","cohSchemaFormSvc","drupalSvc","$uibModal","$http","cohPermissionService","CohLayoutCanvas",function(n,i,r,e,o,a,t,l,s){this.$onInit=function(){window.addEventListener("message",function(e){var o,t;0===window.location.href.indexOf(e.origin)&&(o=e.data.canvasData,t=e.data.componentData,s.initModelMapper(o),n.modal=a.open({templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-settings-modal.html",size:"lg",controller:"CohLayoutCanvasModalController",windowClass:"coh-layout-canvas-settings coh-in-context-editing",openedClass:"coh-layout-canvas-settings-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-layout-canvas-settings-backdrop",animation:!1,resolve:{element:t,model:function(){return o.model[t.uuid]},previewModel:function(){return _.get(o,["previewModel",t.uuid])||{}},variableFields:function(){return _.get(o,["variableFields",t.uuid])||[]},forms:{},formDefinition:function(){return!t.componentId||t.componentContentId?{}:i.get("/cohesionapi/cohesion-component/"+t.componentId).then(function(e){return e.isInContextModal=!0,e.restrictSaveComponentContent=!1,e})}}}),n.modal.result.then(function(e){r.$broadcast("cohFormSaving"),window.parent.postMessage({type:"dx8.componentformapplied",result:e},"*")},function(e){window.parent.postMessage({type:"dx8.componentformcancelled"},"*")}))},!1),window.parent.postMessage({type:"dx8.componentformready"},"*")}()}]}}),function(e){function o(l){return{restrict:"E",scope:{model:"=",ngModel:"=ngModel",form:"="},templateUrl:"scripts/directives/coh-google-marker/coh-google-marker.html",bindToController:!0,controllerAs:"gmw",transclude:!0,controller:["$scope","$sce","$timeout",function(t,n,i){var r=e.cohesion.google_map_api_key,o=e.cohesion.google_map_api_key_geo||r,a="https://www.google.com/maps/embed/v1/place?q=";t.errors={COH_MISSING_API_KEY:"Please ensure you have included a Google Maps API key",ZERO_RESULTS:'The Google maps API returned with the error "ZERO_RESULTS"',OVER_QUERY_LIMIT:'The Google maps API returned with the error "OVER_QUERY_LIMIT"',REQUEST_DENIED:'The Google maps API returned with the error "REQUEST_DENIED"',INVALID_REQUEST:'The Google maps API returned with the error "INVALID_REQUEST"',UNKNOWN_ERROR:'The Google maps API returned with the error "UNKNOWN_ERROR"'},t.findCoordinates=function(e){e&&(t.address=e,e="https://maps.googleapis.com/maps/api/geocode/json?address="+t.address+"&key="+o,l.get(e,{},!0).then(function(o){i(function(){var e;"OK"===o.status?(t.error=void 0,t.latCode=o.results[0].geometry.location.lat,t.longCode=o.results[0].geometry.location.lng,t.preview=!0,e=a+t.latCode+","+t.longCode+"&key="+r,t.previewUrl=n.trustAsResourceUrl(e),t.gmw.ngModel=t.setModel()):(t.error=t.getError(o.status),t.latCode="",t.longCode="")})}))},t.previewMarker=function(e,o){t.latCode=e,t.longCode=o;o=a+t.latCode+","+t.longCode+"&key="+r;t.previewUrl=n.trustAsResourceUrl(o),t.gmw.ngModel=t.setModel()},t.setModel=function(){var e=[t.latCode,t.longCode].join(",");return t.$parent.ngModel.$setDirty(),","===e.trim()?"":e},t.hasSchemaError=function(){return t.$parent.ngModel.$dirty&&t.$parent.ngModel.$invalid},t.getError=function(e){return _.has(t.errors,e)?t.errors[e]:e},t.init=function(){r&&!_.isUndefined(r)&&!_.isNull(r)||(t.error=t.getError("COH_MISSING_API_KEY"));var e=t.gmw.ngModel||t.gmw.form.defaultValue;e?(t.previewUrl=n.trustAsResourceUrl(a+e+"&key="+r),e=e.split(","),t.latCode=e[0],t.longCode=e[1]):t.previewUrl=""},this.$onInit=t.init}]}}o.$inject=["ajaxSvc"],angular.module("cohesionApp").directive("cohGoogleMarker",o)}(drupalSettings),function(m){function e(s,t,n,c,i,d){return{restrict:"E",scope:{form:"=",model:"=ngModel",options:"=?",gradX:"=?"},templateUrl:"scripts/directives/coh-gradient-picker/coh-gradient-picker.html",link:function(r,a,e){var l;function o(){r.gradModel={type:"linear",radial:{horizontal:"center",vertical:"center",size:"farthest-corner"},linear:{direction:90},sliders:[]};var e,o,t,n,i=null;(i=r.model?r.model:i)?(e=i.substring(0,i.indexOf("(")),o=i.substring(i.indexOf("(")+1,i.length).split(" , "),t=90,n=[],"linear-gradient"===e&&(t=o[0].replace(" ",","),r.gradModel.type="linear",r.gradModel.linear.direction=parseInt(t),n=o.splice(1)),"radial-gradient"===e&&(n=o.splice(1),-1!==i.indexOf("circle")&&(r.gradModel.type="circle"),-1!==i.indexOf("ellipse")&&(r.gradModel.type="ellipse"),t=(t=o[0].substring(o[0].indexOf("at ")+3,o[0].length)).split(" "),r.gradModel.radial.horizontal=t[0],r.gradModel.radial.vertical=t[1],r.gradModel.radial.size=o[0].split(" ")[1]),r.gradModel.sliders=(n=n,_.map(n,function(e){var o="",o=-1!==e.indexOf("%")?parseInt(e.substring(e.indexOf(") ")+2,e.indexOf("%"))):0;return{color:e.substring(0,e.indexOf(")")+1),position:o}}))):(r.type="linear",_.set(r,"linear.direction",90)),a.ready(function(){l=c.gradX("#gradientPicker"+r.gradientPickerKey,r),r.gradX=l;a.find("#gradx_add_slider");a.find(".gradx_show_code").remove(),a.find("textarea.gradx_code").bind("DOMSubtreeModified",function(){d(function(){r.model=r.gradTypes[r.gradModel.type]+"("+l.get_style_value()+")"})}),a.find("#gradx_gradient_type").attr("ng-model","gradModel.type"),a.find("#gradx_linear_direction").attr("ng-model","gradModel.linear.direction");var e=a.find("#gradx_radial_horizontal");e.val(r.gradSubType1),e.attr("ng-model","gradModel.radial.horizontal");e=a.find("#gradx_radial_vertical");e.val(r.gradSubType2),e.attr("ng-model","gradModel.radial.vertical");e=a.find("#gradx_radial_size");e.val(r.size),e.attr("ng-model","gradModel.radial.size");e=a.find(".gradx_start_sliders");s(e)(r),s(a.find(".gradx_slectboxes"))(r),s(a.find(".actions"))(r),l.update_style_array()})}r.gradTypes={circle:"radial-gradient",linear:"linear-gradient",ellipse:"radial-gradient"},r.select=function(){var e=a.find("textarea.gradx_code").html().replace(/(\r\n|\n|\r)/gm,"");r.model=e,r.open=!1},r.revert=function(){r.model=r.form.savedGradient,o()},r.togglePicker=function(){r.form.menuPicker?i.setPicker({type:"gradient",form:r.form,model:r.model,modelKey:e.ngModel},a):(r.open=!r.open,r.open&&n.addEventListener("click",function(){r.$apply()}))},r.form.savedGradient=r.model,r.gradientPickerKey=t.getGradientPickerKey(),a.find(".gradient-picker-popup").attr("id","gradientPicker"+r.gradientPickerKey),r.addColourPickerBlade=function(e){var o;m(e.delegateTarget)[0].attributes["no-click"]||(o=e.delegateTarget.parentElement.style.backgroundColor,i.addBlade({model:o,target:e.delegateTarget.parentElement},a))},r.deleteSlider=function(e,o){m(o.delegateTarget).parent().find(".clickable-box")[0].attributes["no-click"]||l.delete_slider(e)},o()}}}e.$inject=["$compile","formStateSvc","$window","gradientPickerSvc","cohPickerSvc","$timeout"],angular.module("cohesionApp").directive("cohGradientPicker",e)}(jQuery),angular.module("cohesionApp").directive("cohGridPreview",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-grid-preview/coh-grid-preview.html",scope:{model:"=ngModel",form:"="},bindToController:!0,controllerAs:"cgp",controller:["$scope",function(e){var t,n;e.$watch(function(){return n},function(e,o){n.mobilePlaceholderWidth=e.mobilePlaceholderWidth||o.mobilePlaceholderWidth,"Mobile"===e.label&&"mobile-first"!==t.model.gridType&&(n.width=n.width||o.mobilePlaceholderWidth),n.boxedWidth=(n.width||n.mobilePlaceholderWidth)-2*n.outerGutter,t.containerInnerStyle={width:0<n.width?n.width:n.mobilePlaceholderWidth,"padding-left":n.outerGutter,"padding-right":n.outerGutter},t.rowStyle={"margin-right":-n.innerGutter/2,"margin-left":-n.innerGutter/2},t.colStyle={"-ms-flex":"0 0 "+100/n.previewColumns+"%",flex:"0 0 "+100/n.previewColumns+"%","max-width":100/n.previewColumns+"%","padding-left":n.innerGutter/2,"padding-right":n.innerGutter/2}},!0),this.$onInit=function(){(t=this).model=e.cgp.model,t.form=e.cgp.form,n=t.model.breakpoints[t.form.gridSettings.breakpoint],t.bp=n}}]}}),function(){function e(t){return{restrict:"E",templateUrl:"scripts/directives/coh-helper-switcher/coh-helper-switcher.html",scope:{form:"="},controllerAs:"chsw",bindToController:!0,controller:function(){var e;function o(){t.toggleHelperMode(),e.helperMode=t.state.helperMode}this.$onInit=function(){(e=this).toggleHelpers=o,e.helperMode=t.state.helperMode}}}}e.$inject=["formStateSvc"],angular.module("cohesionApp").directive("cohHelperSwitcher",e)}(),function(){function e(t,r,n,a){return{scope:{model:"=",form:"="},restrict:"E",templateUrl:"scripts/directives/coh-hidden-field-selector/coh-hidden-field-selector.html",bindToController:!0,controllerAs:"hfs",controller:["$scope",function(e){var i;function o(n,e){function o(){!function o(t){var e;t.isStyle&&t.key&&(e=_.find(i.availableFields,function(e){return JSON.stringify(e.key)===JSON.stringify("value"!==t.key.slice(-1)[0]?t.key.slice(-1):t.key.slice(-2))}))&&(n&&!t.isActive||!n)&&(t.isActive=e.isActive,t.isActive||(_.unset(i.model,t.key),_.unset(a.state.variableModeModel,t.key),_.unset(a.state.previewModel,t.key))),t.originalArrayRow&&_.each(t.originalArrayRow.items,function(e){o(e)}),_.each(t.items,function(e){o(e)})}(i.form)}!n&&e&&!1===e.isActive?t.showModal({},{showSuppression:!0,suppressionCookieKey:"coh.suppressModal.hiddenFields"}).result.then(function(){r(function(){o()})},function(){e.isActive=!0}):o()}this.$onInit=function(){(i=this).availableFields=[],i.onToggleDrop=n.onToggleDrop,i.toggleActive=o,_.each(i.form.items,function(e){!function o(e){var t;e.key&&e.isStyle&&"cohArray"!==e.type&&(t={title:e.title,key:"value"!==e.key.slice(-1)[0]?e.key.slice(-1):e.key.slice(-2),conditional:"hide"===e.selectorOverride||_.has(e,"condition")&&"show"!==e.selectorOverride},void 0===e.isActive?t.isActive=!1!==e.defaultActive:t.isActive=e.isActive,_.find(i.availableFields,function(e){return JSON.stringify(t.key)===JSON.stringify(e.key)})||i.availableFields.push(t)),_.each(e.items,function(e){o(e)})}(e)}),i.availableFields=_.uniqWith(i.availableFields,_.isEqual),i.form.disableEllipsisMenu&&(i.disableMenu=!0),e.$watchCollection("hfs.form.items[0].items",function(){i.toggleActive()},!0),e.$on("coh-remove-field",function(e,o){var t=_.find(i.availableFields,{key:o.key});t&&(t.isActive=!1,i.toggleActive(!1,o))}),i.toggleActive(!0)}}]}}e.$inject=["$cohModal","$timeout","cohDropdownFix","formStateSvc"],angular.module("cohesionApp").directive("cohHiddenFieldSelector",e)}(),function(r){angular.module("cohesionApp").directive("cohIconPickerOpener",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-icon-picker-opener/coh-icon-picker-opener.html",scope:{model:"=ngModel",form:"="},bindToController:!0,controllerAs:"ipo",controller:["cohPickerSvc","$scope","$element",function(e,o,t){var n;function i(){e.setPicker({type:"icon",modelKey:["model"].concat(n.form.key),model:n.model,form:n.form},t)}r.fn.removeAttrs=function(n){return n=new RegExp(n,"g"),this.each(function(){var e=r(this),t="";r.each(this.attributes,function(e,o){o&&o.specified&&0<=o.name.search(n)&&(t+=" "+o.name)}),e.removeAttr(t)})},this.$onInit=function(){(n=this).openPickerMenu=i,o.$watch("ipo.model",function(){var e;t.find(".current-icon").removeAttrs("^(data-icon-)"),n.model&&n.model.iconName&&(e="&#x"+parseInt(n.model.iconName,10).toString(16)+";",e=(new DOMParser).parseFromString("<!doctype html><body>"+e,"text/html").body.textContent,t.find(".current-icon").attr("data-icon-"+function(e,o){if(e)return o?e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,o){return 0===o?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,""):e.replace(/\s+/g,"-").toLowerCase()}(n.model.fontFamily),e))},!0)}}]}})}(jQuery),function(k){function e(g,v,b,y,w){return{restrict:"E",templateUrl:"scripts/directives/coh-icon-picker/coh-icon-picker.html",scope:{model:"=model",form:"="},link:function(r,n){var t,i,e,a={},l={},s={},c={current:""},d=[];function m(e){var n=0;_.each(a,function(e,o){var t;n.toString()===r.fontFamilyIndex&&(c.current="data-icon-"+(t=o,_.find(d,function(e){return e.label===t}).fontFamily)),n++}),r.tempFontFamily=o(r.fontFamilyIndex),e&&(r.model.fontFamily=o(r.fontFamilyIndex)),p(),u()}function p(){n.find(".fip-box").each(function(e,o){var t=k(o).find(">:first-child"),o=t.attr("data-icon-default");_.each(a,function(e,o){t.removeAttr("data-icon-"+f(r.resource[o]["font-family"],!0))}),t.attr(c.current,o)})}function u(){var t=n.find(".selected-icon").find("i"),e=t.attr("data-icon-default");_.each(a,function(e,o){t.removeAttr("data-icon-"+f(r.resource[o]["font-family"],!0)),i.removeAttr("data-icon-"+f(r.resource[o]["font-family"],!0))}),i.attr(c.current,e)}function o(t){var n=0,i=null;return _.each(a,function(e,o){n===parseInt(t)&&(i=f(r.resource[o]["font-family"],!0)),n++}),i}function h(t){var n=0,i=null;return _.each(a,function(e,o){o===t&&(i=n),n++}),i||0}function f(e,o){return o?e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,o){return 0===o?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,""):e.replace(/\s+/g,"-").toLowerCase()}r.changeFontFamily=m,r.updateDisplayIconAttr=u,r.form.iconPickerLoading=!0,r.form.noIconLibraries=!1,r.model||(r.model={}),n.ready(function(){v.get(y.font_icons).then(function(e){r.resource=e,"[object Object]"===Object.prototype.toString.call(r.resource)?(a={},l={},_.each(r.resource,function(e,o){a[o]=_.map(JSON.parse(e.icons.success),function(e){return e.code}),l[o]=_.map(JSON.parse(e.icons.success),function(e){return e.tags}),d.push({label:o,fontFamily:f(e["font-family"])||f(e.type)})}),r.model&&null!==h(r.tempFontFamily)&&(r.fontFamilyIndex=h(r.tempFontFamily).toString()),c.current="data-icon-icomoon",s={source:a,searchSource:l,useAttribute:!0,attributeName:"data-icon-default",convertToHex:!0},function(){(t=n.find("#font-icon-picker")).val(r.model.iconName),t.fontIconPicker(s);var e="model.iconName";t.attr("ng-model",e),t.attr("ng-change","updateDisplayIconAttr();changeFontFamily(true);");var o=n.find(".icon-category-select");o.attr("ng-model","fontFamilyIndex"),o.attr("ng-change","changeFontFamily(true)"),o.children()[0].remove(),n.find(".icons-selector .selector").prepend('<span class="selected-icon-proxy" ng-show="'+e+'"><i></i> </span>'),n.find(".icons-selector .selector .selected-icon").attr("ng-hide",e),i=n.find(".icons-selector .selector .selected-icon-proxy i"),n.find(".icons-search-input").attr("placeholder","Search"),function e(){var o;u();n.find(".fip-icons-container").bind("DOMSubtreeModified",function(){o&&b.cancel(o),o=b(function(){n.find(".fip-icons-container").unbind("DOMSubtreeModified"),p(),e()},100)})}(),m(),o.val(h(r.tempFontFamily).toString()),o.change(),n.find(".selector-button").unbind("click"),k("html").click(k.proxy(function(){n.find(".selector-popup").hide(),n.find(".selector-button i").toggleClass("fip-icon-down-dir"),n.find(".selector-button i").toggleClass("fip-icon-up-dir")},this)),n.find(".selector-button").click(k.proxy(function(){n.find(".selector-popup").toggle(),n.find(".selector-button i").toggleClass("fip-icon-down-dir"),n.find(".selector-button i").toggleClass("fip-icon-up-dir")},this)),n.find(".fip-icons-container").on("click",".fip-box",k.proxy(function(){n.find(".selector-popup").hide()},this)),g(t)(r),g(o)(r),g(n.find(".selector"))(r)}(),r.form.iconPickerLoading=!1,r.form.noIconLibraries=!1):(r.error=!0,r.form.noIconLibraries=!0)})}),e=!0,r.$watch("model",function(){e?e=!1:w.state.variableMode||(r.fontFamilyIndex=h(r.tempFontFamily).toString(),m(),p(),u(),b(function(){n.find(".icon-category-select").trigger("change")}))})}}}e.$inject=["$compile","ajaxSvc","$timeout","apiUrls","formStateSvc"],angular.module("cohesionApp").directive("cohIconPicker",e)}(jQuery),angular.module("cohesionApp").directive("cohIdTagger",function(){return{restrict:"A",scope:!1,link:function(e,o){e.form.cohIdKey=e.form.key.join("-")+"_"+(1+Math.random()).toString(36).slice(2)}}}),angular.module("cohesionApp").directive("cohTagForAttr",function(){return{restrict:"A",scope:!1,link:function(e,o,t){e.$watch("dir.isVariableMode",function(){e.dir&&e.dir.isVariableMode?t.$set("for",e.form.cohIdKey+"_var"):t.$set("for",e.form.cohIdKey)})}}}),angular.module("cohesionApp").directive("inputFocus",function(){return{restrict:"A",link:function(e,o){o[0].focus()}}}),function(){function e(e){return{restrict:"E",link:function(){document.documentElement.classList.add("coh-is"+(e.isIOS()?"":"-not")+"-ios")}}}e.$inject=["cohDeviceService"],angular.module("cohesionApp").directive("body",e)}(),function(){function e(e){var r=e[0];return{transclude:r.transclude,priority:r.priority-1,terminal:r.terminal,restrict:r.restrict,link:function(e,o,t){var n,i=t.ngIf;t.ngIf=n=i?function(){return!1!==_.get(e,["form","isActive"])&&e.$eval(i)}:n,r.link.apply(r,arguments)}}}e.$inject=["ngIfDirective"],angular.module("cohesionApp").directive("cohIsActive",e)}(),angular.module("cohesionApp").directive("isolateForm",function(){return{restrict:"A",require:"?form",link:function(e,o,t,n){n&&o.parent().controller("form").$removeControl(n)}}}),function(){function e(i){return{restrict:"A",link:function(t,e,n){e.bind("keydown",function(e){var o;13!==e.which&&32!==e.which||("function"==typeof(o=i(n.cohKeyboardSelect))?(e.preventDefault(),e.stopPropagation(),o(t)):angular.noop())}),t.$on("$destroy",function(){e.unbind("keydown")})}}}e.$inject=["$parse"],angular.module("cohesionApp").directive("cohKeyboardSelect",e)}(),angular.module("cohesionApp").directive("cohLabelText",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-label-text/coh-label-text.html",scope:{ttPlace:"=",ttText:"=",ttLabel:"="},replace:!0,controllerAs:"clt",controller:["$scope",function(e){var o;this.$onInit=function(){(o=this).ttText=e.ttText,o.ttPlace=e.ttPlace,o.ttLabel=e.ttLabel}}]}}),function(){function e(e){return{restrict:"AE",require:"^ngModel",scope:!0,template:'<div ng-include="templateUrl"></div>',link:function(o,e,t){o.$watch(function(){var e=o.$eval(t.ngModel);return function(e,o){if(e)if("function"==typeof e){o=e(o)||"";if(o)return o}else if("string"==typeof e&&e.length)return e;return""}(o.$eval(t.cohDynamicNodesRendererView),o.node=e)},function(e){o.templateUrl=e})}}}e.$inject=["CohLayoutCanvas"],angular.module("cohesionApp").directive("cohDynamicNodesRenderer",e)}(),angular.module("cohesionApp").directive("cohLayoutCanvasNodesRenderer",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-nodes-renderer.html",scope:{forms:"=",modals:"=",node:"=",ngModel:"=",layoutOptions:"=",addElementFn:"&"},controllerAs:"clnr",controller:["$scope","$rootScope","ajaxSvc","$uibModal","$cohModal","$cookies","$q","$timeout","cohSuspendSvc","cohScrollPosSvc","CohLayoutCanvas","styleBuilderSvc","formStateSvc","cohUUID","cohSortableValidation","cohSaveElementSvc","cohCanvasPreviewSvc","cohDrupalToolbar","notificationSvc","cohModelManager","cohPermissionService","cohApiSvc","cohFormPreviewModelSvc","drupalSvc",function(i,n,o,r,a,e,t,l,s,c,d,m,p,u,h,f,g,v,b,y,w,k,S,$){var x,C=this,M=0;function A(e){T(e)&&d.nodeStatus[e.uuid].selected&&C.addElement(i.node,!0,!0)}function T(e){return _.get(e,"status.collapsed")}function I(e,o,t){if(-1!==["status","isVariableMode","collapsed","placeholderHeight"].indexOf(t))return!0}C.hoveredEls=[],C.mouseEnter=function(e,o){o.mimicParent||C.hoveredEls.push(o.uuid)},C.mouseLeave=function(e,o){o.mimicParent||_.pull(C.hoveredEls,o.uuid)},C.nodeStatus=d.nodeStatus,C.canvasKey=i.node.key.slice(0,-1),C.canvasName=i.node.key[i.node.key.length-1],C.refreshFrame=_.throttle(g.updateFrameUrl,1e3,{leading:!1,trailing:!0}),C.highlightElementInPreview=g.highlightElementInPreview,!i.node.isFormBuilder&&i.layoutOptions.showPreview&&(i.$watch(function(){return{model:p.state.model}},function(e,o){_.isEqualWith(e,o,I)||C.refreshFrame(C.canvasKey,C.canvasName)},!0),i.$watch(function(){return C.hoveredEls[C.hoveredEls.length-1]},function(e,o){C.highlightElementInPreview(e)},!0)),C.sortableOptions={connectWith:'.coh-layout-canvas-list-dropzone:not(".coh-sortable-disabled")',items:"> *",cancel:"a,button,input,textarea,select,option,.coh-sortable-disabled > .coh-layout-canvas-utils-item",scroll:!1,placeholder:"coh-layout-canvas-placeholder",opacity:.7,forceHelperSize:!1,forcePlaceholderSize:!0,type:i.layoutOptions&&i.layoutOptions.formBuilder?"form-canvas":"canvas",tolerance:"pointer",cursor:"move",handle:".coh-layout-canvas-utils>span",helper:"clone",layoutOptions:i.layoutOptions,start:function(e,o){var t=o.item.attr("class"),n=-1<o.helper[0].className.indexOf("coh-layout-column-width");o.placeholder.addClass(t),n&&1===o.helper.parent(".coh-layout-canvas-column-parent").length&&o.placeholder.height(o.item.height())},stop:function(e,o){o.placeholder.remove();var t=_.get(o.item,"sortable.droptarget[0]");o.item.sortable.model.parentUid=t?_.get(t,"dataset.uid"):_.get(e.target,"dataset.uid")},over:function(e,o){C.validateDropZone(e,o)},update:function(e,o){C.validateDropZone(e,o),_.get(o,"item.sortable.droptarget").sortable("instance")&&((e=C.validateDropZone(e,o)).valid?d.setLastModifiedEl(o.item.sortable.model):(o.item.sortable.cancel(),x||(x=!0,l(function(){x=!1},500),h.reportFailedDrop(e.message))))},receive:function(e,o){o.item.sortable.isCanceled()||(C.addElement(d.getNodeByUUID(e.target.id),!1,!0),C.validateDropZone(e,o))}},C.validateDropZone=function(e,o){return h.validateDropZone(e,o)},C.isColumnParent=function(e){return e.mimicParent?"row-for-columns"===e.parentUid:"row-for-columns"===e.uid},C.getFlexColClass=function(e){if("form-section"===e.uid)return _.get(i.ngModel,["model",e.uuid,"settings","columnCount"])},C.editElement=function(e,t){"component-drop-zone"!==t.uid&&w.canEditNode(t)&&C.closeDropdownMenu(t).then(function(){!1===i.modals.settings.open?(i.modals.settings.open=!0,2!==M&&(C.elementWasCollapsed=T(t)),p.state.mapper=angular.copy(i.ngModel.mapper[t.uuid])||{},d.setNodeStatus(t.uuid,"loading",!0),s.suspendWatchers(),c.savePos(),p.state.canvasName=C.canvasName,i.modals.settings.modal=r.open({templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-settings-modal.html",size:"lg",keyboard:!0,controller:"CohLayoutCanvasModalController",windowClass:"coh-layout-canvas-settings",openedClass:"coh-layout-canvas-settings-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-layout-canvas-settings-backdrop",animation:!1,resolve:{element:function(){return t},model:function(){return i.ngModel.model[t.componentContentId||t.uuid]},previewModel:function(){return _.get(i.ngModel,["previewModel",t.componentContentId||t.uuid])||{}},variableFields:function(){return _.get(i.ngModel,["variableFields",t.componentContentId||t.uuid])||[]},forms:function(){return k.getAll().then(function(e){return i.forms=e})},formDefinition:function(){return!t.componentId||t.componentContentId?{}:o.get("/cohesionapi/cohesion-component/"+t.componentId).then(function(e){return e})}}}),i.modals.settings.modal.result.then(function(e){n.$broadcast("cohFormSaving"),"form-field"!==t.type&&"form-field-container"!==t.type||(u.addToList(t,_.get(e,"model.settings.machineName")),function t(n,e,o){_.isArray(n)?n.forEach(function(e,o){t(e,n,o)}):_.isPlainObject(n)?Object.keys(n).forEach(function(e){t(n[e],n,e)}):"string"==typeof n&&(e[o]=u.machineToUUID(n))}(i.ngModel.model)),e.element.componentContentId?(delete i.ngModel.model[t.uuid],t=angular.extend(t,e.element)):(_.set(i.ngModel,["model",t.uuid],angular.copy(e.model)),_.set(i.ngModel,["previewModel",t.uuid],angular.copy(e.previewModel)),_.set(i.ngModel,["variableFields",t.uuid],angular.copy(e.variableFields))),d.setNodeStatus(t,"edited",!0),d.setLastModifiedEl(t);var o=m.produceFormDefinitionForTree(p.state.initialMapper),e=m.produceFormDefinitionForTree(p.state.mapper);_.isEqual(o,e)||(i.ngModel.mapper[t.uuid]=angular.copy(e)),p.state.initialMapper=void 0},function(e){"function"==typeof e&&e()}).finally(function(){y.destroyAll(),s.resumeWatchers(),d.setNodeStatus(t.uuid,"loading",!1),d.setNodeState(t,"collapsed",C.elementWasCollapsed),A(t),C.elementWasCollapsed=void 0,i.modals.settings.open=!1,p.state.mapper={},p.state.initialMapper={},p.state.previewModel={},p.state.variableModeModel={},p.state.variableFields=[],v.updateToolbarHeight(),c.scrollTo()})):a.showModal({},{closeButtonText:"No",actionButtonText:"Yes",headerText:"Confirmation",bodyText:"Are you sure you want to proceed. You will lose any changes you've made in the Sidebar Editor",windowClass:"coh-modal coh-duplicate-modal",backdropClass:"coh-modal-backdrop",animation:!1}).result.then(function(){i.modals.settings.modal.dismiss(function(){C.editElement(e,t)})})})},C.addElement=function(e,o,t){1===++M&&(C.elementWasCollapsed=T(e)),C.closeDropdownMenu(e),e.isContainer&&!e.componentId&&(i.addElementFn()(e,o,t),l(function(){M=0},500))},C.hasSavePermission=function(){return w.hasAnyPermission(["administer components","administer helpers"])},C.showConfigureLink=function(e){return!e.componentContentId&&(e.componentId&&w.hasAnyPermission(["administer components"]))},C.getConfigureLink=function(e,o){return o?drupalSettings.path.baseUrl+"admin/cohesion/components/component_contents/"+o.split("_")[1]:drupalSettings.path.baseUrl+"admin/cohesion/components/components/"+e+"/edit"},C.showSave=function(e,o){var t=C.hasSavePermission();return("component_content"!==_.get($,"cohesionSettings.entityTypeId")||"root"!==o.type)&&t},C.saveElement=function(e){f.save(e),C.closeDropdownMenu(e)},C.showDelete=function(e,o){var t=!0;return"cohesion_component"!==_.get($,"cohesionSettings.entityTypeId")||("component-drop-zone-placeholder"!==e.uid||_.get(d.nodeStatus,[e.uuid,"new"])?t:"disabledNodes"===_.get(o,"key[1]"))},C.showDeleteDisable=function(e,o){return"component_content"!==_.get($,"cohesionSettings.entityTypeId")||"root"!==o.type},C.deleteElement=function(e,o,t){C.closeDropdownMenu(e).then(function(){a.showModal({},{showSuppression:!0,suppressionCookieKey:"coh.suppress.layout-builder.delete",suppressionCookieValue:!0}).result.then(function(){C.hoveredEls=[],d.deleteNode(e,t,o),d.setLastModifiedEl(o),""===d.data.selected.model&&C.addElement(i.node,!0)})})},C.disableElement=function(e,o,t){C.closeDropdownMenu(e).then(function(){_.isArray(i.ngModel.disabledNodes)||(i.ngModel.disabledNodes=[]),i.ngModel.disabledNodes.push(angular.copy(e)),o.children.splice(t,1)})},C.showCopy=function(e,o){return"component_content"!==_.get($,"cohesionSettings.entityTypeId")||"root"!==o.type},C.copyElement=function(e,o,t){var n=_.cloneDeep(e);C.closeDropdownMenu(e),C.updateElementWithUUID(n,function(e,o){i.ngModel.model[o.uuid]=_.cloneDeep(i.ngModel.model[e.uuid]),i.ngModel.mapper[o.uuid]=_.cloneDeep(i.ngModel.mapper[e.uuid]),i.ngModel.previewModel[o.uuid]=_.cloneDeep(i.ngModel.previewModel[e.uuid]),i.ngModel.variableFields[o.uuid]=_.cloneDeep(i.ngModel.variableFields[e.uuid]),_.get(i,["ngModel","model",o.uuid,"settings","machineName"])&&_.set(i,["ngModel","model",o.uuid,"settings","machineName"],void 0)}),d.setNodeStatus(n,"new",!0),d.setLastModifiedEl(n),o.children.splice(t+1,0,n)},C.toggleElement=function(e){C.closeDropdownMenu(e),d.setNodeState(e,"collapsed",!e.status.collapsed),A(e)},C.updateElementWithUUID=function(e,o){var t=_.cloneDeep(e);if(void 0!==e.uuid&&(e.uuid=u.getUUID(),_.unset(e,"element_class_name"),e.children))for(var n=0;n<e.children.length;n++)C.updateElementWithUUID(e.children[n],o);!_.isUndefined(o)&&_.isFunction(o)&&o(t,e)},C.closeDropdownMenu=function(e){return d.setNodeStatus(e,"ellipsisOpen",!1),t(function(e){l(function(){e()})})},C.getView=function(){return"coh-layout-canvas-nodes-renderer-list.html"},C.getName=function(e){var o=_.get(i,["ngModel","model",e.componentContentId||e.uuid]),o=_.get(o,"settings.title")||_.get(o,"settings.label")||e.title;return o=/\[field.([\w-]+)\]/g.test(o)?e.title:o},C.getFieldName=function(e){if(!["form-field","form-field-container"].includes(e.type))return"";e=_.get(i,["ngModel","model",e.uuid,"settings","machineName"]);return e?!0===i.layoutOptions.styleGuideForm?(C.sgmMachineName=angular.element(".machine-name-value").text(),C.sgmMachineName?"[style-guide:"+C.sgmMachineName+":"+e+"]":" "):"[field."+e+"]":""},C.getChildClasses=function(e){var o=[];return e.isCustom?o.push("layout-canvas-type-custom"):o.push("layout-canvas-type-"+e.uid),"helper"!==e.type&&"component"!==e.type||o.push(e.category),o}}]}}),function(w){function e(e,o,y){return{restrict:"E",templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas.html",scope:{options:"=?",model:"=ngModel",form:"="},bindToController:!0,controllerAs:"clc",controller:["$rootScope","$scope","$uibModal","$timeout","ajaxSvc","cohBroadcastSvc","CohLayoutCanvas","cohApiSvc","cohElementBrowserModalService","cohSaveElementSvc","cohPermissionService","notificationSvc","cohDrupalToolbar","cohCanvasPreviewSvc",function(n,t,e,i,r,o,a,l,s,c,d,m,p,u){var h;t.bUseDX8=w.use_dx8;var f=0;function g(){if((h=this).nodeStatus=a.nodeStatus,h.toggleMode=function(e){h.mode=e||("preview"===h.mode?"layout":"preview");"preview"===h.mode&&s.close()},h.mode="layout",h.popupUrl="/admin/cohesion/component/preview?coh_clean_page=true&parent="+window.location.pathname,h.key=h.form.key.slice(0,-1),h.canvasName=h.form.key[h.form.key.length-1],h.key.length&&(h.model=_.get(h.model,h.key),a.initModelMapper(h.model),h.model.model=a.canvasData.model,h.model.mapper=a.canvasData.mapper,h.model.previewModel=a.canvasData.previewModel,h.model.variableFields=a.canvasData.variableFields,h.model.meta=a.canvasData.meta),_.isArray(h.model[h.canvasName])||_.set(h.model,h.canvasName,[]),void 0===h.model.model&&(h.model.model={}),void 0===h.model.mapper&&(h.model.mapper={}),h.modals={browser:{open:!1,modal:{}},settings:{open:!1,modal:{}},confirmation:{open:!1,modal:{}}},_.set(h.form,"previewOptions.toolbar",{columns:!0,scale:!0,grid:!0,breakpoints:!0,colorpicker:!0}),h.forms={},h.node={title:"Root",type:"root",uid:"root",id:"0",status:{collapsed:!1},children:[],key:h.form.key,uuid:y.getUUID(),isFormBuilder:h.options.formBuilder,disabled:h.form.disabled||!1},a.canvases[h.form.key.join("-")]=h.node,h.options.showPreview=h.options.showPreview&&_.includes(u.entityWhiteList,w.entityTypeId),h.layoutOptions=h.options,h.options.showPreview&&(window.removeEventListener("storage",v),window.addEventListener("storage",v),n.$on("onUnload",b)),h.options.showPreview&&u.updateFrameUrl(h.key,h.canvasName),h.layoutOptions.formBuilder?(r.get("/cohesionapi/element").then(function(e){h.forms=e}),function e(o){if(void 0!==o)for(var t=0;t<o.length;t++){var n=o[t],i=_.get(a.canvasData.model,[n.uuid,"settings","machineName"]);i&&y.addToList(n,i),e(n.children)}}(h.model.componentForm||h.model.styleGuideForm)):l.getAll().then(function(e){h.forms=e}),void 0!==_.get(h.model,h.canvasName)&&(h.node.children=_.get(h.model,h.canvasName),a.setNodeIsContainer(h.node)),a.recurseNodes(h.node,function(e){var o=e.uuid||y.getUUID();_.set(e,["uuid"],o)}),a.removeDeletedComponents(h.node,w.deletedComponents),a.initModelDirtyWatcher(),w.layout_canvas_errors&&w.layout_canvas_errors.length)for(var e=0;e<w.layout_canvas_errors.length;e++){a.setNodeStatus(w.layout_canvas_errors[e],"error",!0);for(var o=a.getParents(w.layout_canvas_errors[e],h.node),t=0;t<o.length;t++)"root"!==o[t].uid&&a.setNodeState(o[t],"collapsed",!1)}n.$on("layoutCanvasDirty",function(){n.forms.formRenderer.$setDirty()}),h.addElement=function(e,o,t){var n=400;d.hasAnyPermission(["access components","access elements","access helpers","access component content"])?(a.selectNode(h.key,e,o),t||("root"===e.type&&(n=0),f++,i(function(){2!==f?3!==f?(f=0,!1===s.isOpen()?h.modals.browser.modal=s.open({resolve:{element:function(){return e},tabs:function(){return h.options.tabs}}}):s.show(),"vertical"===p.getToolbarOrientation()&&p.getToolbarState()&&p.toggleState(),e.isFormBuilder||"form-container"===e.type||"form-field-container"===e.type?s.selectTab(w.isComponentForm?1:0):1===s.getSelectedTab()&&s.selectTab(0)):f=0:f++},n))):m.notify({className:"danger",content:"Sorry, you do not have the required permissions to add items to the layout canvas."})},h.showAddElement=function(){return!("component_content"===w.entityTypeId&&0===_.get(h.node,["children",0,"isContainer"]))},h.enableElement=function(e,o){h.node.children.push(angular.copy(e)),h.node.disabledNodes.splice(o,1)},h.isTop=function(){return a.data.selected.top},h.toggleAll=function(t){!function o(e){_.forEach(e,function(e){e.isContainer&&a.setNodeState(e,"collapsed",t),_.isArray(e.children)&&o(e.children)})}(h.node.children)},h.saveAll=function(){c.save(h.node.children)}}function v(e){if(window.location.href!==e.url&&"cohBroadcast"===e.key&&e.newValue){var o=JSON.parse(e.newValue);if(!o.data.scope||o.data.scope===window.location.pathname)switch(o.key){case"needUrl":u.updateFrameUrl(h.key,h.canvasName);break;case"highlightElement":o.data.uuid&&a.setNodeStatus(o.data.uuid,"previewHighlighted",!0),t.$apply();break;case"unHighlightElement":a.setNodeStatus(o.data.uuid,"previewHighlighted",!1),t.$apply();break;case"storePlaceholderHeight":_.isArray(h.model.model[o.data.uuid])&&_.set(h.model.model,[o.data.uuid],{}),_.set(h.model.model,[o.data.uuid,"settings","placeholderHeight"],o.data.height);break;default:return}}}function b(){o.broadcastXtabs("leftUrl",{scope:window.location.pathname})}t.bUseDX8&&(this.$onInit=g,this.$onDestroy=function(){h.options.showPreview&&(window.removeEventListener("storage",v),window.removeEventListener("beforeunload",b))})}]}}e.$inject=["cohTokenSvc","$window","cohUUID"],angular.module("cohesionApp").directive("cohLayoutCanvas",e)}(drupalSettings.cohesion),function(d){angular.module("cohesionApp").directive("cohMediaEmbed",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-media-embed/coh-media-embed.html",scope:{model:"=",ngModel:"=ngModel",form:"="},bindToController:!0,controllerAs:"cme",controller:["$scope","$timeout",function(o,t){var n,i,r,a;function l(){var e,o={autoplay:!1,muted:!0,loop:!1,stretching:"responsive",preload:"auto",success:function(e,o,t){i=e,r=angular.element(t.controls),a=angular.element(t.layers),"html5"===i.rendererName?(i.setInitialTime(1),r.removeClass("is-hidden"),a.removeClass("is-hidden")):(r.addClass("is-hidden"),a.addClass("is-hidden"))}};n.previewUrl&&("video/x-youtube"!==(e=mejs.Utils.getTypeFromFile(n.previewUrl))&&"video/youtube"!==e||_.set(o,"youtube.controls",-1===n.previewUrl.indexOf("controls=0")?1:0)),n.form.embedOptions&&_.extend(o,n.form.embedOptions),t(function(){angular.element("#"+n.getPlayerID()).mediaelementplayer(o)})}function s(){return"coh-media-element-player-preview-"+n.form.key.join("-").toLowerCase()}function c(){return _.get(n.model,n.form.key)}this.$onInit=function(){var e;(n=this).getPlayerID=s,c()&&(n.previewUrl=c()),n.helpUrl=!1,n.form.helpKey&&(e=_.get(d,"cohesion.support_url"))&&(n.helpUrl=e+n.form.helpKey),o.$watch(function(){return _.get(n.model,n.form.key)},function(e,o){!e&&i&&function(){i.paused||i.pause();i.remove(),i=void 0}(),!_.isEqual(o,e)&&e&&function(e){if(!_.get(n,"form.options.noPlugin")){if(!i)return l();e&&(i.pause(),i.setSrc(e),i.load(),"html5"===i.rendererName?(i.setInitialTime(1),r.removeClass("is-hidden"),a.removeClass("is-hidden")):(r.addClass("is-hidden"),a.addClass("is-hidden")))}}(e),n.previewUrl=e},!0),_.get(n,"form.options.noPlugin")||l()}}]}})}(drupalSettings),angular.module("cohesionApp").directive("cohModalSection",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-modal-section/coh-modal-section.html",scope:{ngModel:"=",form:"=",formModel:"="},controllerAs:"cms",transclude:!0,require:"ngModel",controller:["$scope","$uibModal",function(n,e){var o,r,a=[];function i(){t()?n.form.iconClass="coh-icon-check-circle":n.form.iconClass="coh-icon-circle-o"}function t(){var t=!1;return _.deepMap(n.form.items,function(e,o){return"key"===o&&_.get(n.formModel,e)&&(t=!0),e},"items"),t}function l(){r=angular.copy(n.formModel),e.open({templateUrl:"scripts/directives/coh-modal-section/coh-modal-section-modal.html",size:"md",windowClass:"coh-modal coh-form-modal-section coh-draggable-modal",openedClass:"coh-form-modal-section-open coh-modal-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-element-browser-backdrop",animation:!0,bindToController:!0,controllerAs:"cmsm",controller:["$uibModal","$cohModal","$uibModalInstance",function(e,o,t){var n=this;function i(){t.close(n.form.model)}n.save=i,n.clear=function(){_.deepMap(n.form.form,function(e,o){return"key"===o&&_.unset(n.form.model,e),e},"items"),i()},n.formElement=a,n.form={bundle:"",schema:{properties:{cohesion:{type:"object"}},type:"object"},form:a.items,model:r,mapper:{}},n.loaded=!0}]}).result.then(function(t){_.deepMap(n.form,function(e,o){return"key"===o&&_.set(n.formModel,e,_.get(t,e)),e},"items"),i()})}this.$onInit=function(){(o=this).openModal=l,o.modified=!1,o.hasValue=t,a=angular.copy(n.form),_.each(n.form.items,function(e){e.type="cohHidden"}),i(),o.loaded=!0}}]}}),drupalSettings,angular.module("cohesionApp").directive("cohMultiButton",function(){return{restrict:"E",scope:!1,templateUrl:"scripts/directives/coh-multi-button/coh-multi-button.html",controller:["$scope","formStateSvc",function(t,n){function i(o){var e=_.find(_.get(n.state.model,t.form.arrayKey),function(e){return _.get(e,t.form.disableMultipleModelKey)===o.key[0]});o.disabled=!_.isUndefined(e),o.items&&_.forEach(o.items,function(e){i(e)})}this.$onInit=function(){t.form.disableMultiple&&!0===t.form.disableMultiple&&(t.$watch(function(){return _.get(n.state.model,t.form.arrayKey)},function(e,o){e!==o&&i(t.form)},!0),i(t.form))}()}]}}),angular.module("cohesionApp").directive("cohNumberValidator",function(){return{restrict:"A",require:"ngModel",link:function(e,o,t,n){n.$formatters.shift()}}}),function(p){function e(e,o,c,d,m){return{priority:1,restrict:"A",scope:{form:"=",arrayIndex:"=?",ngModel:"=",model:"="},controller:["$scope",function(n){var e,i=this,t=n.form.endpoint;function r(){n.form.modelToWatch&&!n.form.getValue?e=n.$watch(n.form.modelToWatch,function(){delete n.form.options,o()},!0):o()}function a(o,t){_.each(n.form.options,function(e){_.get(e,"value")!==o||void 0===o||e.nullOption||(e.disabled=!0),_.get(e,"value")===t&&(e.disabled=!1)})}function o(){if(void 0===n.form.defaultValue&&n.form.nullOption&&(n.form.defaultValue=n.form.nullValue||""),n.form.sharedOptions)d.getOptions(n.form,a).then(function(e){var t;e=e,t=n.form.sharedOptionsId,n.form.options=angular.copy(d.normaliseOptions(n.form,d.selectors[t].options)),i.pickerId=e,n.$watch(function(){return _.get(n.model,n.form.key)},function(e,o){d.updateOptions(t,e,o,n.form.valueProperty,i.pickerId)}),n.$on("$destroy",function(){d.removePicker(n.form.sharedOptionsId,i.pickerId)})});else if("custom"!==n.form.selectType)if(!n.form.endpoint&&!n.form.contextual||n.form.options)(n.form.nullOption||void 0===n.form.defaultValue&&"customFields"!==n.form.getValue)&&(l(),s());else{var o;n.form.loading=!0,t=!0===n.form.contextual?_.get(p,n.form.contextualKey):n.form.endpoint;try{o=n.$eval(t)}catch(e){o=t}n.evalEndpoint=o,c.get(o).then(function(e){n.form.options=d.normaliseOptions(n.form,e),n.form.getValue&&(m.getValue(n.form.getValue).options=angular.copy(n.form.options)),!n.form.nullOption&&void 0!==n.form.defaultValue||(l(),s(n.form.options,n.ngModel,_.get(n,"form.undefinedLabel","Undefined"),!0)),n.form.loading=!1})}else _.map(n.form.options,function(e){return e.value||""})}function l(){var e={},o=n.form.nullOption?"None":void 0;n.form.nullLabel&&"None"===o&&(o=n.form.nullLabel),_.set(e,"value",function(e){if(void 0!==e)return void 0!==n.form.nullValue?n.form.nullValue:""}(n.form.defaultValue)),_.set(e,"label",o||" "),_.set(e,"nullOption",!0),Array.isArray(n.form.options)&&n.form.options.length?!0!==n.form.options[0].nullOption?n.form.options.splice(0,0,e):!0===n.form.options[0].nullOption&&n.form.options.splice(0,1,e):n.form.options=[e]}function s(e,o,t,n){o&&!e.find(function(e){return e.value===o})&&e.push({label:t,value:o,disabled:n})}this.$onDestroy=function(){n.form.modelToWatch&&"function"==typeof e&&e()},this.$onInit=function(){n.form.getValue&&(m.setAndWatch(n.form.getValue,_.assign({},n.form),function(e){_.isArray(e)?n.form.options=e:n.form=_.assign({},e,{getValue:n.form.getValue,cohIdKey:n.form.cohIdKey}),r()}),_.assign(n.form,m.getValue(n.form.getValue)));var o;"existing"!==n.form.selectType||4!==_.get(n.form,"selectModel.length")?r():(o={type:n.form.selectModel[0],itemID:n.form.selectModel[1],fieldGroupId:n.form.selectModel[2],fieldId:n.form.selectModel[3]},c.get("/cohesionapi/select-options",{params:o}).then(function(e){e.settings&&e.styles&&e.context_visibility?c.post("/cohesionapi/select-options",o).then(function(e){n.form=_.assign({},n.form,d.createCleanJson(e)),r()}):(n.form=_.assign({},n.form,d.createCleanJson(e)),r())}))}}]}}e.$inject=["$interval","$timeout","ajaxSvc","selectOptionsSvc","cohModelManager"],angular.module("cohesionApp").directive("cohOptionsGetter",e)}(drupalSettings),function(){function e(f){return{restrict:"E",templateUrl:"scripts/directives/coh-picker-menu/coh-picker-menu.html",bindToController:!0,controllerAs:"cpim",controller:["$scope","$element","$timeout",function(t,o,e){var n,i,r,a=null;function l(e){27===e.which&&(e.preventDefault(),e.stopPropagation(),(1===n.menu.blades.length?s:c)())}function s(){_.get(t,n.modelKey.concat(["fontFamily"]))&&!_.get(t,n.modelKey.concat(["iconName"]))&&_.unset(t,n.modelKey),e(function(){i(),n.fieldModel={colour:null,gradient:null,icon:null},"colour"===n.menu.blades[0].currentPicker&&n.reset(),n.modelKey=null,n.form={},n.menu.open=!1,n.menu.blades=[],angular.element("body").unbind("keydown",l)},300)}function c(){e(function(){n.menu.blades.pop(),angular.element(".blade2 .coh-back-btn").focus()})}function d(e){n.fieldModel.subColour={value:{rgba:e.model}},n.menu.blades.push({currentPicker:"colour"}),a=e.target}function m(e){r=angular.copy(e.model),n.modelKey=e.modelKey,n.form=angular.copy(e.form),"colour"===e.type&&(n.form.menuPicker=!1,n.fieldModel.colour=e.model),"gradient"===e.type&&(n.fieldModel.gradient=e.model),"icon"===e.type&&(n.fieldModel.icon=e.model);e={currentPicker:e.type};n.menu.blades=[e],n.menu.open=!0,angular.element("body").bind("keydown",l),i=t.$watch("cpim.fieldModel",function(e,o){n.modelKey&&_.set(t,n.modelKey,n.fieldModel[n.menu.blades[0].currentPicker])},!0)}function p(){n.menu.blades.pop()}function u(){var e=o.find("#"+a.id).css("left");o.find("#"+a.id).attr("style","background-color:"+n.fieldModel.subColour.value.rgba+"; left:"+e+";"),n.gradX.update_gradient_picker(),n.menu.blades.pop()}function h(){_.set(t,n.modelKey,r),s()}this.$onDestroy=function(){angular.element("body").unbind("keydown",l)},this.$onInit=function(){(n=this).fieldModel={colour:null},n.menu={open:!1},n.form={colourPickerOptions:{flat:!0}},n.gradX=null,n.subColourPickerForm={colourPickerOptions:{flat:!0}},n.reset=null,n.back=c,n.close=s,n.revert=h,n.revertSubBlade=p,n.selectSubBlade=u,n.pickerInstanceId=f.createInstance(o),t.$on("$destroy",function(){f.destroyInstance(o,n.pickerInstanceId)}),f.registerUpdateFunction(m,n.pickerInstanceId),f.registerAddBladeFunction(d,n.pickerInstanceId)}}]}}e.$inject=["cohPickerSvc"],angular.module("cohesionApp").directive("cohPickerMenu",e)}(),angular.module("cohesionApp").directive("cohPreventParentScroll",function(){return{restrict:"A",scope:!1,link:function(e,o){o.bind("mousewheel",function(e){o[0].scrollTop-=e.wheelDeltaY||e.originalEvent&&(e.originalEvent.wheelDeltaY||e.originalEvent.wheelDelta)||e.wheelDelta||0,e.stopPropagation(),e.preventDefault(),e.returnValue=!1})}}}),function(){function e(o){return{restrict:"E",controllerAs:"cpwi",scope:{key:"="},templateUrl:"scripts/directives/coh-preview-warning-icon/coh-preview-warning-icon.html",controller:["$scope",function(e){this.$onInit=function(){this.canPreview=o.cohesionSettings.fieldPreview[e.key]}}]}}e.$inject=["drupalSvc"],angular.module("cohesionApp").directive("cohPreviewWarningIcon",e)}(),angular.module("cohesionApp").directive("cohPropertiesMenuButton",function(){return{scope:{form:"="},templateUrl:"scripts/directives/coh-properties-menu-button/coh-properties-menu-button.html",bindToController:!0,controllerAs:"pmb",controller:["propertiesMenuSvc",function(e){function o(){e.openMenu()}this.$onInit=function(){this.openPropertiesMenu=o}}]}}),angular.module("cohesionApp").directive("cohPropertiesMenu",function(){return{scope:{form:"=",model:"=",optionsKey:"=",openPropertiesMenuFn:"=",optionCallback:"="},templateUrl:"scripts/directives/coh-properties-menu/coh-properties-menu.html",restrict:"E",controllerAs:"cpm",bindToController:!0,controller:["$timeout","propertiesMenuSvc","$cohModal","cohApiSvc","apiUrls",function(t,o,n,i,r){var a,l,s;function e(){l.menu.open=!0,l.menu.blades.push({options:function(){a=i.getCachedObject(r.property_group_options[l.optionsKey||"style-builder-options"]);var e=l.form,n=[];return function o(e,t){e.formKey&&("cohAccordion"===e.type?n.push({keyName:e.formKey,subOptions:[]}):n[n.length-1].subOptions.push(e.formKey)),e.items&&_.each(e.items,function(e){o(e,t)})}(e),function(e){var t=angular.copy(a);return _.each(e,function(o){_.each(t,function(e){e.keyName&&e.parentKeyName&&o.keyName===e.parentKeyName&&(e.active=!0),o.keyName===e.keyName&&(e.active=!0),_.each(o.subOptions,function(o){_.each(e.options,function(e){e.keyName===o&&(e.active=!0)})})})}),t}(n)}()}),angular.element("body").bind("keydown",c)}function c(e){27===e.which&&(e.preventDefault(),e.stopPropagation(),p())}function d(e,o){t(function(){(s=o.target).classList.add("coh-blades-menu-active"),l.menu.blades.push({options:e.options})})}function m(){t(function(){l.menu.blades=[],l.menu.open=!1,angular.element("body").unbind("keydown",c)})}function p(){t(function(){angular.element(s).removeClass("coh-blades-menu-active"),l.menu.blades.pop(),0===l.menu.blades.length?m():angular.element(".blade2 .coh-back-btn").focus()})}function u(e){e.active?o.addSubGroupToForm(e,l.form,l.model):n.showModal({},{showSuppression:!0,suppressionCookieKey:"coh.suppressModal.properties"}).result.then(function(){o.removeSubGroupFromForm(l.form,e)},function(){e.active=!0})}this.$onInit=function(){(l=this).closePropertiesMenu=m,l.openSubOptions=d,l.back=p,l.togglePropertyGroup=u,l.optionsKey||(l.optionsKey=l.form.propertyOptionsKey),l.menu={blades:[]},l.fnOptionClick=function(e){l.optionCallback&&e.useCallback&&(m(),l.optionCallback(e))},l.openPropertiesMenuFn=e},this.$onDestroy=function(){angular.element("body").unbind("keydown",c)}}]}}),function(v){function e(f,g){return{restrict:"E",require:"ngModel",templateUrl:"scripts/directives/coh-range/coh-range.html",transclude:!0,link:function(n,t,e,i){var o,r,a,l,s=t.find(".coh-range-input"),c=t.find(".coh-range-output"),d=!0;function m(){r&&g.cancelAnimationFrame(r),r=g.requestAnimationFrame(function(){u()})}function p(e){e=e.currentTarget.value;n.form.suffix?i.$setViewValue(e+n.form.suffix):i.$setViewValue(parseFloat(e)),u()}function u(){var e=n.form.min,o=n.form.max,t=parseFloat(s.val());s.length&&(t=(t-e)/(o-e),isNaN(t)&&(t=0),o=s[0].getBoundingClientRect().width,e=c[0].getBoundingClientRect().width/2,n.form.position=(t=t*o)-(t-o/2)/(o/2)*e,s.css({background:"linear-gradient(to right, #006CBC 0%, #006CBC ".concat(n.form.position,"px, #999 ").concat(n.form.position,"px, #999 100%)")}),c.css({transform:"translateX(".concat(n.form.position-e,"px)")}))}function h(e){e=parseFloat(e)||0;return e<n.form.min||e>n.form.max||v.isUndefined(e)||isNaN(e)?n.form.min:e}n.initialised=!1,n.getValueLabel=function(){return void 0!==i.$modelValue?i.$modelValue:"Undefined"},n.form.suffix?n.form.schema.type="string":n.form.schema.type="number",n.$on("tabSelect",function(){f(function(){u()})}),n.form.watchAttributes&&(o=n.form.watchAttributes,a=n.$watchGroup(v.values(o),function(){v.assignWith(n.form,o,function(e,o){return v.get(n,o)}),u()})),l=n.$watch(function(){return i.$modelValue},function(e){var o;d&&(o="number"==typeof i.$modelValue||"string"==typeof i.$modelValue?parseFloat(i.$modelValue):n.form.defaultValue,n.initialRangeVal=h(o),t.on("change input",".coh-range-input",p),n.initialised=!0,f(function(){s=t.find(".coh-range-input"),c=t.find(".coh-range-output"),u()}),d=!1),parseFloat(e)!==parseFloat(s.val())&&(s.val(h(e)),u())}),angular.element(g).on("resize",m),n.$on("$destroy",function(){angular.element(g).off("resize",m),t.off("change input",".coh-range-input",u),"function"==typeof a&&a(),"function"==typeof l&&l()})}}}e.$inject=["$timeout","$window"],angular.module("cohesionApp").directive("cohRange",e)}(_),function(){function e(r){return{link:function(e,o,t){var n=!!o.parents(".coh-form-preview").length,i=_.get(e,"form.key");void 0!==i&&(_.isArray(i)&&(i=i.join(".")),r.get("form-help-hide-"+i)&&!n&&o.remove(),e.remove=function(e){o.remove(),n||void 0!==e&&(_.isArray(e)&&(e=e.join(".")),r.put("form-help-hide-"+e,!0,{path:"/"}))})}}}e.$inject=["$cookies"],angular.module("cohesionApp").directive("cohRemoveOnClick",e)}(),angular.module("cohesionApp").directive("cohResizeable",[function(){return{restrict:"A",scope:{onResize:"&onResize",resizeOptions:"="},link:function(e,o,t){e.resizeOptions.disabled||(o.resizable(e.resizeOptions),o.on("resizestop",function(){"function"==typeof e.onResize&&e.onResize()}))}}}]),angular.module("cohesionApp").directive("cohScrollbarContainer",function(){return{restrict:"A",controllerAs:"csbc",controller:["$scope","$element","$timeout",function(e,o,t){var n,i;function r(){o.prop("scrollWidth")>o.prop("clientWidth")?o.addClass("coh-has-horizontal-scroll"):o.removeClass("coh-has-horizontal-scroll"),o.prop("scrollHeight")>o.prop("clientHeight")?o.addClass("coh-has-vertical-scroll"):o.removeClass("coh-has-vertical-scroll")}function a(){i&&window.cancelAnimationFrame(i),i=window.requestAnimationFrame(function(){r()})}this.$onInit=function(){window.addEventListener("resize",a,!1),(n=new MutationObserver(function(){r()})).observe(o[0],{subtree:!0,childList:!0}),r()},this.$onDestroy=function(){n.disconnect(),window.removeEventListener("resize",a,!1)}}]}}),function(s){angular.module("cohesionApp").directive("cohSection",function(){return{scope:!0,restrict:"E",templateUrl:"scripts/directives/coh-section/coh-section.html",controllerAs:"sec",controller:["$scope","$rootScope","$element","formStateSvc","$window","styleBuilderSvc","propertiesMenuSvc",function(n,i,e,r,o,t,a){var l=[];n.getBreakpointWidth=function(e){return n.grid.breakpoints[e.name].width||0},this.$onInit=function(){var e;n.grid=s.cohesion.responsive_grid_settings,n.reverse="mobile-first"!==n.grid.gridType,n.form&&(n.helpUrl=e=!1,n.form.helpKey&&(e=_.get(s,"cohesion.support_url"))&&(n.form.helpKeyUnique?n.helpUrl=e+t.propertyOptionsKey+"-"+n.form.helpKey:n.helpUrl=e+n.form.helpKey)),e=n.form.mapperKey?n.form.mapperKey.split(".")[0]:"",l.push(n.$on("coh-remove-empty-breakpoint-rows-"+e,function(e){_.forEachRight(n.form.items[0].items,function(e){var o,t=_.get(e,"items.0");"cohArray"!==t.type?(o=!1,_.forEach(e.items,function(e){e=_.get(n.model,e.key)||_.get(r.state.variableModeModel,e.key);if(!_.isNil(e)&&""!==e)return!(o=!0)}),!1===o&&i.$broadcast("coh-remove-breakpoint-row",{key:e.key[0],parentKey:n.form.formKey})):t.items&&t.items.length||i.$broadcast("coh-remove-breakpoint-row",{key:e.key[0],parentKey:n.form.formKey})})})),l.push(n.$on("coh-remove-empty-sections-"+e,function(e,o){0===n.form.currentBreakpoints.length&&a.removeSubGroupFromForm(o.form,{keyName:n.form.formKey})}))},this.$onDestroy=function(){l.forEach(function(e){"function"==typeof e&&e()})}}]}})}(drupalSettings),angular.module("cohesionApp").directive("cohSelectPicker",function(){return{templateUrl:"scripts/directives/coh-select-picker/coh-select-picker.html",restrict:"E",controllerAs:"csp",bindToController:!0,scope:{model:"=",form:"=",firstLabel:"="},controller:["$scope","ajaxSvc","cohModelManager","selectOptionsSvc","$timeout",function(e,o,l,s,i){var c,d={},m=[],p={};function u(e,o){for(var t,n,i=d,r=e,a=m.length;r<a;r++)m[r]=void 0;for(o||_.set(c.model,"model.value",void 0),c.aSelectTree=[],r=0,a=e;r<=a;r++)n||(h(r,i),(t=i[m[r]])&&(t.childLabels&&(p[m[0]]=t.childLabels),"cohSelect"===t.type?(function(e){e=s.createCleanJson(e);_.get(c.model,"model.value")||(e.defaultValue?_.set(c.model,"model.value",e.defaultValue):e.nullOption&&_.set(c.model,"model.value",e.nullValue||""));_.set(c.model,"settings",_.assign({},c.model.settings,{type:"cohSelect",selectType:c.model.settings.selectType,selectModel:m,title:c.model.settings.title}));e=angular.extend({},e);delete e.title,l.setValue("customFields",e)}(t),n=!0):(i=t.options,1===Object.keys(i).length&&(m[r+1]=Object.keys(i)[0],r===e&&u(e+1,o)))))}function h(e,o){var t,n,i=[];for(n in o)o.hasOwnProperty(n)&&(t=o[n]).title&&i.push({sValue:n,sLabel:t.title});c.aSelectTree.push({sLabel:0===e?c.firstLabel:p[m[0]][e-1],aOptions:i})}this.$onInit=function(){(c=this).hnSelectChange=u,c.aSelectModel=m,c.aSelectTree=[],o.get("/cohesionapi/select-options").then(function(e){var o=c.model.settings.selectModel||[];if(delete e.styles,d=e,o.length){for(var t=0,n=o.length;t<n;t++)m[t]=o[t];i(function(){u(o.length,!0)})}else h(0,d)})},this.$onDestroy=function(){var e;"custom"===c.model.settings.selectType&&(e=l.getValue("customFields"),_.set(c.model,"settings.options",e.options))}}]}}),function(){function e(a,l){return{restrict:"A",require:"ngModel",scope:{type:"=cohSelectorValidatorType",subType:"=cohSelectorValidatorSubType",valid:"=cohSelectorValidatorValid",endpoint:"=?cohSelectorValidatorEndpoint",validating:"=?cohSelectorValidatorValidating"},link:function(t,e,o,n){var i,r;n&&(i=angular.element(e),r=_.isUndefined(t.endpoint)?"/cohesionapi/validate_pmc":t.endpoint,n.$overrideModelOptions({updateOn:"default blur",debounce:{default:300,blur:0}}),n.$asyncValidators.selectorInput=function(e,o){i.addClass("loading"),t.validating=!0;o=e||o;"nth-child"===t.subType&&(o=":nth-child(".concat(o,")")),"child"!==t.type&&"modifier"!==t.type||(o="* ".concat(o," *"));try{document.querySelector(o)}catch(e){return t.valid=!1,n.$setValidity("required",!1),n.$setValidity("parse",!1),n.$setValidity("selectorInput",!1),t.validating=!1,l.resolve()}o={type:t.type,value:o};return a.post(r,o).then(function(e){JSON.parse(e.valid)&&""!==e.value?(t.valid=!0,n.$setValidity("required",!0),n.$setValidity("parse",!0),n.$setValidity("selectorInput",!0)):(t.valid=!1,n.$setValidity("required",!1),n.$setValidity("parse",!1),n.$setValidity("selectorInput",!1)),i.removeClass("loading")}).finally(function(){t.validating=!1})},t.$on("$destroy",function(){t.valid=!0,_.omit(n,"selectorInput")}))}}}e.$inject=["ajaxSvc","$q"],angular.module("cohesionApp").directive("cohSelectorValidator",e)}(drupalSettings),angular.module("cohesionApp").directive("cohSimpleBreakpoints",[function(){return{restrict:"E",templateUrl:"scripts/directives/coh-simple-breakpoints/coh-simple-breakpoints.html",scope:{hBreakpoints:"=",sSelectedBreakpoint:"=ngModel",hideLargerThanWindow:"=",showResponsive:"="},controllerAs:"csb",bindToController:!0,controller:function(){var o;function e(e){o.sSelectedBreakpoint=e}function t(){o.maxSize=window.innerWidth,_.get(o.hBreakpoints,[o.sSelectedBreakpoint,"width"])>o.maxSize&&(o.sSelectedBreakpoint=void 0)}function n(e){return _.get(o.hBreakpoints,[e,"width"])>o.maxSize}this.$onInit=function(){(o=this).onBrowserResize=_.debounce(t,300,{}),o.hnSelectSize=e,o.isDisabled=n,o.maxSize=_.get(o.hBreakpoints,"xl.width"),o.hideLargerThanWindow&&(window.addEventListener("resize",o.onBrowserResize),o.maxSize=window.innerWidth)},this.$onDestroy=function(){window.removeEventListener("resize",o.onBrowserResize)}}}}]),function(){function e(t){return{restrict:"A",link:function(e,o){angular.element("body").hasClass("coh-layout-canvas-settings-open")?o.css({top:"auto",position:"relative"}):o.css({top:"fixed"===t.getToolbarPosition()?t.getToolbarHeight()+"px":"0"})}}}e.$inject=["cohDrupalToolbar"],angular.module("cohesionApp").directive("cohSticky",e)}(),drupalSettings,angular.module("cohesionApp").directive("cohStyleGuideLayout",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-style-guide-layout/coh-style-guide-layout.html",controllerAs:"sglo",controller:["$scope","$timeout","$window",function(o,t,n){var i;function e(e){_.isUndefined(e)?i.previewHidden=!i.previewHidden:i.previewHidden=e,t(function(){o.form.items[1].options.hideIframe=i.previewHidden,n.dispatchEvent(new Event("resize"))})}function r(){return!i.previewHidden||parseInt(i.$body.width())<1024}this.$onInit=function(){(i=this).togglePreview=e,i.isStacked=r,i.$body=angular.element("body"),i.previewHidden=!1,i.popupUrl="/admin/cohesion/style_guides/preview?coh_clean_page=true&parent="+n.location.pathname}}]}}),function(m){angular.module("cohesionApp").directive("cohStyleGuideList",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-style-guide-list/coh-style-guide-list.html",controllerAs:"sgl",controller:["$scope","$rootScope","$cookies","$uibModal","formStateSvc","cohDrupalToolbar","ajaxSvc","cohFormBuilderRenderSvc","cohSgmPreviewSvc",function(e,o,t,n,i,r,a,l,s){var c;function d(e){var n;e&&e!==c.selectedGuideId&&c.styleGuides.length&&(c.selectedGuideId=e,c.selectedGuide=_.find(m.cohesion.style_guides,{uuid:c.selectedGuideId}),c.selectedGuide||(c.selectedGuideId=c.styleGuides[0].uuid,c.selectedGuide=_.find(m.cohesion.style_guides,{uuid:c.selectedGuideId})),t.put("selectedGuideId",c.selectedGuideId),c.selectedGuide.type="style guide",c.styleGuideForm={},c.loaded=!1,e=l.initialiseForm(c.selectedGuide.json_values.styleGuideForm,c.selectedGuide.json_values.model,c.selectedGuide,{canAccessTokens:!1,hideTitle:!0,trackEdits:!0}),n=/model(\[.*?\])/gm,_.deepMap(e.form[0],function(e,o,t){if("key"===o)return"model."+c.selectedGuide.uuid+"."+e;if("condition"!==o)return e;o="model['model']['".concat(c.selectedGuide.uuid,"']$1");return e.replace(n,o)},"items"),c.styleGuideForm.form=e.form,c.styleGuideForm.schema=e.schema,c.loaded=!0)}this.$onInit=function(){(c=this).view=d,c.updateFrameCss=_.debounce(s.updateFrameCss,400,{}),c.styleGuides=m.cohesion.style_guides,c.loaded=!1,c.styleGuideForm={},c.model=e.model,c.view(t.get("selectedGuideId")||_.get(c.styleGuides,"[0].uuid")),e.$watch("model.model",function(e,o){_.isEqual(e,o)||c.updateFrameCss()},!0)}}]}})}(drupalSettings),angular.module("cohesionApp").directive("cohStyleHelperButton",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-style-helper-button/coh-style-helper-button.html",scope:{form:"="},controllerAs:"cshb",bindToController:!0,controller:function(){}}}),function(){function e(l,e,s,c,d,m,p,u,h,f,g,v){return{scope:{form:"=",model:"=",openStyleHelperMenuFn:"="},templateUrl:"scripts/directives/coh-style-helper/coh-style-helper.html",restrict:"E",controllerAs:"csh",bindToController:!0,controller:function(){var o,n,t="/cohesionapi/style_helpers";function e(e){"save"!==e.keyName?l.showModal({},{showSuppression:!0,bodyText:'Are you sure you want to load style helper "'+e.title+"\"? You will lose any values you've added.",suppressionCookieKey:"coh.suppressStyleHelperModal.properties"}).result.then(function(){r("/cohesionapi/style_helpers/"+e.keyName,"loaded","get",a)}):l.showModal({},{headerText:"Save style helper",noBodyText:!0,form:o}).result.then(function(){var e=h.produceFormDefinitionForTree(p.state.mapper);e=angular.extend({json_values:JSON.stringify(n.model),json_mapper:JSON.stringify(e)},o.model),g.get("$http").remove(t),r("/cohesionapi/style-helper-save","saved","post",i,e)})}function i(){u.get("modals.style_helper_save").then(function(e){o=e,d.get("/cohesionapi/style_helpers").then(function(e){e.push({keyName:"save",title:"Save as style helper",noCheckbox:"true",useCallback:"true",icon:"save"}),u.updateCachedData("property_group_options.style_helper",e)})})}function r(e,o,t,n,i){d[t](e,i).then(function(e){(n||function(){})(e),e=!0,m.notify({content:"Style was "+(e?"":"not ")+o+" successfully.",className:e?"success":"danger"})})}function a(t){f.removeAllSubGroupsFromForm(n.form),s(function(){p.state.mapper.styles=t.mapper.styles;var e=h.buildFormForEachSelector(p.state.mapper.styles,"styles");n.form=e.form,v.addModelsToTree(n.model,n.form,"styles");var e=n.form.items,o=n.form.mapperKey;p.state.previewModel[o]&&Object.keys(p.state.previewModel[o]).forEach(function(e){p.state.previewModel[o][e]=[]}),p.state.variableModeModel[o]&&Object.keys(p.state.variableModeModel[o]).forEach(function(e){p.state.variableModeModel[o][e]=[]}),p.state.variableFields=[],c.setValue("formBuilderForm"+o,e),t.mapper.styles.items&&c.setValue("formBladeMenu"+o,t.mapper.styles.items),Object.keys(n.model.styles).forEach(function(e){"settings"!==e&&delete n.model.styles[e]}),Object.keys(t.styles.styles).forEach(function(e){"settings"!==e&&(n.model.styles[e]=t.styles.styles[e])})})}this.$onInit=function(){(n=this).sStyleHelperKey="style-helper",n.hnOptionCallback=e,n.form.disableTreeMenu||i()}}}}e.$inject=["$cohModal","$q","$timeout","cohModelManager","ajaxSvc","notificationSvc","formStateSvc","cohApiSvc","styleBuilderSvc","propertiesMenuSvc","$cacheFactory","menuSvc"],angular.module("cohesionApp").directive("cohStyleHelper",e)}(),function(O){function e(e,C,M,A,t,T,I,E){return{restrict:"E",templateUrl:"scripts/directives/coh-style-preview/coh-style-preview.html",scope:{jStyles:"="},controller:["$scope",function(e){var o;e.sCssEndpoint="/cohesionapi/build-style/"+O.entityTypeId,e.sCss="",e.supportUrlPrefix=t.cohesionSettings.support_url,e.sInnerClass=".cke_contents",e.jStyles&&"string"==typeof e.jStyles.sBackgroundColour&&-1!==e.jStyles.sBackgroundColour.indexOf("#")&&(o=(o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.jStyles.sBackgroundColour))?"rgba("+parseInt(o[1],16)+", "+parseInt(o[2],16)+", "+parseInt(o[3],16)+", 1)":null,e.jStyles.sBackgroundColour={value:{hex:e.jStyles.sBackgroundColour,rgba:o}}),e.sBackgroundColour=e.jStyles&&e.jStyles.sBackgroundColour?e.jStyles.sBackgroundColour:{value:{hex:"#FFFFFF",rgba:"rgba(255, 255, 255, 1)"}},e.oColourModel=e.sBackgroundColour,e.hBreakpoints=O.responsive_grid_settings.breakpoints,e.hGridPreference={"desktop-first":"xl","mobile-first":"xs"},e.sSelectedBreakpoint=e.hGridPreference[O.responsive_grid_settings.gridType],e.sCurrentIFrameWidth=0,e.bActiveRefresh=!1,e.bAutoRefresh=!0,e.aHandlerQueue=[]}],link:function(n,o){var i,r,e,t,a,l,s,c,d,m,p=!0,u=["jStyles","styles","settings","element"],h=150,f=750,g=document.createElement("style");function v(){w(),c=window.setInterval(b,500)}function b(){var e=".coh-wysiwyg-container "+n.sInnerClass+" iframe";i=i||o[0].parentElement.querySelector(e),(r=r||(i?_.get(i,"contentWindow.document.body"):void 0))&&null!==i.offsetParent&&function(){var e,o;if(n.hnScale(),n.hnColour(),n.hnRefresh(),S(),s=window.setInterval(y,1e3),t=t||angular.element(M).on("resize",$),n.aHandlerQueue.push(n.$watch("sSelectedBreakpoint",n.hnScale)),n.aHandlerQueue.push(n.$watch("oColourModel",n.hnColour,!0)),n.aHandlerQueue.push(n.$watch("jStyles",x,!0)),r.classList.add("coh-style-preview-background"),window.clearInterval(c),O.customStyleParentClass)for(e=r.getElementsByClassName("coh-preview"),o=e.length;o--;)e[o].classList.add(O.customStyleParentClass)}()}function y(){i.contentWindow||v()}function w(){r=i=void 0,C.cancel(a),C.cancel(l),window.clearInterval(c),window.clearInterval(s),n.aHandlerQueue.forEach(function(e){e()}),n.aHandlerQueue=[]}function k(){var e=parseInt(n.sCurrentIFrameWidth),o=parseInt(window.getComputedStyle(document.getElementById("cke_1_contents")).width),t=".coh-style-preview-container iframe[style].cke_wysiwyg_frame { width: "+n.sCurrentIFrameWidth+" !important; }";i.setAttribute("style","width: "+n.sCurrentIFrameWidth+"; height: 100%;"),r.style.width=(e<o?e:o)+"px",d=d||document.getElementById("cke_1_contents");try{g.innerHTML=t}catch(e){g.styleSheet.cssText=t}}function S(){var e,o,t=_.get(i,"contentWindow.document.head");t&&((o=t.getElementsByClassName(e="coh-temp-style")[0])&&t.removeChild(o),(o=document.createElement("style")).appendChild(document.createTextNode(n.sCss)),o.className=e,t.appendChild(o))}function $(){e||(e=!0,a=C(function(){k(),e=!1,C.cancel(a)},h))}function x(e,o){n.bAutoRefresh&&!_.isEqual(e,o)&&(C.cancel(l),l=C(function(){n.hnRefresh(),C.cancel(l)},f))}g.setAttribute("id","coh-iframe-container-style"),document.getElementsByTagName("head")[0].appendChild(g),v(),n.hnRefresh=function(){var o;p=((!0!==p||_.get(n,u))&&(m=_.get(n,["jStyles","styles"]),!n.bActiveRefresh&&m&&(_.get(m,["settings","element"])||_.get(m,["settings","class"]))&&(n.bActiveRefresh=!0,C(function(){n.bActiveRefresh=!1},1e3),o=angular.copy(n.jStyles),I.state.variableFields.forEach(function(e){E.valueContainsVariable(_.get(I.state.model,e))&&_.set(o,e,angular.copy(_.get(I.state.previewModel,e)))}),o.mapper=T.produceFormDefinitionForTree(null,!0),A.http({method:"POST",url:n.sCssEndpoint,headers:{"Content-Type":"application/json"},data:JSON.stringify(o)}).then(function(e){e="string"==typeof e?e:[];n.sCss=e[1]?e.split("\n\n").join(" "):"",S()}).catch(function(e){}))),!1)},n.hnColour=function(){n.oColourModel,r.style.backgroundColor=n.jStyles.sBackgroundColour=_.get(n,"oColourModel.value.hex")||""},n.hnScale=function(){var e=n.hBreakpoints[n.sSelectedBreakpoint];n.sCurrentIFrameWidth=(e.width||e.previewWidth)+"px",k()},n.$on("$destroy",function(){w()})}}}e.$inject=["$interval","$timeout","$window","ajaxSvc","drupalSvc","styleBuilderSvc","formStateSvc","cohVarSvc"],angular.module("cohesionApp").directive("cohStylePreview",e)}(drupalSettings.cohesion),angular.module("cohesionApp").directive("cohSuspendable",["cohSuspendSvc",function(t){return{link:function(e){var o;t.subscribe(e,function(){o=e.$$watchers,e.$$watchers=[]},function(){o&&(e.$$watchers=o),o=void 0})}}}]),function(drupalSettings){function cohTabs(){return{restrict:"E",templateUrl:"scripts/directives/coh-tabs/coh-tabs.html",controller:["$scope","formStateSvc","cohPermissionService","$timeout","cohSchemaFormSvc","cohTokenSvc",function controller($scope,formStateSvc,cohPermissionService,$timeout,cohSchemaFormSvc,cohTokenSvc){$scope.active="settings",$scope.parentActive="",$scope.activeChild="",$scope.$watch("form.tabs",function(){for(var e=0;e<$scope.form.tabs.length;e++)if($scope.form.tabs[e].hasPermission=$scope.checkPermission($scope.form.tabs[e]),$scope.form.tabs[e].key!==$scope.active&&($scope.form.tabs[e].loaded=!1),"ellipsis"===$scope.form.tabs[e].key){for(var o=!1,t=0;t<$scope.form.tabs[e].items[0].tabs.length;t++){var n=$scope.form.tabs[e].items[0].tabs[t];$scope.checkPermission(n)&&(n.hasPermission=!0,o=!(n.loaded=!1))}o||($scope.form.tabs[e].hasPermission=!1)}}),$scope.selectTab=function(e,o){return cohSchemaFormSvc.setGlobalDestroyStrategy("retain"),o.preventDefault(),$scope.active=e},$scope.checkPermission=function(e){return cohPermissionService.isPermittedByTabName(e.title)},$scope.selectChildTab=function(e,o,t){return t.preventDefault(),$scope.active=e,$scope.parentActive=o,$scope.activeChild=e},$scope.updateTab=function(e){$scope.parentActive="",$scope.activeChild="",cohSchemaFormSvc.setGlobalDestroyStrategy("destroy"),e.loaded=!0,$timeout(function(){window.dispatchEvent(new Event("resize"))})},$scope.deselectTab=function(){cohSchemaFormSvc.setGlobalDestroyStrategy("retain")},$scope.getUID=function(e){return e.replace(/\s+/g,"-").toLowerCase()},$scope.cohTabsOnAction=function(event,fn){return event.preventDefault(),eval(fn)},$scope.openDrupalDialog=function(e,o){e.preventDefault(),cohTokenSvc.openDrupalDialog(e,o)}}]}}angular.module("cohesionApp").directive("cohTabs",cohTabs)}(drupalSettings),angular.module("cohesionApp").directive("cohTagsInput",cohTagsInput),angular.module("cohesionApp").directive("cohTreeMenuButton",function(){return{templateUrl:"scripts/directives/coh-tree-menu-button/coh-tree-menu-button.html",scope:{form:"="},bindToController:!0,controllerAs:"tmb",controller:function(){var e;this.$onInit=function(){(e=this).currentLevelTitle=e.form.label,e.openMenu=function(){e.form.treeMenu.openFn()}}}}}),function(m){angular.module("cohesionApp").directive("cohTypeahead",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-typeahead/coh-typeahead.html",scope:{model:"=ngModel",formModel:"=",form:"=",options:"=",placeholder:"@",valueProperty:"=?",labelProperty:"=?",templateUrl:"=?",typeaheadEditable:"=",resultLimit:"=?",variableMode:"=?",initialOption:"=?"},bindToController:!0,controllerAs:"ctd",require:"ngModel",link:function(e,o,t,n){isNaN(e.ctd.model)&&e.ctd.typeaheadEditable||n.$setViewValue(e.ctd.model),n.$setPristine()},controller:["$scope","$q","$filter","ajaxSvc","$timeout","cohDropdownFix",function(e,i,r,a,o,l){var s,c=[];function t(o){if(_.isUndefined(o))return delete s.model,s.firstLoad=!1,i.resolve([]);if(!s.form.endpoint){c=s.options;var t={};return s.labelProperty?t[s.labelProperty]=o:t.$=o,i.resolve(r("filter")(c,t))}var n,t="";try{t=e.$eval(s.form.endpoint,{model:s.formModel})+o}catch(e){t=s.form.endpoint+o}return s.form.loading=!0,s.form.entityTypes&&(n=[],_.forEach(s.form.entityTypes,function(e,o){e&&n.push(o)}),t+="&"+m.param({entity_types:n})),a.get(t).then(function(e){return c=e,_.forEach(c,function(e,o){e.index=o}),l.onToggleDrop(!0),s.firstLoad=!1,s.loading=!1,c})}function n(){l.onToggleDrop(!1)}function d(o){if(1===c.length)return c[0][s.labelProperty];var e=_.find(c,function(e){return e[s.valueProperty]===o});return e?e[s.labelProperty]:s.typeaheadEditable?o:void 0}this.$onInit=function(){(s=this).valueProperty=s.valueProperty||"value",s.labelProperty=s.labelProperty||"label",s.typeaheadEditable=s.typeaheadEditable||!1,s.resultLimit=s.resultLimit||10,s.endpointKey=s.form.endpointKey,s.firstLoad=!0,s.firstLoaded=!1,s.getOptions=t,s.getLabel=d,s.onBlur=n,"/cohesionapi/link-autocomplete?q="!==s.endpoint||"number"!=typeof s.model&&isNaN(Number(s.model))||!s.model.length||(s.model="node::"+s.model),t(s.model).then(function(){s.firstLoaded=!0})}}]}})}(jQuery),function(){function e(r){return{restrict:"A",require:["ngModel"],scope:!1,link:function(t,e,o,n){var i;t.form.uniqueValue&&(i=t.form.pathToArray,t.$watch(function(){return _.get(t.model,i)},function(){var e=_.get(t.model,i),o=_.get(t.model,t.form.key),e=_.filter(e,function(e){if(_.get(e,t.form.uniqueProperty)===o)return e}).length;o&&1<e?(n[0].$setValidity("uniqueValue",!1),n[0].$setValidity("schemaForm",!1)):(n[0].$setValidity("uniqueValue",!0),n[0].$setValidity("schemaForm",!0),n[0].$setViewValue(n[0].$modelValue),r(function(){t.form.description=!1}))},!0))}}}e.$inject=["$timeout"],angular.module("cohesionApp").directive("cohUniqueValue",e)}(),angular.module("cohesionApp").directive("cohVarNameTag",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-var-name-tag/coh-var-name-tag.html",scope:{fieldData:"="},controllerAs:"cvnt",controller:["$scope","cohUUID",function(o,t){var n;function e(){var e=o.fieldData.getVariableModeModel();if(e)return o.fieldData.hasVariable()?(e=t.UUIDtoMachine(e),n.full?(n.showEllipses=!1,e):(n.showEllipses=13<e.length,e.substring(0,13))):""}this.$onInit=function(){(n=this).fieldData=o.fieldData,n.full=!1,n.getVariableName=e,n.showEllipses=!1}}]}}),angular.module("cohesionApp").directive("cohVarSwitchWatcher",function(){return{restrict:"A",controller:["$scope","formStateSvc",function(e,o){var t;function n(){t.isVariableMode=o.state.variableMode}this.$onInit=function(){t=this,o.variableModeAvailable?(t.isVariableMode=o.state.variableMode,t.toggleUseVariable=n,o.registerVariableWatcher(n),e.$on("$destroy",function(){o.deregisterVariableWatcher(n)}),n()):t.disable=!0}}]}}),angular.module("cohesionApp").directive("cohVarSwitcherShortcut",function(){return{restrict:"A",controller:["$scope","$document","formStateSvc",function(o,e,t){function n(e){e.altKey&&(t.toggleVariableMode(),e.stopPropagation(),e.preventDefault(),o.$apply())}this.$onInit=function(){t.variableModeAvailable&&(e.off(".toggleVarMode"),e.on("click.toggleVarMode",n))},this.$onDestroy=function(){e.off(".toggleVarMode"),t.variableModeAvailable=!1}}]}}),angular.module("cohesionApp").directive("cohVarSwitcher",function(){return{restrict:"E",templateUrl:"scripts/directives/coh-var-switcher/coh-var-switcher.html",controllerAs:"dir",controller:["$scope","$rootScope","$attrs","formStateSvc","$element","CohLayoutCanvas","cohUUID","cohVarSvc","cohSchemaFormSvc",function(t,o,e,n,i,r,a,l,s){var c;function d(){return t.form.disableVarSwitcher||!n.variableModeAvailable}function m(e){return arguments.length?(h(e),e):g()}function p(){return _.get(t.model,c.formKey)}function u(e){return _.set(t.model,c.formKey,e)}function h(e){return!_.isUndefined(e)&&_.set(n.state.variableModeModel,c.formKey,e)}function f(){return _.unset(n.state.variableModeModel,c.formKey)}function g(){return _.get(n.state.variableModeModel,c.formKey)}function v(){return _.unset(n.state.previewModel,c.formKey)}function b(){return-1!==n.state.variableFields.indexOf(c.formKeyStr)}function y(e){e?-1===n.state.variableFields.indexOf(c.formKeyStr)&&n.state.variableFields.push(c.formKeyStr):-1!==(e=n.state.variableFields.indexOf(c.formKeyStr))&&n.state.variableFields.splice(e,1)}function w(e){return e=e||g(),l.isValueVariable(e)}function k(){c.isVariableMode=t.form.isVariableMode=n.state.variableMode,!c.isVariableMode&&g()?y(!0):c.isVariableMode||g()||(f(),v(),y(!1)),b()?_.set(t,"form.required",!1):_.set(t,"form.required",c.isRequiredField)}this.$onInit=function(){if((c=this).varSwitcherLoaded=!1,d())return c.disable=!0,c.varSwitcherLoaded=!0,void i.remove();c.hideLabel="true"===i.attr("hide-tag"),c.toggleUseVariable=k,c.hasVariable=b,c.getVariableModeModel=g,c.variableModeModel=m,c.valueIsVariable=w,c.varSwitcherDisabled=d,c.formKey=t.form.key,c.formKeyStr=t.form.key.join("."),c.cohIdKey=t.form.cohIdKey,c.isRequiredField=t.form.required,b()&&!g()&&(h(p()),u(_.get(n.state.previewModel,c.formKey))),function(){n.registerVariableWatcher(k);var e=o.$on("cohFormSaving",function(e,o){(o=o||{}).key&&0!==c.formKey.indexOf(o.key)||b()&&(n.state.submitting&&t.$suspend(),function(e){{if(!_.isUndefined(e))return _.set(n.state.previewModel,c.formKey,e);v()}}(p()),u(g()))});t.$on("$destroy",function(){n.deregisterVariableWatcher(k),e(),f(),"retain"!==s.getGlobalDestroyStrategy()&&(v(),y(!1))})}(),k(),c.varSwitcherLoaded=!0}}]}}),function(){function e(i){return{restrict:"A",require:"ngModel",link:function(o,e,t,n){o.formats=[],void 0!==i.settings.editor.formats?_.get(o.form,"wysiwyg.format")?o.formats=[{label:i.settings.editor.formats[o.form.wysiwyg.format].label,value:i.settings.editor.formats[o.form.wysiwyg.format].format}]:_.forOwn(i.settings.editor.formats,function(e){"ckeditor"===e.editor&&o.formats.push({label:e.label,value:e.format})}):o.formats=[{label:"No text formats available",value:""}]}}}e.$inject=["drupalSvc"],angular.module("cohesionApp").directive("cohWysiwygFormat",e)}(),function(m,p){o.$inject=["drupalSvc","cohUUID","$timeout","cohDeviceService","$rootScope"];var e=CKEDITOR.ui.floatPanel.prototype,u={};function o(a,l,s,c,d){return{restrict:"A",require:"ngModel",scope:{form:"=",format:"=",model:"="},priority:10,link:function(n,o,e,i){function t(){return _.get(i,"$modelValue.textFormat")||_.get(a,"settings.editor.default")}function r(){n.form.instance=n.form.key.join("-"),_.get(n,"model")||(n.model=_.get(n,"form.defaultValue")),o.val(_.get(n,"model.text")),n.onBeforeApply=d.$on("cohBeforeSidebarApply",function(){i.$modelValue.text||i.$setViewValue(void 0)}),i.$render=function(){o.val(i.$viewValue)},i.$formatters.push(function(e){return l.UUIDtoMachine(e)}),i.$formatters.push(function(e){return"object"!==_typeof(e)?e:_.get(e,"text")}),i.$parsers.push(function(e){return l.machineToUUID(e)}),i.$parsers.push(function(e){return"object"!==_typeof(e)?{text:e,textFormat:t()}:e}),s(function(){if(i.$setViewValue(o.val()),!n.$$destroyed){var e=_.get(a,["settings","editor","formats",t()]);if(void 0===e)return n.allowedTextFormat=!1,void p(o).replaceWith("<textarea disabled>This field has been disabled because you do not have sufficient permissions to edit it.</textarea>");!0===c.isIOS&&(e.editorSettings.extraPlugins+=",dx8_divarea"),n.ck=m.editors.ckeditor.attach(o[0],e),m.editors.ckeditor.onChange(o[0],function(e){i.$setViewValue(e)}),CKEDITOR.instances[n.form.instance].on("instanceReady",function(){var e=this;_.get(e,"element")&&e.element.getEditor()&&e.element.getEditor().document.$.fonts.ready.then(function(){e.element.getEditor().execCommand("autogrow")})}),CKEDITOR.instances[n.form.instance].on("afterInsertHtml",function(){var e=this;s(function(){i.$setViewValue(CKEDITOR.instances[n.form.instance].getData()),_.get(e,"element")&&e.element.getEditor()&&e.element.getEditor().execCommand("autogrow")})}),CKEDITOR.instances[n.form.instance].on("mode",function(){var e,t;"source"===this.mode&&(e=CKEDITOR.instances[n.form.instance].editable(),t=this.filter,e.attachListener(e,"input",function(){var e=CKEDITOR.htmlParser.fragment.fromHtml(this.$.value),o=new CKEDITOR.htmlParser.basicWriter;t.applyTo(e),e.writeHtml(o),i.$setViewValue(o.getHtml())})),i.$setViewValue(CKEDITOR.instances[n.form.instance].getData()),_.get(this,"element")&&this.element.getEditor()&&this.element.getEditor().execCommand("autogrow")}),n.wysiwygInitialised=!0}})}n.ck={},n.formats=[],n.allowedTextFormat=!0,CKEDITOR.on("instanceDestroyed",function(){var e,o,t=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(e in u)u.hasOwnProperty(e)&&(o=u[e],t?o.destroy():o.element.hide());u={}}),n.destroyWysiwyg=function(e){m.editors.ckeditor.detach(o[0],e,null)},n.$watch(function(){return _.get(i,"$modelValue.textFormat")},function(e,o){n.wysiwygInitialised&&e&&(n.destroyWysiwyg(o),r())}),n.$on("coh-array-update",function(e){n.destroyWysiwyg(CKEDITOR.instances[n.form.instance].getData(1)),r()}),n.$on("$destroy",function(){n.wysiwygInitialised&&(CKEDITOR.instances[n.form.instance].updateElement(),CKEDITOR.instances[n.form.instance].removeAllListeners(),CKEDITOR.instances[n.form.instance].destroy(!0),m.editors.ckeditor.detach(o[0],t(),null),n.wysiwygInitialised=!1,n.onBeforeApply())}),this.$onInit=r()}}}angular.module("cohesionApp").directive("cohWysiwyg",o),CKEDITOR.plugins.add("dx8_divarea",{afterInit:function(t){t.addMode("wysiwyg",function(e){var o=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset cke_enable_context_menu" hidefocus="true"></div>');t.ui.space("contents").append(o),(o=t.editable(o)).detach=CKEDITOR.tools.override(o.detach,function(e){return function(){e.apply(this,arguments),this.remove()}}),t.setData(t.getData(1),e),t.fire("contentDom")})}}),CKEDITOR.ui.floatPanel=function(e,o,t,n){t.forceIFrame=1;var i=(o=CKEDITOR.document.getById("cke_"+e.name)).getDocument(),r=function(e,o,t,n,i){var r=CKEDITOR.tools.genKey(o.getUniqueId(),t.getUniqueId(),e.lang.dir,e.uiColor||"",n.css||"",i||""),i=u[r];i||((i=u[r]=new CKEDITOR.ui.panel(o,n)).element=t.append(CKEDITOR.dom.element.createFromHtml(i.render(e),o),!0),i.element.setStyles({display:"none",position:"absolute"}));return i}(e,i,o,t,n||0),a=r.element,n=a.getFirst(),l=this;function s(){l.hide()}a.disableContextMenu(),this.element=a,this._={editor:e,panel:r,parentElement:o,definition:t,document:i,iframe:n,children:[],dir:e.lang.dir,showBlockParams:null},e.on("mode",s),e.on("resize",s),i.getWindow().on("resize",function(){this.reposition()},this)},CKEDITOR.ui.floatPanel.prototype=e}(Drupal,jQuery),angular.module("cohesionApp").directive("cohYoutubeEmbed",function(){return{scope:{model:"=ngModel",ngModel:"=",form:"="},bindToController:!0,controllerAs:"cye",templateUrl:"scripts/directives/coh-youtube-embed/coh-youtube-embed.html",require:"ngModel",controller:["$scope","$timeout",function(e,o){var t;function n(e){var o=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?]*).*/;return"string"==typeof e&&e.match(o)?e="https://www.youtube.com/embed/"+e.match(o)[1]:""}function i(){return _.get(t,"model")}this.$onInit=function(){t=this,i()&&(t.previewUrl=n(i())),e.$watch(function(){return t.model},function(e,o){e||(t.previewUrl=!1),e&&e!==o&&(t.previewUrl=n(e))},!0)}}]}}),angular.module("cohesionApp").filter("cohPreferredColourFormat",function(){function t(e){var o,t;return t=e.value.rgba?"rgba"!==e.value.rgba.substring(0,4)||"1"===(o=e.value.rgba.substring(5,e.value.rgba.length-1).split(", "))[3]?", 100%":(1===(o=o[3].substring(2,4)).length&&"0"!==o&&(o+="0"),", "+(o=""===o?"0":o)+"%"):t}return function(e,o){return e&&e.value&&e.value.rgba&&e.value.hex?!o||"rgb"===o?e.value.rgba:t(e)?e.value[o]+t(e):e.value[o]:""}}),angular.module("cohesionApp").filter("filename",function(){return function(e){e=e.match(/\/([^\/]+)\/?$/);return e&&e.length?e[1]:""}}),angular.module("cohesionApp").filter("get",function(){return function(e,o){return _.get(e,o)}}),angular.module("cohesionApp").filter("groupBy",["$parse","filterWatcher",function(r,a){return function(e,o){return!angular.isObject(e)||angular.isUndefined(o)?e:a.isMemoized("groupBy",arguments)||a.memoize("groupBy",arguments,this,(e=e,t=r(o),i={},angular.forEach(e,function(e){n=t(e),i[n]||(i[n]=[]),i[n].push(e)}),i));var t,n,i}}]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function(n,i){var r={},a={},l=n.setTimeout;function s(e,o){return[e,JSON.stringify(o,(t=[],function(e,o){if(angular.isObject(o)&&null===!o){if(~t.indexOf(o))return"[Circular]";t.push(o)}return n==o?"$WINDOW":n.document==o?"$DOCUMENT":d(o)?"$SCOPE":o}))].join("#").replace(/"/g,"");var t}function c(e){e=e.targetScope.$id;angular.forEach(a[e],function(e){delete r[e]}),delete a[e]}function d(e){return e&&e.$evalAsync&&e.$watch}return{isMemoized:function(e,o){return o=s(e,o),r[o]},memoize:function(e,o,t,n){var e=s(e,o);return r[e]=n,d(t)?(o=e,t=(e=t).$id,angular.isUndefined(a[t])&&(e.$on("$destroy",c),a[t]=[]),a[t].push(o)):l(function(){i.$$phase||(r={})},2e3),n}}}]}),angular.module("cohesionApp").filter("includes",function(){return function(e,o){return!(!Array.isArray(e)&&"string"!=typeof e)&&e.includes(o)}}),angular.module("cohesionApp").filter("isEmpty",function(){return function(e){return _.isEmpty(e)}}),angular.module("cohesionApp").filter("isTransparent",function(){return function(e){return"string"==typeof e?e.split(" ").join("").indexOf(",0)"):-1}}),angular.module("cohesionApp").filter("join",function(){return function(e,o){return e?_.isArray(e)?e.join(o):e:""}}),angular.module("cohesionApp").filter("number",function(){return function(e){return parseInt(e,10)}}),angular.module("cohesionApp").filter("range",function(){return function(e){return _.range(e)}}),angular.module("cohesionApp").filter("trustUrl",["$sce",function(o){return function(e){return o.trustAsResourceUrl(e)}}]),angular.module("cohesionApp").filter("typeof",function(){return function(e){return _typeof(e)}}),angular.module("cohesionApp").filter("vendorPrefix",function(){var e,o=(e=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1],{dom:"WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1],lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)});return function(e){return o.css+e}}),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohAccordion","scripts/form-elements/coh-accordion/coh-accordion.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohArray","scripts/form-elements/coh-array/coh-array.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohAvailableColorSelect","scripts/form-elements/coh-available-color-select/coh-available-color-select.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohBreakpointFieldset","scripts/form-elements/coh-breakpoint-fieldset/coh-breakpoint-fieldset.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCanvasPreview","scripts/form-elements/coh-canvas-preview/coh-canvas-preview.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCheckboxGroup","scripts/form-elements/coh-checkbox-group/coh-checkbox-group.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","checkboxToggle","scripts/form-elements/coh-checkbox-toggle/coh-checkbox-toggle.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCheckbox","scripts/form-elements/coh-checkbox/coh-checkbox.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohColourPickerOpener","scripts/form-elements/coh-colour-picker-opener/coh-colour-picker-opener.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohColourPicker","scripts/form-elements/coh-colour-picker/coh-colour-picker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCombiBox","scripts/form-elements/coh-combi-box/coh-combi-box.html",o.stdBuilders),e.defineAddOn("bootstrapDecorator","cohCombiBoxText","scripts/form-elements/coh-combi-box/coh-combi-box-text.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohComponentForm","scripts/form-elements/coh-component-form/coh-component-form.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohComponentTranslationSettings","scripts/form-elements/coh-component-translation-settings/coh-component-translation-settings.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohContextEditComponent","scripts/form-elements/coh-context-edit-component/coh-context-edit-component.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCustomSelect","scripts/form-elements/coh-custom-select/coh-custom-select.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohCustomSettingsButton","scripts/form-elements/coh-custom-settings-button/coh-custom-settings-button.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohElementSettings","scripts/form-elements/coh-element-settings/coh-element-settings.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohEntityBrowser","scripts/form-elements/coh-entity-browser/coh-entity-browser.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohEntityPicker","scripts/form-elements/coh-entity-picker/coh-entity-picker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFieldMachineName","scripts/form-elements/coh-field-machine-name/coh-field-machine-name.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFileBrowser","scripts/form-elements/coh-file-browser/coh-file-browser.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFileUploader","scripts/form-elements/coh-file-uploader/coh-file-uploader.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohFormBuilder","scripts/form-elements/coh-form-builder/coh-form-builder.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFormButton","scripts/form-elements/coh-form-button/coh-form-button.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFormHeaderMessage","scripts/form-elements/coh-form-header-message/coh-form-header-message.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFormPreview","scripts/form-elements/coh-form-preview/coh-form-preview.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohFrontEndEditComponent","scripts/form-elements/coh-front-end-edit-component/coh-front-end-edit-component.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohGoogleMarker","scripts/form-elements/coh-google-marker/coh-google-marker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohGradientPicker","scripts/form-elements/coh-gradient-picker/coh-gradient-picker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohHelperSwitcher","scripts/form-elements/coh-helper-switcher/coh-helper-switcher.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohHelpText","scripts/form-elements/coh-helptext/coh-helptext.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohHidden","scripts/form-elements/coh-hidden/coh-hidden.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohIconPickerOpener","scripts/form-elements/coh-icon-picker-opener/coh-icon-picker-opener.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","iconPicker","scripts/form-elements/coh-icon-picker/coh-icon-picker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohLayoutCanvas","scripts/form-elements/coh-layout-canvas/coh-layout-canvas.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohMediaEmbed","scripts/form-elements/coh-media-embed/coh-media-embed.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohModalSection","scripts/form-elements/coh-modal-section/coh-modal-section.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohMultiButton","scripts/form-elements/coh-multi-button/coh-multi-button.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","number","scripts/form-elements/coh-number/coh-number.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohPickerMenu","scripts/form-elements/coh-picker-menu/coh-picker-menu-form-element.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohRadios","scripts/form-elements/coh-radios/coh-radios.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohRange","scripts/form-elements/coh-range/coh-range.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohSection","scripts/form-elements/coh-section/coh-section.html",o),e.defineAddOn("bootstrapDecorator","section","scripts/form-elements/coh-section/section-template.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohSelectPicker","scripts/form-elements/coh-select-picker/coh-select-picker.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohSelect","scripts/form-elements/coh-select/coh-select.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohStyleBuilderMenu","scripts/form-elements/coh-style-builder-menu/coh-style-builder-menu.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohStyleGuideLayout","scripts/form-elements/coh-style-guide-layout/coh-style-guide-layout.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohStyleGuideList","scripts/form-elements/coh-style-guide-list/coh-style-guide-list.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohStyleHelperButton","scripts/form-elements/coh-style-helper-button/coh-style-helper-button.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohSubmit","scripts/form-elements/coh-submit/coh-submit.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohSuccessLabel","scripts/form-elements/coh-success-label/coh-success-label.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohTabContainer","scripts/form-elements/coh-tab-container/coh-tab-container.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohTabItem","scripts/form-elements/coh-tab-item/coh-tab-item.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){o=o.stdBuilders.concat(o.builders.transclusion);e.defineAddOn("bootstrapDecorator","cohTabs","scripts/form-elements/coh-tabs/coh-tabs.html",o)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohTagsInput","scripts/form-elements/coh-tags-input/coh-tags-input.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohTextBox","scripts/form-elements/coh-text-box/coh-text-box.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohTextarea","scripts/form-elements/coh-textarea/coh-textarea.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohTypeahead","scripts/form-elements/coh-typeahead/coh-typeahead.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohVariableButton","scripts/form-elements/coh-variable-button/coh-variable-button.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohWorkflowStatus","scripts/form-elements/coh-workflow-status/coh-workflow-status.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohWysiwyg","scripts/form-elements/coh-wysiwyg/coh-wysiwyg.html",o.stdBuilders)}]),angular.module("cohesionApp").config(["schemaFormDecoratorsProvider","sfBuilderProvider",function(e,o){e.defineAddOn("bootstrapDecorator","cohYoutubeEmbed","scripts/form-elements/coh-youtube-embed/coh-youtube-embed.html",o.stdBuilders)}]),function(m){function e(n,e,i,t,r,a){var l=this,s="Page is submitting, request not sent";function c(e,o){return o?e:m.url(e.replace(/^\//,""))}function d(e){a.get("$http").remove(e.config.url);var o="";return l.jLastRequest.bSuccess=!1,o=-1!==e.status||e.statusText?_.get(e,"data.error")?_.get(e,"data.error"):"Server error."+(e.data.error?": "+e.data.error:"")+" Please try again later.":"The server could not be reached. Please check your internet connection.","abort"!==e.xhrStatus&&t.notify({content:o,className:"danger"}),o}l.http=function(e,o){if(r.state.submitting)return i.reject(s);return e.data=e.data||"",e.url=c(e.url,o),n(e).then(function(e){return l.jLastRequest.bSuccess=!0,e.data}).catch(function(e){throw new Error(d(e))})},l.get=function(e,o,t){if(r.state.submitting)return i.reject(s);return l.jLastRequest.sUrl=e,o=_.merge({cache:!0},o),e=c(e,t),n.get(e,o).then(function(e){return l.jLastRequest.bSuccess=!0,e.data}).catch(function(e){throw new Error(d(e))})},l.post=function(e,o,t){if(r.state.submitting)return i.reject(s);return e=c(l.jLastRequest.sUrl=e,t),n.post(e,o).then(function(e){return l.jLastRequest.bSuccess=!0,e.data}).catch(function(e){throw new Error(d(e))})},l.put=function(e,o,t){if(r.state.submitting)return i.reject(s);return e=c(l.jLastRequest.sUrl=e,t),n.put(e,o).then(function(e){return l.jLastRequest.bSuccess=!0,e.data}).catch(function(e){throw new Error(d(e))})},l.delete=function(e,o){if(r.state.submitting)return i.reject(s);return e=c(l.jLastRequest.sUrl=e,o),n.delete(e).then(function(e){return l.jLastRequest.bSuccess=!0,e.data}).catch(function(e){throw new Error(d(e))})},l.wrap=c,l.jLastRequest={}}e.$inject=["$http","$log","$q","notificationSvc","formStateSvc","$cacheFactory"],angular.module("cohesionApp").service("ajaxSvc",e)}(Drupal),function(o){function e(e){if(o.cohesion.api_urls)return o.cohesion.api_urls;e.notify({content:"API error, please try again or contact your administrator.",className:"danger"})}e.$inject=["notificationSvc"],angular.module("cohesionApp").service("apiUrls",e)}(drupalSettings),function(){function e(n,i){var r=this;function o(e){return _.isEmpty(r.formsData)?{}:angular.copy(_.get(r.formsData,e))}r.getAll=function(o){o&&i.get("$http").remove(n.wrap("/cohesionapi/element"));return n.get("/cohesionapi/element").then(function(e){return(_.isEmpty(r.formsData)||o)&&(i.get("$http").get(n.wrap("/cohesionapi/element"))[1]=e,r.formsData=e),e})},r.updateCachedData=function(e,o){var t=i.get("$http").get(n.wrap("/cohesionapi/element")),t="string"==typeof t[1]?JSON.parse(t[1]):t[1];_.set(t,e,o),_.set(r.formsData,e,o)},r.get=function(o){return r.getAll().then(function(e){return _.get(e,o)})},r.getCachedForm=function(e){return o(e).form},r.getCachedObject=o,r.formsData={}}e.$inject=["ajaxSvc","$cacheFactory"],angular.module("cohesionApp").service("cohApiSvc",e)}(),jQuery,angular.module("cohesionApp").service("cohBroadcastSvc",function(){this.broadcastXtabs=function(e,o){if("string"!=typeof e)throw"key must be a string";localStorage.setItem("cohBroadcast",JSON.stringify({key:e,data:o})),localStorage.removeItem("cohBroadcast")}}),function(){function e(t,n,l,s,c){this.updateFrameUrl=function(e,o){return t.http({method:"POST",url:"/cohesionapi/component/preview_post",headers:{"Content-Type":"application/json"},data:function(e,o){var t=_.get(c.state.model,[e,o]),i=/\[field\.(.*)\]/m,r=/\{\{([trueValue||falseValue}]+)\}\}/m,o={canvas:t,model:angular.copy(l.getNodesData(t,"model")),mapper:angular.copy(l.getNodesData(t,"mapper"))},t=l.getNodesData(t,"previewModel");var a=s.getDefaultModel(_.get(c,["state","model",e]));return _.mergeWith(o.model,t,function(e,o){return"string"==typeof e&&"object"===_typeof(o)&&i.test(e)?_.has(o,"textFormat")&&""===_.get(o,"text")||_.has(o,"entity_type")&&!_.get(o,"entity")||_.has(o,"entity")&&""===_.get(o,"entity")?e:o:!0===_.get(e,"hideEnable")?("string"==typeof _.get(o,"hideData")?e.hideData=o.hideData:e.hideData="",e):""===o?e:void 0}),_.deepMap(o.model,function(e){var o=i.exec(e),t=l.getNodeData(o?{uuid:o[1]}:{}),n=l.getNodeData(o?{uuid:o[1]}:{},"model"),n=_.get(n,"settings.showCondition")?_.get(a,o[1]):_.get(n,"model.value");return o&&n?["string","number","boolean"].includes(_typeof(n))?e=e.replace(i,n):_.isObject(n)&&(e=n):o&&!n&&(e=void 0),e&&"checkboxToggle"===_.get(t,"settings.type")&&(n=e.match(r),e=t.settings[n[1]]),e}),JSON.stringify(o)}(e,o)}).then(function(e){return n.broadcastXtabs("newUrl",{frameSrc:e.iframe_url+(_.get(l.data,["lastModified","uuid"])?"#"+l.data.lastModified.uuid:""),scope:window.location.pathname}),e})},this.highlightElementInPreview=function(e){n.broadcastXtabs("highlightElement",{uuid:e,scope:window.location.pathname})},this.entityWhiteList=["cohesion_master_templates","cohesion_content_templates","cohesion_helper","cohesion_component"],this.state={scale:1,autoScaleOn:!0,columnWidth:12,boxedWidth:!1,colorModel:{value:{hex:"#ffffff",rgba:"rgba(255, 255, 255, 1)"}}}}e.$inject=["ajaxSvc","cohBroadcastSvc","CohLayoutCanvas","cohFormBuilderRenderSvc","formStateSvc"],angular.module("cohesionApp").service("cohCanvasPreviewSvc",e)}(),function(){function e(e){var o=this;o.isIOS=function(){return"ios"===o.os},o.os=e.os,o.browser=e.browser}e.$inject=["deviceDetector"],angular.module("cohesionApp").service("cohDeviceService",e)}(),function(l){function e(i){var r;this.onToggleDrop=function(e){{var o,t,n;!0===e?(n=l(a),(r=n.closest(".coh-scrollbars")).length&&(r.css({paddingBottom:0}),n.length&&(o=n.offset().top,t=n.height(),e=r.offset().top,n=r.outerHeight(),0<(n=o+t-(e+n)+40)?r.css({paddingBottom:n}):r.css({paddingBottom:0})))):i(function(){r&&r.length&&!l(a).length&&r.css({paddingBottom:0})},10)}};var a=".dropdown.open .dropdown-menu, [uib-typeahead-popup].dropdown-menu:not(.ng-hide)"}e.$inject=["$timeout"],angular.module("cohesionApp").service("cohDropdownFix",e)}(jQuery),function(){function e(o,e,t){var n,i=this;i.open=function(e){if(a())return!1;return t.savePosIfMobile(),(n=o.open(angular.extend(r,e))).result.then(function(){l()},function(){l()}),n},i.close=function(){n&&n.close()},i.isOpen=a,i.selectTab=function(e){i.selectedTab=parseInt(e)},i.getSelectedTab=function(){return i.selectedTab},i.hide=angular.noop,i.show=angular.noop,i.isShown=!0,i.selectedTab=0;var r={templateUrl:"scripts/directives/coh-element-browser/coh-element-browser-modal.html",size:"lg",controller:"CohElementBrowserModalController",windowClass:"coh-element-browser-modal",openedClass:"coh-element-browser",backdrop:"static",backdropClass:"coh-modal-backdrop coh-element-browser-backdrop",animation:!1};function a(){return void 0!==n}function l(){n=void 0,e.deSelectAllNodes(!0),t.scrollToIfMobile(),t.stopBodyScrolling(!1)}}e.$inject=["$uibModal","CohLayoutCanvas","cohScrollPosSvc"],angular.module("cohesionApp").service("cohElementBrowserModalService",e)}(),function(l){function e(t,n){var i,r=["Possibly unhandled rejection: cancel","Possibly unhandled rejection: escape key press","The server could not be reached. Please check your internet connection."],a=!1;return function(e,o){a||(a=!0,"string"==typeof e&&(e={message:e}),-1===r.indexOf(e.message)?(t.error(e,o),o=e,(i=i||n.get("ajaxSvc")).post(l.cohesion.error_url,{message:o.stack}).then(function(){a=!1},function(){a=!1}),l.cohesion.log_dx8_error,window.Cypress&&window.setTimeout(function(){throw e})):a=!1)}}e.$inject=["$log","$injector"],angular.module("cohesionApp").factory("$exceptionHandler",e)}(drupalSettings),function(){function e(e,t,n){var r=this;r.convert=l,r.initialiseForm=function(e,o,t,n){var i=[],n=Object.assign({},a,n);n.hideTitle||i.push({type:"cohTextBox",key:"settings.title",title:"Component title",decoratorClass:"coh-title-input",noTitle:!0,placeholder:"Component title",disableVarSwitcher:!0,schema:{type:"string"},$validators:{required:function(e){return!!(!r.isSavingAsContent||e&&e.length)}}});e=l(e,o,n.canAccessTokens,n.trackEdits);o=e.form.length||0,n.canAccessTokens&&(i=(n.hideTitle?[]:i).concat(function(e){var o=[{type:"cohFormButton",decoratorClass:"coh-token-browser-container",ariaLabel:"Open token browser",tooltip:"Open token browser",tooltipAppendBody:"true",tooltipPlacement:"top-left",tooltipClass:"coh-tooltip",style:"coh-token-browser-btn coh-icon-open-token-browser",onClick:'openDrupalDialog($event, "cohesion.drupalTokensUri")',hideText:!0}];e||o.unshift({type:"cohFormButton",decoratorClass:"coh-toggle-variable-mode-container",ariaLabel:"Toggle variable mode",tooltip:"Toggle variable mode",tooltipAppendBody:"true",tooltipPlacement:"top-left",tooltipClass:"coh-tooltip",style:"coh-toggle-variable-mode-btn coh-icon-toggle-variable-mode",onClick:"toggleVariableMode($event)",hideText:!0});return o}(n.hideToggleVariableMode)));n.hideToggleVariableMode&&(e.schema.cohConfig.variableModeAvailable=!1);o=function(e,o){var t,n=e.componentContentId,i=void 0!==n&&n;n=!0===function(){try{return window.self!==window.top}catch(e){return!0}}()?"_blank":"_self";e&&!1!==i?t={type:"cohFormHeaderMessage",htmlClass:"alert-warning",titleText:"Component content",bannerText:"This component has been saved as component content. It must be edited separately.",cta:{href:e.url,text:"Click here to edit",target:n}}:0===o&&(t={type:"cohFormHeaderMessage",htmlClass:"alert-warning",titleText:"No editable settings.",bannerText:"This ".concat(e.type," does not have any user editable settings.")});return t}(t,o);o&&e.form.unshift(o);return e.form.unshift(function(e,o){var t={type:"section",htmlClass:"coh-actions-bar hidden"},o=o?"coh-actions-bar coh-component-title-row coh-access-tokens":"coh-actions-bar coh-component-title-row";e.length&&(t={type:"section",htmlClass:o,items:e});return t}(i,n.canAccessTokens)),e.form.push({type:"cohPickerMenu"}),e.form=[{type:"cohComponentForm",title:"settings",mapperKey:"settings",disableTreeMenu:!0,hideActionsBar:!0,propertyOptionsKey:"customComponent",defaultKey:"customComponent",items:e.form.slice(0)}],e},r.getDefaultModel=function(r){var e,a={},l={},o=r.model;for(e in o){var t=_.get(o[e],"settings.suffix"),n=_.get(o[e],"model.value");n&&(n="{{trueValue}}"===n||"{{falseValue}}"!==n&&n,t&&(n+=t),_.set(l,e,angular.copy(n)))}r.componentForm&&!function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){var o=f(_.get(r.model,[e.uuid,"settings","showCondition"])),t=!0;if(o&&""!==o)try{t=s(o,l)}catch(e){}t&&("form-field-repeater"===e.uid?(_.set(a,e.uuid,[]),i=e.uuid):!1!==i&&l[e.uuid]?_.set(a,[i,0,e.uuid],angular.copy(l[e.uuid])):_.set(a,e.uuid,angular.copy(l[e.uuid])),e.children&&e.children.length&&n(e.children,i))})}(r.componentForm||[]);return a},r.getComponentContentNode=function(o){return t.get("/cohesionapi/component-content/"+o).then(function(e){if(e.json_values)return e.json_values=JSON.parse(e.json_values),_.set(e,"json_values.canvas[0].componentContentId",o),e})},r.saveComponentContent=function(e,o){return t.post("/cohesionapi/component-content-save",{canvas:[e],model:o})},r.getCondition=f;var a={hideTitle:r.isSavingAsContent=!1,canAccessTokens:e.hasPermission("access tokens"),hideToggleVariableMode:!1,trackEdits:!1},h={string:"cohTextBox",number:"number",image:"cohFileBrowser"},d={"is equal to":"==","is not equal to":"!=","is lt":"<","is lte":"<=","is gt":">","is gte":">=",AND:"&&",OR:"||"},m={"hex is ":".value.hex ==","rgba is ":".value.rgba ==","variable is ":".variable ==","is transparent":".value.rgba | isTransparent !== -1","fontFamily is ":".fontFamily ==","textFormat is ":".textFormat =="};function f(e){if(!e)return"";for(var o="model".concat(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"","['$1']"),t=0,n=Object.entries(d);t<n.length;t++){var i=_slicedToArray(n[t],2),r=i[0],i=i[1],r=new RegExp(" ".concat(r," "),"gi");e=e.replace(r," ".concat(i," "))}for(var a=0,l=Object.entries(m);a<l.length;a++){var s=_slicedToArray(l[a],2),c=s[0],s=s[1],c=new RegExp(" ".concat(c),"gi");e=e.replace(c,"".concat(s," "))}return e="!!("+(e=(e=(e=(e=(e=(e=(e=e.replace(/['"]#([0-9a-f]{3}|[0-9a-f]{6})['"]/gim,function(e){return e.toLowerCase()})).replace(/(["']rgba\(.*\)["'])/gim,function(e){return e.toLowerCase().split(" ").join("").split(",").join(", ")})).replace(/(\[field.\S*\]).value.rgba/gm,"$1.value.rgba")).replace(/(\[field.\S*\])(\.value\.rgba \| isTransparent)/gm,"($1$2)")).replace(/(\[\S*\])\s+(tags|text)(?: includes?)\s+(['"][^'"]+['"])/gm,"($1.$2 | includes:$3)")).replace(/(\[\S*\])\s+(?:includes|contains|has)\s+(['"][^'"]+['"])/gm,"($1 | includes:$2)")).replace(/\[field.([\w-]+)]/gm,o))+")"}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],m={type:"cohTextBox",ngModelOptions:{},trackEdits:n,previewWarningIcon:n},p={},u={type:"object",properties:{cohesion:{type:"object"}},cohConfig:{variableModeAvailable:t},required:[]};o=function e(o,t,n){for(var i=2<arguments.length&&void 0!==n?n:[],r=[],a=0;a<o.length;a+=1){var l,s,c,d=o[a];"placeholder"!==d.uuid&&(l=t[d.uuid]||{},s=_objectSpread(_objectSpread(_objectSpread({},m),l.settings),{key:d.uuid}),void 0!==_.get(l,"model.value")&&(s.defaultValue=l.model.value),void 0!==_.get(l,"settings.showCondition")&&(s.destroyStrategy="conditionalRetain"),(c=f(s.showCondition,i))&&(s.condition=c),s.type="cohTextBox"===s.type?h[_.get(l,"settings.schema.type")]:s.type,("form-container"===d.type||"form-field-container"===d.type)&&d.children&&d.children.length&&("form-field-repeater"===d.uid&&(i="['".concat(d.uuid,"'][arrayIndex]")),s.items=e(d.children,t,i)),s.items&&delete s.trackEdits,r.push(s),l.model&&(p[d.uuid]=l.model.value,"checkboxToggle"===s.type&&("{{trueValue}}"===l.model.value?(p[d.uuid]=!0,l.model.value=!0):"{{falseValue}}"===l.model.value&&(p[d.uuid]=!1,l.model.value=!1)),"cohSelect"===s.type&&(_.set(s,"schema.type",["string","number","boolean"]),void 0!==l.model.value&&(s.defaultValue=l.model.value))),"checkboxToggle"===s.type&&(delete s.trueValue,delete s.falseValue,delete s.toggleType,_.set("formEl","schema.type","boolean")),_.get(l,"settings.schema")&&l.settings.schema.required&&(u.required.push(d.uuid),u.properties[d.uuid]=l.settings.schema))}return r}(e,o);return{model:p,schema:u,form:o}}function s(e,o){return n.$eval(e,{model:o})}}e.$inject=["cohPermissionService","ajaxSvc","$rootScope"],angular.module("cohesionApp").service("cohFormBuilderRenderSvc",e)}(),angular.module("cohesionApp").service("cohFormPreviewModelSvc",function(){this.model={}}),function(){function e(t,e,a,n,i,l,r,s){var c=this;function d(e){return jQuery("#"+e.uuid)}function m(e){return e.isFormBuilder?"form-canvas":"canvas"}function p(e,o){return _.get(c.canvasData,[o||"model",e.componentContentId||e.uuid])}function u(e,o){e.componentContentId&&!p(e)?_.set(c.canvasData,["model",e.componentContentId],o):_.set(c.canvasData,["model",e.uuid],o)}function h(e){if(e.isContainer="container"===e.type||"form-container"===e.type||"form-field-container"===e.type||"root"===e.type||"component"===e.type&&_.size(_.filter(e.children,function(e){return!_.get(e,"status.disabled")})),"helper"===e.type)for(var o=0;o<e.jsonValues.length;o++)h(e.jsonValues[o]);if(_.isArray(e.children))for(var t=0;t<e.children.length;t++)h(e.children[t])}c.getType=function(e){return _.get(e,"componentType")||_.get(e,"helperType")||e.uid},c.getDomNode=d,c.getCanvasType=m,c.getSelected=function(){return c.data.selected},c.getNodeByUUID=function o(t,e){var n;if(e)for(var i=0;i<e.length&&(e[i].componentContentId===t||e[i].uuid===t?n=e[i]:e[i].children&&e[i].children.length&&(n=o(t,e[i].children)),!n);i++);else _.forEach(c.canvases,function(e){return e.componentContentId===t||e.uuid===t?(n=e,!1):!(n=o(t,e.children))&&void 0});return n},c.getParents=function e(o,t){if(t.uuid===o)return[t];var n=[];if(t.children)for(var i=0;i<t.children.length;i++){var r=t.children[i];n=n.concat(e(o,r))}0<n.length&&(n.push(t),n[0].uuid===o&&n.shift());return n},c.getNodeData=p,c.getNodesData=function(e,n){var i={};_.isArray(e)||(e=[e]);return e.forEach(function(e){!function o(e,t){_.set(i,e.uuid,p(e,n)),!_.isUndefined(e.children)&&_.isArray(e.children)&&_.forEach(e.children,function(e){o(e,t)})}(e,c.canvasData.model)}),i},c.initModelMapper=function(e){_.merge(c.canvasData.model,e.model),_.merge(c.canvasData.mapper,e.mapper),_.merge(c.canvasData.previewModel,e.previewModel),_.merge(c.canvasData.variableFields,e.variableFields),_.merge(c.canvasData.meta,e.meta)},c.setNodeModel=u,c.setComponentContentModel=function(e,o){_.set(c.canvasData,["model",e],o)},c.setLastModifiedEl=function(e){_.set(c.data,["lastModified","uuid"],e.uuid)},c.initComponentNode=function(r){return c.setNodeStatus(r,"loading",!0),n.get("/cohesionapi/cohesion-components",{params:{"uids[]":r.componentId}}).then(function(e){var o=_.get(e,r.componentId);r.children=_.isArray(r.children)?r.children:[];for(var t,n=function e(o,t,n){n=n||[];o=o||[];for(var i=0;i<o.length;i++)"component-drop-zone-placeholder"===o[i].uid?n.push(o[i]):n=e(o[i].children,t,n);return n}(o.canvas,o.model),i=0;i<n.length;i++)r.children.push((t=n[i],o.model,{type:"container",uid:"component-drop-zone",mimicParent:!0,parentUid:t.parentUid,title:t.title,selected:!1,children:[],status:{collapsed:!1,disabled:!1},uuid:l.getUUID(),dropzoneId:t.uuid,isContainer:!0})),c.setNodeState(r,"collapsed",!1);h(r);for(i=r.children.length-1;0<=i;i--)u(r.children[i],o.model[r.children[i].dropzoneId]);r.componentContentId||(e=a.getDefaultModel(o),u(r,e)),c.setNodeStatus(r,"loading",!1)})},c.selectNode=function(e,o,t){_.get(c.nodeStatus,[o.uuid,"selected"])?c.data.selected.top=t:(c.setNodeStatus(o,"selected",!0),c.data.selected.top=t,c.data.selected.layoutCanvasKey=e,c.data.selected.model=o,r(function(){c.data.selected.element=d(o),c.data.selected.type=m(o)}))},c.deleteNode=function(e,o,t){t.children.splice(o,1),_.deepMap(e,function(e,o){"uuid"===o&&(_.get(c.nodeStatus,[e,"selected"])&&c.deSelectAllNodes(),void 0!==c.nodeStatus[e]&&delete c.nodeStatus[e],delete c.canvasData.mapper[e]),"uuid"!==o&&("componentContentId"!==o||c.getNodeByUUID(e))||(_.get(c.canvasData.model,[e,"settings","machineName"])&&l.removeFromList(_.get(c.canvasData.model,[e,"settings","machineName"])),delete c.canvasData.model[e],delete c.canvasData.previewModel[e],delete c.canvasData.variableFields[e])},"children")},c.setNodeStatus=function(e,o,t){if(void 0===e)throw"Pass a node with a uuid or a uuid!";var n="string"==typeof e?e:e.uuid;if(void 0===n)throw"Pass a node with a uuid.";switch(o){case"disabled":case"collapsed":throw"Set disabled and collapsed using CohLayoutCanvas.setState not setStatus.";case"modified":case"edited":t?(_.set(c.nodeStatus,[n,"error"],!1),_.set(c.nodeStatus,[n,"modified"],!0)):_.set(c.nodeStatus,[n,"modified"],!1);break;case"selected":t?(c.deSelectAllNodes(),c.setNodeState(e,"collapsed",!1),_.set(c.nodeStatus,[n,"selected"],!0)):c.c();break;case"previewHighlighted":var i=c.getNodeByUUID(n);_.get(i,"status.collapsedParents")&&i.status.collapsedParents.length?_.forEach(i.status.collapsedParents,function(e){c.setNodeStatus(e,"previewHighlightedParent",t)}):_.set(c.nodeStatus,[n,o],t);break;case"error":case"loading":case"new":case"ellipsisOpen":case"previewHighlightedParent":case"breakpointClasses":_.set(c.nodeStatus,[n,o],t);break;default:throw"Cannot set unknown status property: "+o+" to "+t+"."}},c.setNodeState=function(e,o,t){if(void 0!==t){var n="string"==typeof e?c.getNodeByUUID(e):e;switch(o){case"disabled":_.set(n,["status",o],t);case"collapsed":_.set(n,["status",o],t),n.children&&n.children.length&&(t?c.recurseNodes(n.children,function(e){_.set(e,["status","collapsedParents",0],n.uuid)}):c.recurseNodes(n.children,function(e){_.pull(_.get(e,"status.collapsedParents"),n.uuid)}));break;default:throw"Cannot set unknown state property: "+o+" to "+t+"."}}},c.deSelectAllNodes=function(){c.data.selected.element&&(c.data.selected.model="",c.data.selected.element="",c.data.selected.layoutCanvasKey=[],c.data.selected.top=!1,c.data.selected.type="");_.forEach(c.nodeStatus,function(e){e.selected=!1})},c.recurseNodes=function e(o,t){var n=[];"function"==typeof t?n.push(t):n=t;var i=[];_.isArray(o)?i=o:o.children&&(i=o.children);for(var r=i.length-1;0<=r;r--){for(var a=i[r],l=0;l<n.length;l++)"function"==typeof n[l]&&n[l](a,r,o);a.children&&a.children.length&&e(a,t)}},c.setNodeIsContainer=h,c.initModelDirtyWatcher=function(){c.runOnce&&(c.runOnce=!1,c.watchModel=t.$watch(function(){return angular.toJson({data:c.canvasData,canvases:c.canvases})},function(e,o){e!==o&&(t.$emit("layoutCanvasDirty"),c.watchModel())}))},c.removeDeletedComponents=function(e,o){_.isArray(o)&&o.forEach(function(e){var o=e.title,e=e.componentContentId?"component content":"component";i.notify({content:"The "+e+' "'+o+'" has been removed from the layout canvas because it no longer exists.',className:"warning"})})},c.initNewItem=function(e){var i,r,a,l,o=_.cloneDeep(e),e=c.getSelected();return o.parentUid=e.model.uid||"root",delete o.parentIndex,"helper"===o.type?n.get("/cohesionapi/cohesion-helper-updated/"+o.uid).then(function(e){var o=e.layoutCanvas;return i=o.model,r=o.mapper,a=o.previewModel,l=o.variableFields,{newItems:function e(o){for(var t=[],n=0;n<o.length;n++)c.setElementUUID(o[n],i,r,a,l),delete o[n].parentIndex,c.setNodeIsContainer(o[n]),o[n].children&&e(o[n].children),t.push(o[n]);return t}(o.canvas),deletedItems:e.deletedComponents}}):("component-content"===o.type&&(o.type="component"),void 0!==o.preview_image&&delete o.preview_image,c.setElementUUID(o),c.setNodeIsContainer(o),o.componentId&&c.initComponentNode(o),s.when({newItems:[o]}))},c.insertAndInitElements=function(e,t,n,i){_.forEach(e,function(e,o){0<=n?t.splice(n+o,i&&0===o?1:0,e):t.push(e),c.setNodeStatus(e,"new",!0),c.setLastModifiedEl(e)})},c.setElementUUID=function(t,e,o,n,i){{var r,a;t.uuid&&0!==t.uuid.indexOf("placeholder")?(r=l.getUUID(),a={model:e,mapper:o,previewModel:n,variableFields:i},Object.keys(a).forEach(function(e){var o=_.get(a[e],t.uuid)||_.get(c.canvasData,[e,t.uuid]);o&&("form-field"!==t.type&&"form-field-container"!==t.type||!_.get(o,"settings.machineName")||(l.findByMachineName(o.settings.machineName)?_.unset(o,"settings.machineName"):l.addToList(t.uuid,o.settings.machineName)),_.set(c.canvasData,[e,r],angular.copy(o)),a[e]||delete _.get(c.canvasData,[e])[t.uuid])}),t.uuid=r):(t.uuid=l.getUUID(),"container"!==t.type&&"item"!==t.type||_.set(c.canvasData,["mapper",t.uuid],{}),t.model&&(_.isArray(t.model)&&(t.model={}),_.set(c.canvasData,["model",t.uuid],angular.copy(t.model)),delete t.model))}},c.elementValidation={},c.canvases={},c.canvasData={model:{},mapper:{},previewModel:{},variableFields:{},meta:{}},c.nodeStatus={},c.data={selected:{model:{},element:"",target:"",top:!1,type:""},lastModified:{},status:{selected:"coh-layout-canvas-list-item-selected",error:"coh-layout-canvas-list-item-error",edited:"coh-layout-canvas-list-item-edited",active:"coh-is-active"}},c.runOnce=!0,e.get("element_validation.element_validation").then(function(e){c.elementValidation=e})}e.$inject=["$rootScope","cohApiSvc","cohFormBuilderRenderSvc","ajaxSvc","notificationSvc","cohUUID","$timeout","$q"],angular.module("cohesionApp").service("CohLayoutCanvas",e)}(),function(){function $cohModal($uibModal,$cookies,$q){var svc=this;svc.showModal=showModal;var deferred=$q.defer(),modalDefaults={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"views/modals/coh-modal.html",windowClass:"coh-modal",backdropClass:"coh-modal-backdrop",openedClass:"coh-modal-open"},modalOptions={closeButtonText:"Cancel",actionButtonText:"OK",headerText:"Confirmation",bodyText:"Are you sure you want to remove this item? You will lose any values you've added.",showSuppression:!1,forceSuppress:!1,suppressionLabel:"Don't show this message again.",suppressionCookieKey:"coh.suppressModal",suppressionCookieValue:!0,backdropClass:"coh-modal-backdrop",model:{suppress:0}};function showModal(e,o){return(e=e||{}).backdrop="static",show(e,o,$cookies,$q)}function show(customModalDefaults,customModalOptions,$cookies){var tempModalDefaults={},tempModalOptions={};return angular.extend(tempModalDefaults,modalDefaults,customModalDefaults),angular.extend(tempModalOptions,modalOptions,customModalOptions,{model:{suppress:0}}),tempModalOptions.forceSuppress||!0===tempModalOptions.showSuppression&&void 0!==$cookies.get(tempModalOptions.suppressionCookieKey)?(deferred.resolve(tempModalOptions.model),{result:deferred.promise}):(tempModalDefaults.controller||(tempModalDefaults.controller=["$scope","$uibModalInstance","$cookies",function($scope,$uibModalInstance,$cookies){$scope.modalOptions=tempModalOptions;try{$scope.modalOptions.bodyText=eval($scope.modalOptions.bodyText)}catch(e){$scope.modalOptions.bodyText=$scope.modalOptions.bodyText}$scope.modalOptions.ok=function(){!0===$scope.modalOptions.showSuppression&&1===$scope.modalOptions.model.suppress&&$cookies.put($scope.modalOptions.suppressionCookieKey,$scope.modalOptions.suppressionCookieValue,{path:"/",samesite:"strict"}),"function"==typeof tempModalOptions.onBeforeOk&&!tempModalOptions.onBeforeOk($scope)||$scope.modalOptions.form&&($scope.$broadcast("schemaFormValidate"),!$scope.modalOptions.schemaForm.$valid)||$uibModalInstance.close(this.model)},$scope.modalOptions.close=function(){"function"==typeof tempModalOptions.onBeforeCancel&&!tempModalOptions.onBeforeCancel($scope)||$uibModalInstance.dismiss("cancel")}}]),$uibModal.open(tempModalDefaults))}}$cohModal.$inject=["$uibModal","$cookies","$q"],angular.module("cohesionApp").service("$cohModal",$cohModal)}(),function(){function e(n){var e=this;e.setValue=function(e,o){var t=!0;i[e]?(_.isEqual(i[e].mValue,o)&&(t=!1),i[e].mValue=angular.copy(o)):i[e]={mValue:angular.copy(o),hnUpdated:function(){}};t&&n.$broadcast("cmmUpdated"+e)},e.getValue=function(e){return i[e]?i[e].mValue:void 0},e.watchValue=function(e,o){i[e]||this.setValue(e,void 0);i[e].hnUpdated(),i[e].hnUpdated=n.$on("cmmUpdated"+e,function(){o(i[e].mValue)})},e.setAndWatch=function(e,o,t){this.setValue(e,o),this.watchValue(e,t)},e.destroyValue=function(e){i[e]&&(i[e].hnUpdated(),delete i[e])},e.destroyAll=function(){i={}};var i={}}e.$inject=["$rootScope"],angular.module("cohesionApp").service("cohModelManager",e)}(),function(){function e(t,e){return e.onbeforeunload=function(e){var o={};if(t.$broadcast("onBeforeUnload",o).defaultPrevented)return o.message},e.onunload=function(){t.$broadcast("onUnload")},{}}e.$inject=["$rootScope","$window"],angular.module("cohesionApp").factory("beforeUnload",e).run(["beforeUnload",function(e){}])}(),function(){function e(e,o,t){var n=this;n.removeRestrictedElementBrowserTabs=function(e){for(var o=[],t=0;t<e.length;t++)a(e[t])&&o.push(e[t]);return o},n.hasPermission=r,n.isPermittedByTabName=a,n.hasAllPermissions=function(e){var o=!0;e=e||[];for(var t=0;t<e.length;t++)if(!r(e[t]))return o=!1;return o},n.hasAnyPermission=function(e){var o=!1;e=e||[];for(var t=0;t<e.length;t++)if(r(e[t]))return o=!0;return o},n.canEditNode=function(e){var o=!0;(!e||"component"===e.type&&e.componentContentId&&!r("administer component content"))&&(o=!1);o||t.notify({className:"danger coh-permission-error",content:"Sorry, you don't have permission to edit this."});return o};var i={Components:"access components","Component content":"access component content",Elements:"access elements",Helpers:"access helpers",Analytics:"access analytics","Context visibility":"access context visibility",SEO:"access seo",Styles:"access styles","Open token browser":"access tokens","Toggle variable mode":"access tokens",Markup:"access markup","Animate on view":"access animate on view","Hide if no data":"access hide no data"};function r(e){return-1!==n.permissions.indexOf(e)}function a(e){return!i.hasOwnProperty(e)||r(i[e])}n.permissions=o.settings.cohesion.permissions}e.$inject=["uuid","drupalSvc","notificationSvc"],angular.module("cohesionApp").service("cohPermissionService",e)}(),function(){function e(t){var n=this;function i(e){return r(e).data("pickerInstanceId")}function r(e){var o=e.closest("form");return o=!o.length?e.closest("[form]"):o}n.setPicker=function(e,o){o=i(o);n.states[o].picker=e,n.states[o].updateFn(e,o)},n.resetPicker=function(e){n.states[e].currentPicker=null},n.addBlade=function(e,o){n.states[i(o)].addBladeFn(e)},n.registerUpdateFunction=function(e,o){n.states[o].updateFn=e},n.registerAddBladeFunction=function(e,o){n.states[o].addBladeFn=e},n.createInstance=function(e){var o=r(e),e=t.getUUID();return o.data("pickerInstanceId",e),n.states[e]=angular.copy(n.state),e},n.destroyInstance=function(e,o){e=r(e);o=o||e.data("pickerInstanceId",o);delete n.states[o],e.removeData("pickerInstanceId")},n.state={currentPicker:null,updateFn:function(){},addBladeFn:function(){}},n.states={}}e.$inject=["cohUUID"],angular.module("cohesionApp").service("cohPickerSvc",e)}(),function(){function e(r,a,l){var m=this;m.save=function(e){var o,t,n,d;if(_.isArray(e)){if(!e.length)return void l.notify({content:"You cannot save an empty layout canvas.",className:"danger"});d=0===e[0].type.indexOf("form-")?"form":"layout"}else d=0===e.type.indexOf("form-")?"form":"layout";o=_.cloneDeep(e),t=r.getNodesData(o,"model"),n=r.getNodesData(o,"previewModel"),i=r.getNodesData(o,"mapper"),e=r.getNodesData(o,"variableFields");var i={canvas:_.isArray(o)?o:[o],model:t||{},previewModel:n||{},variableFields:e||[],mapper:i||{}};m.elementBlock={label:"",type:"",category:"",status:!0,json_values:JSON.stringify(i)},m.saveModal=a.open({templateUrl:"scripts/directives/coh-layout-canvas/coh-layout-canvas-save-modal.html",size:"md",windowClass:"coh-modal coh-layout-canvas-save-modal coh-draggable-modal",openedClass:"coh-layout-canvas-save-modal-open coh-modal-open",backdrop:"static",backdropClass:"coh-modal-backdrop coh-element-browser-backdrop",animation:!0,bindToController:!0,controllerAs:"csem",controller:["$scope","ajaxSvc","$uibModal","$cohModal","$cookies","CohLayoutCanvas","$uibModalInstance","notificationSvc","cohPermissionService",function(e,o,t,n,i,r,a,l,s){var c=this;c.form={bundle:"",schema:{properties:{cohesion:{type:"object"}}},form:[],model:{},mapper:{}};o.get("/cohesionapi/element/layout_canvas").then(function(e){e=e.save_element_modal,c.form.schema=e.schema,c.form.form=e.form;var o="1.items.0.items.0.options";s.hasPermission("administer helpers")||(_.get(c.form.form,o).splice(0,1),e.model.type="component"),s.hasPermission("administer components")&&"form"!==d||_.get(c.form.form,o).splice(1,1),_.defaultsDeep(c.form.model,e.model)}).finally(function(){c.loaded=!0}),e.$on("sf-render-finished",function(){c.form.loaded=!0}),c.saveBlock=function(){m.elementBlock.label=c.form.model.title,m.elementBlock.type=c.form.model.type,m.elementBlock.category=c.form.model.category,o.post("/cohesionapi/element-save",m.elementBlock).then(function(){var e={className:"success success-canvas element-block-save",content:"New "+c.form.model.type+" saved."};l.notify(e)}),a.close(c.model)}}]})}}e.$inject=["CohLayoutCanvas","$uibModal","notificationSvc"],angular.module("cohesionApp").service("cohSaveElementSvc",e)}(drupalSettings),angular.module("cohesionApp").service("cohSchemaFormSvc",function(){var e=this;e.getOptions=function(){return o},e.setGlobalDestroyStrategy=function(e){return o[t]=e},e.setFieldDestroyStrategy=function(e,o){return _.set(e,[t],o)},e.getGlobalDestroyStrategy=function(){return o[t]},e.getFieldDestroyStrategy=function(e){return _.get(e,[t])};var t="destroyStrategy",o={destroyStrategy:"remove"}}),function(){function e(e,o){var t=this;function n(e){window.scrollTo(0,e||t.scrollPos)}function i(e){t.scrollPos=e||window.scrollY}function r(e){e.preventDefault()}t.scrollPos=0,t.scrollTo=n,t.savePos=i,t.scrollToIfMobile=function(e){angular.element(window).width()<768&&n(e)},t.savePosIfMobile=function(e){angular.element(window).width()<768&&i(e)},t.stopBodyScrolling=function(e){var o;!0===e?(o=document.getElementsByClassName("coh-modal-backdrop"),[].forEach.call(o,function(e){e.addEventListener("touchmove",r,!1)})):(o=document.getElementsByClassName("coh-modal-backdrop"),[].forEach.call(o,function(e){e.removeEventListener("touchmove",r,!1)}))}}e.$inject=["$uibModal","CohLayoutCanvas"],angular.module("cohesionApp").service("cohScrollPosSvc",e)}(),function(){function e(e,o,t,n,i){this.updateFrameCss=function(){return i.$broadcast("coh:newCSSLoading",{}),o.broadcastXtabs("newCSSLoading",{}),e.http({method:"POST",url:"/cohesionapi/style-guide/preview",headers:{"Content-Type":"application/json"},data:JSON.stringify(n.state.model)}).then(function(e){return o.broadcastXtabs("newCSS",{scope:window.location.pathname,data:e}),i.$broadcast("coh:newCSS",{data:e}),e})},this.state={scale:1,autoScaleOn:!0,columnWidth:12,boxedWidth:!1,colorModel:{value:{hex:"#ffffff",rgba:"rgba(255, 255, 255, 1)"}}}}e.$inject=["ajaxSvc","cohBroadcastSvc","CohLayoutCanvas","formStateSvc","$rootScope"],angular.module("cohesionApp").service("cohSgmPreviewSvc",e)}(),function(l,s){function e(n,o){function r(e,o){if(o.isCustom)return!0;var t=_.get(e,"dataset.uid"),o=n.getType(o);return!!_.includes(n.elementValidation.universal,o)||(_.get(e,"dataset.mimicparent")&&(t=_.get(e,"dataset.parentuid")),!_.isArray(n.elementValidation[t])||_.includes(n.elementValidation[t],o))}function a(e,o){return e.valid?o.removeClass("coh-invalid-drop"):o.addClass("coh-invalid-drop"),e.showPlaceholder?o.removeClass("coh-hide-placeholder"):o.addClass("coh-hide-placeholder"),e}this.validateDropZone=function(e,o){var t={valid:!0,showPlaceholder:!0,message:""},n=o.item.sortable.droptarget||l(e.target),i=n.sortable("instance");if(!n.hasClass("coh-layout-canvas-list-dropzone")||n.hasClass("coh-sortable-disabled")||!r(n[0],o.item.sortable.model))return t.valid=!1,t.showPlaceholder=!1,n.hasClass("coh-layout-canvas-root")&&"component_content"===s.cohesion.entityTypeId?t.message="You cannot add elements outside <br/>of the component content.":t.message="You cannot add this element here.",a(t,n);e=_.get(i,"options.layoutOptions.allowedElements")||[];if(e.length&&-1===e.indexOf(o.item.sortable.model.uid))return t.valid=!1,t.message="You can not add this element here.",a(t,n);return function(e,o){var t=e.type;"helper"===t&&(t=e.helperType);o=o.type;if("canvas"===o){if(0===t.indexOf("form-"))return!1}else if("form-canvas"===o&&0!==t.indexOf("form-"))return!1;return!0}(o.item.sortable.model,i.options)||(t.valid=!1,t.message="This element can not be added to this canvas."),a(t,n)},this.reportFailedDrop=_.debounce(function(e){o.notify({content:e,className:"warning"})},500,{leading:!0,trailing:!1}),this.validateRestrictions=r}e.$inject=["CohLayoutCanvas","notificationSvc"],angular.module("cohesionApp").service("cohSortableValidation",e)}(jQuery,drupalSettings),angular.module("cohesionApp").service("cohSuspendSvc",["$rootScope",function(n){return{subscribe:function(e,o,t){o=n.$on("suspend-watchers",o);e.$on("$destroy",o);t=n.$on("resume-watchers",t);e.$on("$destroy",t)},suspendWatchers:function(){n.$emit("suspend-watchers")},resumeWatchers:function(){n.$emit("resume-watchers")}}}]),function(s,c){function e(o,n,i){var r=this;function a(){var t=_.get(c,"behaviors.tokenInsert.attach"),e=o(function(){l(!0),r.$form=s("form.coh-form"),r.$form.length&&(r.$form.off(".cohTokenSvc").on("focus.cohTokenSvc","[type=cohTextbox], [type=text], [type=email], [type=number], [type=search], [type=url], textarea",function(){n.settings.tokenFocusedField=this}),c.behaviors.tokenInsert={attach:function(e,o){"function"==typeof t&&t(e,o),s(".token-click-insert .token-key a",e).once("token-click-insert-event").click(function(){var e;n.settings.tokenFocusedField&&("createEvent"in document?((e=document.createEvent("HTMLEvents")).initEvent("change",!1,!0),n.settings.tokenFocusedField.dispatchEvent(e)):n.settings.tokenFocusedField.fireEvent("onchange"))})}},o.cancel(e))},500)}function l(e){r.$form.length&&(r.$form.off(".cohTokenSvc"),r.$form=s()),e||(n.settings.tokenFocusedField=void 0)}r.openDrupalDialog=function(e,o){var t=_.get(drupalSettings,o),o={container:".coh-layout-canvas-settings .modal-header-nav h1",progress:{type:"cohinline"}};t&&(o.url=t);o.dialog={dialogClass:"token-tree-dialog coh-token-tree-dialog",draggable:!0,autoResize:!1},0===r.$form.length&&a();return i.openDialog(o)},r.applyListener=a,r.removeListener=l,r.$form=s()}e.$inject=["$interval","drupalSvc","drupalDialog"],angular.module("cohesionApp").service("cohTokenSvc",e)}(jQuery,Drupal),function(){function e(e){this.getUUIDList=function(){return n},this.addToList=function(e,o){var t=e.uuid,e=e.uid;_.find(n,["uuid",t])?_.find(n,["uuid",t]).machineName=o:n.push({uuid:t,type:e,machineName:o});return _.findIndex(n,["uuid",t])},this.removeFromList=function(e){n.splice(_.findIndex(n,["machineName",e]),1)},this.getUUID=function(){return e.v4()},this.isUUID=function(e,o){e=e.replace(o,"");return null!==e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i)},this.machineToUUID=function(e){"string"==typeof e&&(e=e.replace(/\[field\.([-_a-zA-Z0-9]+)\]/gi,function(e,o){o=_.find(n,["machineName",o]);return o?"[field."+o.uuid+"]":e}));return e},this.UUIDtoMachine=function(e){"string"==typeof e&&e.length&&(e=e.replace(/\[field.([\w-]+)\]/g,function(e,o){o=_.find(n,["uuid",o]);return o?"[field."+o.machineName+"]":e}));return e},this.findByMachineName=function(e){return _.find(n,["machineName",e])},this.getRaw=function(e){return/\[field.([\w-]+)\]/g.exec(e)[1]};var n=[]}e.$inject=["uuid"],angular.module("cohesionApp").service("cohUUID",e)}(),angular.module("cohesionApp").service("cohVarSvc",function(){this.valueContainsVariable=function(e){return"string"==typeof e&&/(\{{2}.*?[:a-zA-Z0-9_-].*?\}{2})|(\[(?!.*media-reference).*\])/g.test(e)},this.isValueVariable=function(e){return"string"==typeof e&&/(^\{{2}.*?[:a-zA-Z0-9_-].*?\}{2}$)|(^\[(?!.*media-reference).*\]$)/g.test(e)}}),function(e){function o(o){this.openDialog=function(e){return o.drupal.ajax(_.defaultsDeep(e,t)).execute()};var t={url:"",event:"click",dialogType:"dialog",progress:{type:"fullscreen"},dialog:{width:600,height:400,position:{my:"center left"},draggable:!(Drupal.Ajax.prototype.setProgressIndicatorCohinline=function(){this.progress.element=e('<div class="coh-is-loading coh-preloader-inline coh-preloader-x-small"></div>'),e(this.container).after(this.progress.element)}),autoResize:!0}}}o.$inject=["drupalSvc"],angular.module("cohesionApp").service("drupalDialog",o)}(jQuery),function(e,t){angular.module("cohesionApp").service("drupalSvc",function(){var o=this;this.getBasePath=function(){return o.settings.restfulExample.basePath},this.getCsrfToken=function(){return o.settings.restfulExample.csrfToken},this.getData=function(e){return o.settings.restfulExample.data[e]||{}},this.drupal=e,this.settings=t,this.cohesionSettings=t.cohesion})}(Drupal,window.drupalSettings),function(u){function e(t,n,e){var i,r,o,a,l,s=this;function c(){n(function(){return r.toolbarHeight=i.attributes.height+"px",r.toolbarHeight})}function d(){return _.get(i,"attributes.height")}function m(e,o){e!==o&&(i.set("toolbarHeight",e),r.toolbarHeight=e,a.css("paddingTop",e))}function p(e){u(".cohesion-style-builder-edit-form .schema-form-section.row>sf-decorator:first-child").css({top:e+5+"px"}),u(".cohesion-style-builder-edit-form .coh-style-builder-container .coh-actions-bar").css({top:e+"px"})}s.getToolbarOrientation=function(){return r.orientation},s.updateToolbarHeight=c,s.getToolbarHeight=d,s.setToolbarHeight=m,s.getToolbarState=function(){return r.toolbarState},s.getToolbarPosition=function(){return l?window.getComputedStyle(l).getPropertyValue("position"):0},s.getOrientationToggle=function(){return u(u.parseHTML(e.drupal.theme("toolbarOrientationToggle"))).find("button")},s.getToolbarZindex=function(){return l?parseInt(window.getComputedStyle(l).getPropertyValue("z-index")):0},s.toggleState=function(){i.set("activeTab",null),i.set("activeTray",null)},s.toggleOrientation=function(){var e=this.getToolbarOrientation(),o="vertical"===e?"horizontal":"vertical";i.set("locked","vertical"!==e),i.set("orientation",o),i.trigger("change:orientation",i,o)},e.drupal.toolbar&&(i=e.drupal.toolbar.models.toolbarModel,r={orientation:i.attributes.orientation,toolbarHeight:i.attributes.height,toolbarState:!_.isNull(i.attributes.activeTray)},o=u(document),a=u("body"),l=document.getElementById("toolbar-bar"),o.on("drupalToolbarOrientationChange",function(e,o){s.setToolbarHeight(),r.orientation=o,n(function(){t.$apply()})}),o.on("drupalToolbarTabChange",function(){m(),r.toolbarState=!_.isNull(i.attributes.activeTray),n(function(){t.$apply()})}),o.on("drupalToolbarTrayChange",function(){m(),r.toolbarState=!_.isNull(i.attributes.activeTray),n(function(){t.$apply()})}),t.$watch(function(){return a.css("paddingTop")},function(e,o){e!==o&&c()}),u(".cohesion-style-builder-edit-form").length&&(t.$watch(d,function(e,o){e!==o&&(c(),p(e))}),t.$on("coh-style-builder-rendered",function(){p(d())})))}e.$inject=["$rootScope","$timeout","drupalSvc"],angular.module("cohesionApp").service("cohDrupalToolbar",e)}(jQuery),function(n){angular.module("cohesionApp").service("formStateSvc",function(){var t=this;function o(){_.each(t.variableWatchers,function(e){e()})}t.toggleVariableMode=function(e){t.state.variableMode=void 0!==e?e:!t.state.variableMode,o()},t.runVariableWatchers=o,t.toggleAccordions=function(){t.state.accordionsOpen=!t.state.accordionsOpen},t.registerVariableWatcher=function(e){t.variableWatchers.push(e)},t.deregisterVariableWatcher=function(o){_.remove(t.variableWatchers,function(e){return e===o})},t.getGradientPickerKey=function(){return t.state.gradientPickerKey++,t.state.gradientPickerKey},t.registerBreakpoint=function(e){t.state.breakpointKey++,t.state.breakpoints[t.state.breakpointKey]=e},t.deregisterBreakpoint=function(){delete t.state.breakpoints[t.state.breakpointKey]},t.initXssDisabledFields=function(e){if(n.xss_paths)for(var o in t.state.xssDisabledFields=[],n.xss_paths)e===o.split(".")[0]&&t.state.xssDisabledFields.push(o.split(".").slice(1).join("."))},t.getCleanMapper=function(){return t.state.mapper},t.state={submitting:!1,variableMode:!1,helperMode:!1,gradientPickerKey:0,breakpointKey:0,accordionsOpen:!0,mapper:{},model:{},variableModeModel:{},previewModel:{},variableFields:[],xssDisabledFields:[],initialMapper:void 0,currentLevelLabel:"",currentLevel:[],toggleActiveFn:null},t.variableWatchers=[],t.variableModeAvailable=!1,t.helperWatchers=[],t.scrollbarUpdateFns=[]})}(drupalSettings.cohesion),function(b){function e(g,v){this.gradX=function(e,u){var h=e,f={rand_RGB:[],rand_pos:[],id:null,slider_ids:[],slider_index:0,sliders:[],linear:{direction:90},radial:{horizontal:"center",vertical:"center",size:"farthest-corner"},type:"linear",slider_hovered:[],jQ_present:!0,code_shown:!1,change:angular.noop,get_random_position:function(){for(var e;e=parseInt(100*Math.random()),-1<this.rand_pos.indexOf(e););return this.rand_pos.push(e),e},get_random_rgb:function(){for(var e;e="rgb("+parseInt(255*Math.random())+", "+parseInt(255*Math.random())+", "+parseInt(255*Math.random())+")",-1<this.rand_RGB.indexOf(e););return this.rand_RGB.push(e),e},apply_style:function(e,o,t){var n="linear"===f.type?"linear":"radial",i="",i=0===o.indexOf("rgb")?o:n+"-gradient("+o+")",o="";e.css("background",i),o+="background: "+i+";\n",this.change(this.sliders,i),t?b(h+" #gradx_code").html(""):b(h+" #gradx_code").html(o)},apply_default_styles:function(){this.update_style_array();var e=this.get_style_value();this.apply_style(this.panel,e)},update_style_array:function(){this.sliders=[];for(var e,o,t=f.slider_ids.length,n=0;n<t;n++)o="#"+f.slider_ids[n],e=parseInt(b(o).css("left")),e-=10,e=parseInt(e/f.container_width*100),f.sliders.push([b(o).css("background-color"),e]);this.sliders.sort(function(e,o){return e[1]>o[1]?1:-1})},update_gradient_picker:function(){f.update_style_array();var e=this.get_style_value();f.apply_style(this.panel,e)},get_style_value:function(){var e=f.slider_ids.length;if(1===e)o=this.sliders[0][0];else{for(var o="",t="",n=0;n<e;n++)""===this.sliders[n][1]?o+=t+this.sliders[n][0]:(100<this.sliders[n][1]&&(this.sliders[n][1]=100),o+=t+(this.sliders[n][0]+" "+this.sliders[n][1])+"%"),t=" , ";o="linear"===this.type?this.get_linear_direction(this.linear.direction)+" , "+o:this.type+" "+this.radial.size+" at "+this.radial.horizontal+" "+this.radial.vertical+" , "+o}return o},get_linear_direction:function(e){switch(e){case"left":return"90deg";case"top":return"0deg";default:return"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/)?isNaN(e)?"90deg":e+"deg":e}},get_rgb_obj:function(e){return 3<(e=(e=(e=e.split("("))[1]).split(",")).length?{r:parseInt(e[0]),g:parseInt(e[1]),b:parseInt(e[2]),a:f.toFixed(parseFloat(e[3]),2)}:{r:parseInt(e[0]),g:parseInt(e[1]),b:parseInt(e[2])}},toFixed:function(e,o){o=o||0;var t=Math.pow(10,o),n=Math.abs(Math.round(e*t)),e=(e<0?"-":"")+String(Math.floor(n/t));return 0<o&&(t=String(n%t),e+="."+new Array(Math.max(o-t.length,0)+1).join("0")+t),parseFloat(e)},load_info:function(e){var o="#"+e.id;this.current_slider_id=o,-1<this.slider_ids.indexOf(e.id)&&(e=b(o).css("backgroundColor"),e=this.get_rgb_obj(e),o=b(o).css("left"),b(h+" #gradx_slider_info").css("left",o).show(),this.set_colorpicker(e))},delete_slider:function(e){this.current_slider_id=e,b("#"+f.current_slider_id).remove(),e=f.current_slider_id.replace("#","");for(var o=0;o<f.slider_ids.length;o++)f.slider_ids[o]===e&&f.slider_ids.splice(o,1);f.update_style_array(),0===f.sliders.length?f.apply_style(f.panel,f.get_style_value(),!0):f.apply_style(f.panel,f.get_style_value()),f.current_slider_id=!1},add_slider:function(e,o){var t,n,i,r,a=e=0===e.length?[{color:"rgb(255, 255, 255)",position:1},{color:"rgb(0, 0, 0)",position:100}]:e;for(i in o&&(this.sliders=[]),a){if(void 0===a[i].position)break;r=1===a[i].position?0:parseInt(a[i].position*this.container_width/100),r+=15,r+="px",t=this.id+"gradx_slider_"+this.slider_index,this.sliders.push([a[i].color,a[i].position,t]),this.slider_ids.push(t),n="<div class='gradx_slider' id='"+t+"'>",n+="<div class='clickable-box'  ng-click='addColourPickerBlade($event);$event.stopPropagation()' id='"+t+"'></div>",n+="<span ng-click=\"deleteSlider('"+t+"', $event)\"  class='coh-icon-cancel-circle delete-slider-icon'></span>",n+="</div>",b("#gradx_start_sliders_"+this.id).append(n),b("#"+t).css("backgroundColor",a[i].color).css("left",r),o||g(b("#"+t))(u),this.slider_index++}function l(){f.jQ_present&&(f.current_slider_id="#"+b(this).attr("id"),b(f.current_slider_id+" .clickable-box").attr("no-click",""))}function s(){f.jQ_present&&(f.current_slider_id="#"+b(this).attr("id"),v(function(){b(f.current_slider_id+" .clickable-box").removeAttr("no-click")}))}function c(){f.update_style_array(),f.apply_style(f.panel,f.get_style_value());var e=b(f.current_slider_id).css("left");b(h+" #gradx_slider_info").css("left",e).show();e=b(f.current_slider_id).css("backgroundColor"),e=f.get_rgb_obj(e);f.cp.spectrum("set",e)}function d(){return f.load_info(this),!1}for(var m=0,p=this.slider_ids.length;m<p;m++)b("#"+this.slider_ids[m]).draggable({containment:"parent",axis:"x",handle:".clickable-box",start:l,stop:s,drag:c}).click(d)},set_colorpicker:function(e){f.cp.spectrum({move:function(e){!1!==f.current_slider_id&&(e=e.toRgbString(),b(f.current_slider_id).css("background-color",e),f.update_style_array(),f.apply_style(f.panel,f.get_style_value()))},change:function(){b(h+" #gradx_slider_info").hide()},preferredFormat:"hex",flat:!0,showAlpha:!0,color:e,clickoutFiresChange:!0,showInput:!0,showButtons:!1})},generate_options:function(e){for(var o=e.length,t="",n=0;n<o;n++){var i=e[n];t+="<option value="+i.value+" "+i.state+">"+i.name+"</option>"}return t},generate_radial_options:function(){var e=[{name:"Horizontal center",state:"disabled"},{name:"Center",state:"selected",value:"center"},{name:"Left",value:"left"},{name:"Right",value:"right"}];this.els.$radial_horizontal.html(f.generate_options(e)),this.els.$radial_vertical.html(f.generate_options([{name:"Vertical center",state:"disabled"},{name:"Center",state:"selected",value:"center"},{name:"Top",value:"top"},{name:"Bottom",value:"bottom"}])),this.els.$radial_size.html(f.generate_options([{value:"gradient-size disabled",name:"Gradient size",state:"disabled"},{value:"farthest-corner",name:"Farthest corner"},{value:"farthest-side",name:"Farthest side"},{value:"closest-side",name:"Closest side"},{value:"closest-corner",name:"Closest corner"}]))},destroy:function(){var e,o={targets:[],sliders:[],direction:"left",code_shown:!1};for(e in o)f[e]=o[e]},set_type:function(){f.type=f.els.$type.val(),"linear"===f.type?(f.els.$linear_inputs.show(),f.els.$radial_inputs.hide()):(f.els.$linear_inputs.hide(),f.els.$radial_inputs.show())},bind_elements:function(){b(h+" #gradx_add_slider").on("click",function(){f.add_slider([{color:f.get_random_rgb(),position:f.get_random_position()}]),f.update_style_array(),f.apply_style(f.panel,f.get_style_value())}),b(h+" #gradx_delete_slider").on("click",function(){b(f.current_slider_id).remove(),b(h+" #gradx_slider_info").hide();for(var e=f.current_slider_id.replace("#",""),o=0;o<f.slider_ids.length;o++)f.slider_ids[o]===e&&f.slider_ids.splice(o,1);f.update_style_array(),f.apply_style(f.panel,f.get_style_value()),f.current_slider_id=!1}),this.els.$type.on("change",function(){f.set_type(),f.apply_style(f.panel,f.get_style_value()),f.apply_style(f.panel,f.get_style_value())}),this.els.$radial_horizontal.on("change",function(){f.radial.horizontal=f.els.$radial_horizontal.val(),f.apply_style(f.panel,f.get_style_value())}),this.els.$radial_vertical.on("change",function(){f.radial.vertical=f.els.$radial_vertical.val(),f.apply_style(f.panel,f.get_style_value())}),this.els.$radial_size.on("change",function(){f.radial.size=f.els.$radial_size.val(),f.apply_style(f.panel,f.get_style_value())}),this.els.$linear_direction.on("keyup",function(){_.set(f,"linear.direction",parseInt(f.els.$linear_direction.val())),f.apply_style(f.panel,f.get_style_value())})},load_gradx:function(e,o){this.me=b(e),this.id=e.replace("#",""),e=this.id,this.current_slider_id=!1,this.me.html("<div class='gradx'><div class='gradx_slectboxes'><select id='gradx_gradient_type' class='gradx_gradient_type'><option value='linear'>Linear</option><option value='circle'>Radial - Circle</option><option value='ellipse'>Radial - Ellipse</option></select><div class='gradx_linear_input input-group' style='display:none'><input id='gradx_linear_direction' type='number' class='form-control' /><span class='input-group-addon input-group-addon--right'>deg</span></div><select id='gradx_radial_horizontal' class='gradx_gradient_type gradx_radial_input coh-inline' style='display:none'></select><select id='gradx_radial_vertical' class='gradx_gradient_type gradx_radial_input coh-inline'  style='display:none'></select><select id='gradx_radial_size' class='gradx_gradient_type gradx_radial_input'  style='display:none'></select></div><div class='gradx_container' id='gradx_"+e+"'><div id='gradx_stop_sliders_"+e+"'></div><div class='gradx_panel' id='gradx_panel_"+e+"'></div><div class='gradx_start_sliders' id='gradx_start_sliders_"+e+"'><div class='cp-default' id='gradx_slider_info'><div id='gradx_slider_controls'><div id='gradx_delete_slider' class='gradx_btn'><i class='icon icon-remove'></i>delete</div></div><div id='gradx_slider_content'></div></div> </div></div><textarea class='gradx_code' id='gradx_code'></textarea><button type='button' id='gradx_add_slider' class='gradx_add_slider gradx_btn coh-btn coh-btn-alt'>Add</button></div>"),this.container=b("#gradx_"+e),this.panel=b("#gradx_panel_"+e),this.els={$type:b("#gradx_gradient_type",this.me),$linear_direction:b("#gradx_linear_direction",this.me),$radial_horizontal:b("#gradx_radial_horizontal",this.me),$radial_vertical:b("#gradx_radial_vertical",this.me),$radial_size:b("#gradx_radial_size",this.me),$radial_inputs:b(".gradx_radial_input",this.me),$linear_inputs:b(".gradx_linear_input",this.me)},this.container_width=255,this.add_slider(o,!0),f.generate_radial_options(),this.bind_elements(),this.els.$type.val(this.type),f.set_type(),f.apply_style(f.panel,f.get_style_value()),f.cp=b(h+" #gradx_slider_content"),f.set_colorpicker("blue")}};return b.extend(f,u.gradModel),f.load_gradx(e,f.sliders),f.apply_default_styles(),f}}e.$inject=["$compile","$timeout"],angular.module("cohesionApp").service("gradientPickerSvc",e)}(jQuery),function(){function e(o,i,n,a){var t=this;t.addBlade=function(e){t.menu.blades.length<3&&t.menu.blades.push(e)},t.rewriteConditions=s,t.addModelsToTree=function(e,i,o,r){var t;t=void 0===o?"styles":o.split(".")[0];(function o(e,t,n){n&&(t=t[n]),e.allowedTypes={child:["child","pseudo","modifier"],pseudo:["child","pseudo"],modifier:["child","pseudo","modifier"],prefix:["child","pseudo","modifier"]}[e.selectorType],"topLevel"===e.selectorType||e.uuid||(e.uuid=a.getUUID()),e.form||(e.form=angular.copy(i)),function(i,r){var a=r?r+".":"";i.isStyle&&(i.key=a+i.key),i.items&&0!==i.items.length&&_.each(i.items,function(e){!function o(e,t){var n;e.key||((t=t||null)||"cohBreakpointFieldset"===e.type&&(t=e.key[0]),e.isStyle&&(n=_.isArray(e.key),e.originalKeyValue?n&&(e.key=angular.copy([i.mapperKey]),r&&e.key.push(r),e.breakpointName&&e.key.push(["styles",e.breakpointName]),e.key=e.key.concat(e.originalKeyValue)):(e.originalKeyValue=angular.copy(e.key),n?(e.key=angular.copy([i.mapperKey]),r&&e.key.push(r),e.key=e.key.concat(e.key)):e.key=a+e.key))),e.items&&0!==e.items.length&&_.each(e.items,function(e){o(e,t)})}(e)})}(e.form,e.uuid),s(e.form,e.uuid,n),r||c(e.form,t),!_.get(t,[e.uuid||"styles"])&&e.uuid&&(n=angular.copy(l),"pseudo"===e.selectorType&&(n.settings.pseudo=e.title),"modifier"!==e.selectorType&&"prefix"!==e.selectorType||(n.settings.class=e.title),"child"===e.selectorType&&(n.settings.element=e.title),_.set(t,e.uuid,n)),e.items&&_.each(e.items,function(e){o(e,t)})})(_.get(n.state.mapper,t),e,o),d()},t.applyDefaultValues=c,t.updateCohArrays=d;var l={settings:{element:"",class:"",combinator:"",pseudo:""},styles:{}};function s(e,r,a){!function o(e,n){var i;n=n||null,"cohBreakpointFieldset"===e.type&&(n=e.key[0]),e.condition&&e.conditionVariables&&(e.originalCondition||(e.originalCondition=angular.copy(e.condition)),i=angular.copy(e.originalCondition),_.each(e.conditionVariables,function(e,o){var t=_.isArray(e)?e:e.split("."),e=["model"];a?e.push(a):e.push("styles"),r&&(e=e.concat(r)),n&&(e.push("styles"),e.push(n)),t=e.concat(t),i=i.split("$$"+o+"$$").join(t[0]+"['"+t.slice(1).join("']['")+"']")}),e.conditionShowInVariableMode&&(i+=" || varModeOrHasVariable('"+e.key.join(".")+"')"),e.condition=i,e.originalArrayCondition&&(e.originalArrayCondition=i)),_.each(e.items,function(e){o(e,n)}),_.each(e.originalArrayRow,function(e){o({items:e},n)})}(e)}function c(e,t){function n(e){var o;(_.isUndefined(e.condition)||i.$eval(e.condition,{model:t}))&&(void 0!==e.defaultValue&&(o=_.get(t,e.key),(_.isUndefined(o)||_.isNull(o))&&_.set(t,e.key,e.defaultValue)),_.each(e.items,function(e){n(e)}))}o(function(){(e.items||[]).forEach(n)})}function d(){_.each(t.cohArrayList,function(e){e.rewriteArrayKeys(!1),e.rewriteArrayConditions()})}t.menu={open:!1,blades:[]},t.cohArrayList=[],t.selectorIdKey=0,t.currentLevel=null,t.changeButtonTitle=null,t.changeFormFn=null}e.$inject=["$timeout","$rootScope","formStateSvc","cohUUID"],angular.module("cohesionApp").service("menuSvc",e)}(),function(){function e(o,t){this.notify=function(e){angular.element(".ng-toast").css("top",t.getToolbarHeight()+"px"),e=angular.extend({dismissOnTimeout:!0,dismissButton:!0,dismissButtonHtml:'<span class="visually-hidden">Dismiss alert</span>'},e),o.create(e)}}e.$inject=["ngToast","cohDrupalToolbar"],angular.module("cohesionApp").service("notificationSvc",e)}(),function(o){function e(h,f,g,v,b,y){var e=this;e.openMenu=function(){e.openMenuTriggerFn()},e.closeMenu=function(){e.menu.blades=[],e.menu.open=!1},e.addSubGroupToForm=function(e,o,t){function n(e){e.formKey===c?d=!0:e.items&&_.each(e.items,function(e){n(e)})}var i,r,a,l,s=o.mapperKey,c=e.parentKeyName,d=!1;o.formKey===c?d=!0:o.items&&_.each(o.items,function(e){n(e)});var m="";o.currentLevel&&""!==(m=o.currentLevel.uuid||"")&&(m=m.join("."));{var p,u;d?((l=v.getCachedForm(h.forms[e.keyName])[0]).mapperKey=s,r=function(e){e.key&&e.isStyle&&S(e,s,m,w,l.breakpoints),_.each(e.items,function(e){r(e)})},_.each(l.items,function(e){r(e)}),u=angular.copy(l.items),l.breakpoints&&(l.items=[angular.copy(k)],l.items[0].items[0].key=[l.items[0].items[0].key],l.items[0].items[0].items=u),p=[],m&&(p=m.split(".")),f.rewriteConditions(l,p,s),l.breakpoints&&(l.currentBreakpoints=[{name:w,iconName:g.getBreakpointIconName(w)}]),i=function(e){e.formKey===c?e.items.push(l):e.items&&_.each(e.items,function(e){i(e)})},o.formKey===c?o.items.push(l):o.items&&_.each(o.items,function(e){i(e)}),f.applyDefaultValues(l,t)):(p=v.getCachedForm(h.forms[c])[0],(l=v.getCachedForm(h.forms[e.keyName])[0]).mapperKey=s,a=function(e){e.key&&e.isStyle&&S(e,s,m,w,l.breakpoints),_.each(e.items,function(e){a(e)})},_.each(l.items,function(e){a(e)}),u=angular.copy(l.items),l.breakpoints&&(l.items=[angular.copy(k)],l.items[0].items[0].key=[l.items[0].items[0].key],l.items[0].items[0].items=u),u=[],m&&(u=m.split(".")),f.rewriteConditions(l,u,s),l.breakpoints&&(l.currentBreakpoints=[{name:w,iconName:g.getBreakpointIconName(w)}]),p.items=[l],o.items.push(p),f.applyDefaultValues(p,t))}b.variableModeAvailable&&y.applyListener()},e.removeSubGroupFromForm=function(l,s){var c=!1;!function t(e,n){var o,i,r,a;!1===c&&(e.formKey===s.keyName?(o=n[1],a=angular.copy(n.slice(0,-2)),i=_.get(l,a),r=angular.copy(n.slice(0,-1)),a=angular.copy(n.slice(-1))[0],1===i.items.length?l.items.splice(o,1):_.get(l,r).splice(a,1),c=!0):e.items&&_.each(e.items,function(e,o){t(e,angular.copy(n).concat(["items",o]))}))}(l,[])},e.removeAllSubGroupsFromForm=function(e){e.items=[]};var w,k={type:"fieldset",items:[{key:"",title:"",type:"cohBreakpointFieldset",items:[]}]};function S(e,o,t,n,i){i?(e.originalKeyValue=angular.copy(e.key).split("."),e.breakpointName=n,e.key=""!==t?o+"."+t+".styles."+n+"."+e.key:o+".styles."+n+"."+e.key):(e.originalKeyValue=angular.copy(e.key).split("."),e.key=""!==t?o+"."+t+e.key:o+"."+e.key),e.key=e.key.split(".")}e.openMenuTriggerFn=null,e.menu={open:!1,form:null,blades:[]},w=function(){for(var e in o)return e}(),k.items[0].key=w,k.items[0].title=w}e.$inject=["apiUrls","menuSvc","styleBuilderSvc","cohApiSvc","formStateSvc","cohTokenSvc"],angular.module("cohesionApp").service("propertiesMenuSvc",e)}(drupalSettings.cohesion.responsive_grid_settings.breakpoints),function(){function e(r,a,l){var s=this;function c(o,e){return e?e.map(function(e){return o.valueProperty&&"value"!==o.valueProperty&&(e.value=_.get(e,o.valueProperty)),o.labelProperty&&"label"!==o.labelProperty&&(e.label=_.get(e,o.labelProperty)),e}):[]}s.getOptions=function(o,e){var t=o.sharedOptionsId,n=o.endpoint,i=(s.idCounter++,s.idCounter);return s.selectors[t]?(s.selectors[t].updateFunctions.push({id:i,fn:e}),r(function(e){a(function(){s.selectors[t].options.length&&e(i)},100)})):(s.selectors[t]={options:[],updateFunctions:[{id:i,fn:e}]},l.get(n).then(function(e){return s.selectors[t].options=c(o,e),i}))},s.updateOptions=function(e,o,t,n,i){var r=o,a=t;s.selectors[e]&&(_.each(s.selectors[e].options,function(e){_.get(e,"value")===o&&t!==o&&(e.disabled=!0),_.get(e,"value")===t&&t!==o&&(e.disabled=!1)}),_.each(s.selectors[e].updateFunctions,function(e){e.id!==i&&e.fn(r,a)}))},s.removePicker=function(e,o){_.remove(s.selectors[e].updateFunctions,function(e){if(e.id===o)return!0}),0===s.selectors[e].updateFunctions.length&&delete s.selectors[e]},s.createCleanJson=function(e){e=_.assign({},e);delete e.key,delete e.condition,delete e.conditionVariables,delete e.htmlClass,delete e.title,e.endpoint&&delete e.options;return e.schema={type:["string","number","boolean"]},e.isStyle=!0,e},s.normaliseOptions=c,s.idCounter=0,s.selectors={}}e.$inject=["$q","$interval","ajaxSvc"],angular.module("cohesionApp").service("selectOptionsSvc",e)}(),function(o){function e(i,r,a,e,n){var s=this;s.propertyOptionsKey="",s.getBreakpointIconName=u,s.initialiseStyleBuilder=function(e,o,t){s.currentForm=e,s.currentLevelTitle=e.label,o.model[o.form.mapperKey]=o.model[o.form.mapperKey]||{},!o.model[o.form.mapperKey].settings&&o.form.element&&(o.model[o.form.mapperKey].settings={element:o.form.element,class:"",combinator:"",pseudo:""});_.isEmpty(o.schema)&&(o.schema={type:"object",properties:{cohesion:{type:"object"}}});{var n;l=r.getCachedObject(i.breakpointOptions),function(){"desktop-first"===a.state.gridSetting&&(d={type:"fieldset",items:[{key:c="xl",iconName:"television",title:"XL",type:"cohBreakpointFieldset",items:[]}]});"mobile-first"===a.state.gridSetting&&(d={type:"fieldset",items:[{key:c="xs",iconName:"mobile",title:"XS",type:"cohBreakpointFieldset",items:[]}]})}(),_.isEmpty(a.state.mapper)?a.state.mapper[e.mapperKey].form=function(e){var t=[];!function(e){e=p[e.title],_.each(e,function(e){var o=r.getCachedObject(i.forms[e]);o.form[0].children=[],_.each(o.form[0].options,function(e){e=r.getCachedObject(i.forms[e]);o.form[0].children.push(e)}),t.push(o)})}(e);var o=_.map(t,function(e){return e.form[0]});return _.each(o,function(e){var o=_.map(e.children,function(e){return e.form[0]});_.each(o,function(e){var o=e.items,t=[angular.copy(d)];t[0].items[0].items=o,e.items=t,e.breakpoints=!0,e.currentBreakpoints=[{name:c,iconName:u(c)}]}),e.items=o}),e.items=o,function(e){var t=e.key;!function o(e){e.isStyle?(e.key=t+".styles."+c+"."+e.key,e.key=e.key.split(".")):e.key&&!_.isArray(e.key)&&(e.key=e.key.split(".")),_.each(e.items,function(e){o(e)})}(e)}(e),e}(e):(n=h(a.state.mapper[e.mapperKey],e.mapperKey),o.form=n.form,o.mapper=n.mapper,(s.changeFormFn=t)(a.state.mapper[e.mapperKey].form))}},s.produceFormDefinitionForTree=function(e,t){e=angular.copy(e||a.state.mapper);return _.each(e,function(e){e.form&&void 0!==e.form.items&&!function o(e){e.formDefinition=t?null:b(e.form.items),e.form=null,_.each(e.items,function(e){o(e)})}(e)}),e},s.getPathToStyles=function(e){var n=!1,i=[];function r(e,t){n||(e.isStyle?n=!0:_.each(e.items,function(e,o){n||r(e,i=t.concat(["items",o]))}))}_.isArray(e)?_.isArray(e)&&_.each(e,function(e,o){n||r(e,i=[o])}):_.each(e.items,function(e,o){n||r(e,i=["items",o])});return i.pop(),i},s.populateDefaultsWithBreakpoints=function(e){var o="xl";"mobile-first"===a.state.gridSetting&&(o="xs");function t(e){_.each(e.children,function(e){_.isUndefined(_.get(i.forms,e.formKey))||r.getCachedForm(i.forms[e.formKey])[0].breakpoints&&(e.breakpoints=[{name:o}])})}_.each(e.formDefinition,function(e){t(e)}),_.each(e.items,function(e){_.each(e.formDefinition,function(e){t(e)}),_.isUndefined(e.items)||function o(e){_.each(e,function(e){_.isUndefined(e.formDefinition)||_.each(e.formDefinition,function(e){t(e)}),_.isUndefined(e.items)||o(e.items)})}(e.items)})},s.getFormDefinition=b,s.sortByGridSetting=y,s.sortBreakpoints=function(t,e){_.find(e.form,{filterKey:"breakpoints"}).items.sort(function(e,o){return s.order[t].indexOf(e.filterKey)-s.order[t].indexOf(o.filterKey)}),e.model.breakpoints=_.pick(e.model.breakpoints,s.order[t])},s.buildFormForEachSelector=h,s.changeFormFn=function(){},a.state.gridSetting=e.cohesionSettings.responsive_grid_settings.gridType;var l=[],c="xl",t={xl:1,lg:2,md:3,sm:4,ps:5,xs:6};s.order={"mobile-first":["xs","ps","sm","md","lg","xl"],"desktop-first":["xl","lg","md","sm","ps","xs"]};var d={},m={type:"fieldsetArray",items:[]},p={ul:["font","background","layout"],blockquote:["font","background","layout"],cite:["font"],h1:["font"],h2:["font"],h3:["font"],h4:["js-properties","transform-and-transition","font"],h5:["js-properties","transform-and-transition","font"],h6:["font"],ol:["font"]};function u(e){return _.find(l,{name:e}).iconName}function h(e,t){var o={};return e.formDefinition=g(e),e.form=f(e.formDefinition,t),_.each(e.items,function(e){!function o(e){e.uuid||(e.uuid=n.getUUID());e.formDefinition=g(e);e.form=f(angular.copy(e.formDefinition),t+"."+e.uuid);e.items&&_.each(e.items,function(e){o(e)})}(e)}),o.form=e.form,o.mapper=e,o}function f(e,l){var o=angular.copy(s.currentForm);return _.each(e,function(e){var a=[];_.each(e.children,function(n){var t,o,i,r;_.isUndefined(n.form)||((n=angular.copy(n)).form.mapperKey=l,t=angular.copy(n.form.items),o=function o(e){var t;e.key&&e.isStyle&&(t={name:("value"!==(t=e.key.split(".")).slice(-1).toString()?t.slice(-1):t.slice(-2,-1)).toString()},(t=_.find(n.activeFields,t))&&(e.isActive=t.active)),_.each(e.items,function(e){o(e)})},_.each(t,function(e){o(e)}),n.form.items=angular.copy([m]),n.form.currentBreakpoints=[],n.breakpoints=y(n.breakpoints),n.form.breakpoints?_.each(n.breakpoints,function(e){var o=angular.copy(t);i=function(o){o.isStyle&&(o.endKey||(r=angular.copy(o.key),o.originalKeyValue="styles."+e.name+"."+r,o.originalKeyValue=o.originalKeyValue.split("."),o.key=l+".styles."+e.name+"."+r,o.key=o.key.split(".")),"cohArray"===o.type&&_.each(o.items,function(e){e.endKey||(e.endKey=angular.copy(e.key)),e.key=_.concat([],angular.copy(o.key),0,e.endKey.split("."))})),_.each(o.items,function(e){i(e)})},_.each(o,function(e){i(e)}),n.form.currentBreakpoints.push({iconName:u(e.name),name:e.name}),n.form.items[0].items.push({key:[e.name],title:e.name,type:"cohBreakpointFieldset",items:o})}):(i=function(e){e.key&&(e.originalKeyValue=e.key.split("."),e.key=l+"."+e.key,e.key=e.key.split(".")),_.each(e.items,function(e){i(e)})},_.each(t,function(e){i(e)}),n.form.items=t),a.push(n.form))}),e.form.items=a,o.items.push(e.form)}),o}function g(e){if(!o){e=e.formDefinition;return e&&"object"===_typeof(e)&&!_.isEmpty(e)&&e[0].formKey?(_.each(e,function(e){_.isUndefined(_.get(i.forms,e.formKey))||(e.form=r.getCachedForm(i.forms[e.formKey])[0],_.each(e.children,function(e){_.isUndefined(_.get(i.forms,e.formKey))||(e.form=r.getCachedForm(i.forms[e.formKey])[0])}))}),e):null}}function v(e){var n=[];return _.each(e.items,function(e){!function o(e){var t;e.key&&e.isStyle&&(t=e.key,_.isArray(e.key)||(t=e.key.split(".")),void 0===e.isActive||e.isActive?n.push({name:("value"!==t.slice(-1)[0]?t.slice(-1):t.slice(-2,-1))[0],active:!0}):n.push({name:("value"!==t.slice(-1)[0]?t.slice(-1):t.slice(-2,-1))[0],active:!1})),_.each(e.items,function(e){o(e)})}(e)}),n}function b(e){var o=[];return _.each(e,function(e){var t;"cohAccordion"===e.type&&(t={formKey:e.formKey,children:[]},_.each(e.items,function(e){var o={formKey:e.formKey,breakpoints:[],activeFields:[]};e.breakpoints?_.each(e.items[0].items,function(e){_.isArray(e.key)?o.breakpoints.push({name:e.key[0]}):o.breakpoints.push({name:e.key}),o.activeFields=v(e)}):o.activeFields=v(e),t.children.push(o)}),o.push(t))}),angular.copy(o)}function y(e,o){return o=o||a.state.gridSetting,e=_.map(e,function(e){return e.order=t[e.name],e}),e=_.sortBy(e,function(e){return e.order}),"mobile-first"===o&&_.reverse(e),e}}e.$inject=["apiUrls","cohApiSvc","formStateSvc","drupalSvc","cohUUID"],angular.module("cohesionApp").service("styleBuilderSvc",e)}(drupalSettings.cohesion.clearModel),angular.module("cohesionApp").service("Utilities",function(){this.setElementScope=function(e,o){e[0].scope=function(){return o}}}),angular.module("cohesionApp").run(["$templateCache",function(e){e.put("views/modals/coh-modal.html",'<div class="modal-header"><h3>{{modalOptions.headerText}} <button class="btn" ng-click="modalOptions.close()" type="button"></button></h3></div><div class="modal-body"><p ng-if="!modalOptions.noBodyText">{{modalOptions.bodyText}}</p><form class="coh-form" name="modalOptions.schemaForm" ng-if="modalOptions.form" sf-form="modalOptions.form.form" sf-model="modalOptions.form.model" sf-options="{validateOnRender: true}" sf-schema="modalOptions.form.schema"></form><div class="modal-suppression" ng-if="modalOptions.showSuppression == true"><div class="coh-checkbox-toggle"><button aria-checked="{{modalOptions.model.suppress === 1 }}" btn-checkbox-false="0" btn-checkbox-true="1" class="coh-checkbox-toggle-btn" id="modal-suppression-toggle-btn" ng-model="modalOptions.model.suppress" role="switch" type="button" uib-btn-checkbox><span class="checkbox-toggle-on">On</span> <span class="checkbox-toggle-off">Off</span></button> <label class="control-label" for="modal-suppression-toggle-btn">{{modalOptions.suppressionLabel}}</label></div></div></div><div class="modal-footer"><button class="coh-btn coh-modal-btn--cancel" ng-click="modalOptions.close()" type="button">{{modalOptions.closeButtonText}}</button> <button class="coh-btn coh-btn-alt coh-modal-btn--ok" type="button" ng-click="modalOptions.ok();" ng-disabled="modalOptions.form && (modalOptions.schemaForm.$pristine || modalOptions.schemaForm.$invalid)">{{modalOptions.actionButtonText}}</button></div>'),e.put("views/responsive-grid-settings/responsive-grid-settings-preview.html",'<coh-grid-preview ng-model="model" form="form"></coh-grid-preview>'),e.put("views/website-settings/font-smoothing-fieldset.html",'<fieldset class="coh-fieldset" ng-class="form.htmlClass"><div class="coh-fieldset-inner"><legend>{{ form.title }}</legend><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="form.decoratorClass" ng-repeat="item in form.items | filter: { isActive: \'!false\' }"></sf-decorator></div></fieldset>'),e.put("views/website-settings/in-use-modal.html",'<div class="modal-header"><h3>{{modalOptions.headerText}} <button type="button" class="btn" ng-click="modalOptions.close()"></button></h3></div><div class="modal-body"><div ng-repeat="entity in modalOptions.entities"><div class="form-group coh-accordion"><div class="form-group-inner"><uib-accordion close-others="form.closeOthers" class="main-accordion modal-body-padding-top {{form.htmlClass}}"><div uib-accordion-group class="panel-default" is-open="entity.group.open" template-url="scripts/form-elements/coh-accordion/accordion-template.html"><uib-accordion-heading><span class="{{entity.group.open ? \'coh-icon-caret-down\':\'coh-icon-caret-right\';}}"></span> <span>{{entity.group.name}}</span></uib-accordion-heading><p class="bottom-padding"><b>Location</b></p><hr><div ng-repeat="location in entity.locations"><div class="top-bottom-padding"><a href="{{location.url}}">{{location.name}}</a></div><hr></div><div class="top-bottom-padding"></div></div></uib-accordion></div></div></div></div>'),e.put("scripts/directives/coh-accordion/accordion-template.html",'<div class="panel-heading" role="tab" tabindex="0" ng-class="{\'coh-accordion-disabled\': isDisabled}" ng-click="toggleOpen(); $event.stopPropagation();" uib-accordion-transclude="heading"><div class="panel-heading-inner" uib-accordion-header></div></div><div class="panel-collapse collapse" uib-collapse="!isOpen" ng-transclude></div>'),e.put("scripts/directives/coh-accordion/coh-accordion.html",'<div class="coh-accordion-inner" ng-init="form = form" close-others="form.closeOthers" ng-class="{\'first-child-accordion\' : form.items[0].type === \'cohAccordion\' || form.items[0].type === \'cohSection\' || form.items[0].type === \'cohEntityBrowser\'}" uib-accordion><div class="coh-accordion-panel panel" is-disabled="form.isDisabled" is-open="form.isOpen" template-url="scripts/directives/coh-accordion/accordion-template.html" uib-accordion-group><uib-accordion-heading><h2 class="panel-title coh-accordion-title coh-icon-caret-right" ng-show="!form.editing"><span>{{::form.title}}</span></h2><ul class="coh-accordion-actions"><li class="coh-accordion-help" ng-if="::getHelpUrl(form.helpKey)"><a aria-label="Open support article in new window" class="coh-icon-question-circle" href="{{::getHelpUrl(form.helpKey)}}" ng-click="$event.stopPropagation()" target="_blank" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Help and support"></a></li></ul></uib-accordion-heading><div class="panel-body coh-accordion-panel-body" ng-class="form.htmlClass"><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="form.decoratorClass" ng-repeat="item in form.items| orderBy: \'weight\'"></sf-decorator></div></div></div>'),e.put("scripts/directives/coh-array/coh-array.html",'<div ng-if="caw.form.sortable" ng-model="caw.form.items" ui-sortable="caw.sortableOptions"><div class="array-row {{isHidden}}" ng-class="{\'last\': $last}" ng-cloak ng-init="arrayIndex = $index" ng-repeat="row in caw.form.items track by $index"><span aria-label="Move row" class="coh-array-sortable-handle coh-icon-move" ng-class="{disabled: caw.form.items.length <= 1}" ng-disabled="caw.form.items.length <= 1" ng-if="caw.sortableOptions.handle" type="button"></span><div class="scrollbar-container" coh-scrollbar-container ng-class="{\'coh-scrollbars-horizontal-only\' : !form.disableScrollbar}"><sf-decorator class="field coh-type-{{item.type}}" form="item" ng-repeat="item in row.items"></sf-decorator></div><button class="coh-delete-btn" ng-attr-aria-label="{{!form.options.removeLabel ? \'Remove\' : undefined}}" ng-class="{disabled: caw.form.items.length <= caw.form.min || caw.form.items.length <= 1}" ng-click="caw.deleteItem($index)" ng-disabled="caw.form.items.length <= caw.form.min || caw.form.items.length <= 1" type="button">{{form.options.removeLabel}}</button></div></div><div ng-if="!form.sortable"><div class="array-row" ng-class="{\'last\': $last}" ng-cloak ng-init="arrayIndex = $index" ng-repeat="row in caw.form.items track by $index"><div class="scrollbar-container" coh-scrollbar-container ng-class="{\'coh-scrollbars-horizontal-only\' : !form.disableScrollbar}"><sf-decorator class="field coh-type-{{item.type}}" form="item" ng-repeat="item in row.items"></sf-decorator></div><button class="coh-delete-btn" ng-attr-aria-label="{{!form.options.removeLabel ? \'Remove\' : undefined}}" ng-class="{disabled: caw.form.items.length <= caw.form.min || caw.form.items.length <= 1}" ng-click="caw.deleteItem($index)" ng-disabled="caw.form.items.length <= caw.form.min || caw.form.items.length <= 1" type="button">{{form.options.removeLabel}}</button></div></div><div class="add-button-container"><div class="add-button-inner"><button class="icon coh-icon-plus-circle" ng-click="caw.addItem()" ng-disabled="caw.form.readonly" ng-class="" type="button">{{form.addText ? form.addText : "Add"}}</button></div></div>'),e.put("scripts/directives/coh-available-color-select/coh-available-color-select.html",'<div class="coh-available-color-select"><input ng-model="acs.ngModel" type="hidden"><div class="sp-thumb-el coh-color-thumb sp-clear-display" ng-click="acs.onClickThumb(acs.unsetColor)" role="button" tooltip-class="coh-tooltip" tooltip-placement="auto bottom" uib-tooltip="Unset colour"><div class="sp-thumb-inner" ng-class="{\'coh-color-thumb-active\' : acs.isSelected(acs.unsetColor)}"></div></div><div class="sp-thumb-el coh-color-thumb" ng-repeat="color in acs.palette" ng-click="acs.onClickThumb(color)" tooltip-class="coh-tooltip" tooltip-placement="auto bottom" uib-tooltip="{{color.name}}"><div ng-class="{\'coh-color-thumb-active\' : acs.isSelected(color)}" ng-style="{backgroundColor: color.value.value.rgba}"></div></div></div>'),e.put("scripts/directives/coh-blades-menu/coh-blades-menu.html",'<div class="coh-blades-menu" ng-class="{active : cbm.menu.blades.length > 0}"><div class="blade {{\'blade\'+($index+1)}}" ng-repeat="blade in cbm.menu.blades| orderBy:\'+\': true"><div class="lockout" ng-click="cbm.closeMenu()" ng-if="$index === 0" tabindex="-1"></div><div class="content"><div class="level-selector" ng-if="cbm.menu.blades.length >= 2" ng-click="cbm.back()"></div><div class="level-selector level-3" ng-if="cbm.menu.blades.length === 3" ng-click="cbm.selectBladeLevel(1)"></div><div class="content-inner" coh-sticky><div class="back-container"><button class="coh-back-btn coh-icon-angle-double-left" coh-auto-focus ng-click="cbm.back()" type="button"></button></div><div ng-if="blade.type === \'tree\'" class="coh-tree tree"><div class="base-title title" ng-class="activeClass"><div class="coh-tree__item" ng-click="cbm.selectFormLevel(blade.selectorArray); $event.stopPropagation()">Default {{blade.selectorArray.selectorType === \'topLevel\' ? \'(\' + blade.selectorArray.title + \')\' : \'\'}}</div><button aria-label="Add selector" class="coh-selector-btn coh-selector-btn--add coh-icon-plus-circle" ng-click="cbm.addMenuLevel2(blade.selectorArray); $event.stopPropagation()" type="button"></button></div><div ui-sortable="cbm.sortableOptions" allowed-types="any" class="children" ng-model="blade.selectorArray.items"><tree-item class="innerCont" ng-model="newItem" ng-repeat="newItem in blade.selectorArray.items"></tree-item></div></div><div ng-if="blade.type === \'selector\'"><div ng-repeat="option in cbm.getSubselectorOptions()"><div class="list-element" ng-if="!option.hasOptions" ng-click="cbm.addSelector(option, blade.item)">{{option.name}}</div><div class="list-element" ng-if="option.hasOptions && !(cbm.menu.addToItem.selectorType == \'modifier\' && option.selectorType === \'combinator\') && !(cbm.menu.addToItem.selectorType === \'topLevel\' && option.selectorType === \'combinator\') && !(cbm.menu.addToItem.selectorType !== \'topLevel\' && option.selectorType === \'prefix\') && !(cbm.menu.addToItem.selectorType === \'pseudo\' && option.selectorType === \'combinator\') " ng-click="cbm.addSubSelectorBlade(option, blade.item)">{{option.name}} <span class="coh-icon-caret-right options-icon"></span></div></div><hr ng-if="blade.editable || blade.deletable"><div ng-if="blade.editable" ng-click="cbm.editItemName(blade)" class="edit-list-item list-element" ng-if="option.hasOptions">Edit <button aria-label="Edit selector" class="coh-selector-btn coh-selector-btn--edit coh-icon-edit" tabindex="0" type="button"></button></div><div ng-if="blade.deletable" ng-click="cbm.deleteItem()" class="delete-list-item list-element" ng-if="option.hasOptions">Delete <button aria-label="Delete selector" class="coh-selector-btn coh-selector-btn--delete coh-icon-cancel-circle" tabindex="0" type="button"></button></div></div><div ng-if="blade.type === \'selectorInput\'"><div class="coh-form coh-is-loaded" ng-class="{\'coh-form-bleed\' : blade.selectorType === \'combinator\'}"><div ng-if="blade.selectorType !== \'combinator\' && blade.selectorType !== \'pseudo\'"><div class="prefix-options" ng-if="blade.selectorType === \'prefix\'"><div class="list-element" ng-click="cbm.addCustomSelector(\'.coh-ie9\', blade.selectorType)">IE 9</div></div><div class="selector-type-title">{{blade.option.label}}</div><p ng-if="blade.selectorType === \'modifier\' || blade.selectorType === \'prefix\' || blade.selectorType === \'child\'">Use (.) for class (#) for id or ( [ attribute name ] ) for attribute.</p><div class="coh-text-box"><input class="coh-selector form-control" input-focus coh-selector-validator coh-selector-validator-type="blade.selectorType" coh-selector-validator-sub-type="blade.subType" coh-selector-validator-valid="cbm.selectorInputValid" coh-selector-validator-validating="cbm.selectorInputValidating" ng-model="cbm.selectorInput" required type="text"> <span class="coh-selector-icon coh-icon-circle-o" ng-if="!cbm.selectorInput && !cbm.selectorInputValidating"></span> <span aria-label="Validating selector" class="coh-selector-icon coh-is-loading coh-preloader-x-small" ng-if="cbm.selectorInputValidating" role="alert"></span> <span aria-label="Selector valid" class="coh-selector-icon coh-icon-check-circle" ng-if="cbm.selectorInput && !cbm.selectorInputValidating && cbm.selectorInputValid" role="alert"></span> <button aria-label="Clear value" class="coh-selector-icon coh-icon-cancel-circle" ng-click="cbm.selectorInput = \'\'" ng-if="cbm.selectorInput && !cbm.selectorInputValidating && !cbm.selectorInputValid" type="button"></button> <span ng-if="!cbm.selectorInputValid && cbm.selectorInput" class="coh-description"><strong>\'{{cbm.selectorInput}}\'</strong> is not a valid selector</span></div><div class="coh-btn-wrapper"><button ng-if="!blade.editing" type="button" class="coh-btn add-btn" ng-disabled="!cbm.selectorInputValid || cbm.selectorInputValidating" ng-click="cbm.addCustomSelector(cbm.selectorInput, blade.selectorType)">Add</button> <button ng-if="blade.editing" type="button" class="coh-btn add-btn" ng-disabled="!cbm.selectorInputValid || cbm.selectorInputValidating" ng-click="cbm.editCustomSelector(cbm.selectorInput, blade.selectorType)">Update</button></div></div><div ng-if="blade.selectorType === \'pseudo\'">{{blade.option.label}}<div class="coh-text-box"><input class="coh-selector form-control" input-focus coh-selector-validator coh-selector-validator-type="blade.selectorType" coh-selector-validator-sub-type="blade.subType" coh-selector-validator-valid="cbm.selectorInputValid" coh-selector-validator-validating="cbm.selectorInputValidating" ng-model="cbm.selectorInput" required type="text"> <span class="coh-selector-icon coh-icon-circle-o" ng-if="!cbm.selectorInput && !cbm.selectorInputValidating"></span> <span aria-label="Validating selector" class="coh-selector-icon coh-is-loading coh-preloader-x-small" ng-if="cbm.selectorInputValidating" role="alert"></span> <span aria-label="Selector valid" class="coh-selector-icon coh-icon-check-circle" ng-if="cbm.selectorInput && !cbm.selectorInputValidating && cbm.selectorInputValid" role="alert"></span> <button aria-label="Clear value" class="coh-selector-icon coh-icon-cancel-circle" ng-click="cbm.selectorInput = \'\'" ng-if="cbm.selectorInput && !cbm.selectorInputValidating && !cbm.selectorInputValid" type="button"></button> <span ng-if="!cbm.selectorInputValid && cbm.selectorInput" class="coh-description"><strong>\'{{cbm.selectorInput}}\'</strong> is not a valid selector</span></div><div class="coh-btn-wrapper"><button ng-if="!blade.editing" type="button" class="coh-btn add-btn" ng-disabled="!cbm.selectorInputValid || cbm.selectorInputValidating" ng-click="cbm.addCustomPseudoSelector(cbm.selectorInput, blade.selectorType, blade.option.subType)">Add</button> <button ng-if="blade.editing" type="button" class="coh-btn add-btn" ng-disabled="!cbm.selectorInputValid || cbm.selectorInputValidating" ng-click="cbm.editCustomPseudoSelector(cbm.selectorInput, blade.selectorType, blade.option.subType)">Update</button></div></div><div ng-if="blade.selectorType === \'combinator\'"><div class="list-element" ng-click="cbm.addCombinator(\' \', blade.item)">Descendant selector (space)</div><div class="list-element" ng-click="cbm.addCombinator(\' > \', blade.item)">Child selector (>)</div><div class="list-element" ng-click="cbm.addCombinator(\' + \', blade.item)">Adjacent sibling selector (+)</div><div class="list-element" ng-click="cbm.addCombinator(\' ~ \', blade.item)">General sibling selector (~)</div></div></div></div></div></div></div></div>'),e.put("scripts/directives/coh-blades-menu/ui-sortable-item.html",'<div class="container-element" container-for="{{innerItem.title}}"><div class="title" ng-class="activeClass"><div class="title-container unselectable" ng-class="{\'placeholder-padding\':!innerItem.items.length}"><button class="coh-expand-collapse-btn" ng-if="innerItem.items.length>0" ng-class="{\'coh-icon-plus-square\':innerItem.collapsed, \'coh-icon-minus-square\':!innerItem.collapsed}" ng-click="innerItem.collapsed = !innerItem.collapsed; $event.stopPropagation();" type="button"></button><div class="coh-tree__item" ng-click="cbm.selectFormLevel(innerItem, false); $event.stopPropagation()"><span class="coh-tree-label"><span ng-if="innerItem.combinator">{{innerItem.combinator}}</span> <span ng-if="innerItem.title">{{innerItem.title}}</span> </span><span ng-if="innerItem.selectorType!==\'pseudo\'"><span ng-if="innerItem.combinator !== \' + \' && innerItem.combinator !== \' ~ \'">({{::innerItem.selectorType}})</span> <span ng-if="innerItem.combinator === \' + \' || innerItem.combinator === \' ~ \'">(sibling)</span></span></div></div><button aria-label="Add selector" class="coh-selector-btn coh-selector-btn--add coh-icon-plus-circle" ng-click="cbm.addMenuLevel2(innerItem); $event.stopPropagation();" type="button"></button></div><div ng-if="!innerItem.collapsed" class="children" allowed-types="{{::innerItem.allowedTypes}}" ui-sortable="::cbm.sortableOptions" ng-model="innerItem.items"><tree-item ng-model="innerItem" ng-repeat="innerItem in innerItem.items" class="innerCont"></tree-item></div><div class="clearfix"></div></div>'),e.put("scripts/directives/coh-breakpoint-selector/coh-breakpoint-editor-modal.html",'<div class="coh-modal"><div class="modal-header"><h4 class="modal-title">Edit Custon Breakpoint</h4><span ng-click="$dismiss(\'cancel\')" class="coh-icon-cancel-circle"></span></div><div class="modal-body" id="modal-body"><label for="breakpoint">Breakpoint Value</label> <input id="breakpoint" ng-model="cbp.breakpointValue" type="number"></div><div class="modal-footer"><button type="button" class="coh-btn" ng-click="$dismiss(\'cancel\')">Cancel</button> <button type="button" class="coh-btn coh-btn-alt" ng-click="$close(cbp.breakpointValue)">Confirm</button></div></div>'),e.put("scripts/directives/coh-breakpoint-selector/coh-breakpoint-selector-modal.html",'<div class="coh-modal"><div class="modal-header"><h4 class="modal-title">Add Custom Breakpoint</h4><span ng-click="$dismiss(\'cancel\')" class="coh-icon-cancel-circle"></span></div><div class="modal-body" id="modal-body"><label for="breakpoint">Breakpoint Value</label> <input id="breakpoint" ng-model="cbp.breakpoint" type="number"></div><div class="modal-footer"><button type="button" class="coh-btn" ng-click="$dismiss(\'cancel\')">Cancel</button> <button type="button" class="coh-btn coh-btn-alt" ng-click="$close(cbp.breakpoint)">Create</button></div></div>'),e.put("scripts/directives/coh-breakpoint-selector/coh-breakpoint-selector.html",'<div class="coh-breakpoints-dropdown" keyboard-nav ng-click="$event.stopPropagation();" on-toggle="bps.onToggleDrop(open)" tabindex="-1" uib-dropdown><button aria-label="Add or remove breakpoints" class="coh-breakpoints-dropdown-btn" id="coh-breakpoints-dropdown-btn-{{::$id}}" ng-class="{\'coh-icon-desktop\':bps.sGridSetting===\'desktop-first\', \'coh-icon-mobile\':bps.sGridSetting===\'mobile-first\'}" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" type="button" uib-dropdown-toggle uib-tooltip="Add/remove breakpoints"></button><ul aria-labelledby="coh-breakpoints-dropdown-btn-{{::$id}}" class="dropdown-menu dropdown-menu-breakpoints" role="menu" uib-dropdown-menu><li ng-class="{\'selected\': breakpoint.selected}" ng-repeat="breakpoint in ::bps.breakpointOptions" role="menuitem"><button aria-label="{{breakpoint.iconName}}" aria-pressed="{{breakpoint.selected ? breakpoint.selected : false }}" class="{{::\'coh-icon-\'+breakpoint.iconName}}" tabindex="0" ng-click="bps.toggleOption(breakpoint)" type="button"></button></li></ul></div>'),e.put("scripts/directives/coh-button/coh-button.html",'<button class="{{cb.form.style}}" ng-attr-aria-label="{{ cb.form.ariaLabel }}" ng-attr-tooltip-append-to-body="{{ cb.form.tooltipAppendBody }}" ng-attr-tooltip-class="{{ cb.form.tooltipClass }}" ng-attr-tooltip-placement="{{ cb.form.tooltipPlacement }}" ng-attr-uib-tooltip="{{ cb.form.tooltip }}" ng-click="cb.buttonClick($event, cb.form)" ng-disabled="$eval(cb.form.readonly.toString()) || $eval(cb.form.disabled.toString())" type="button"><span ng-if="cb.form.title && !cb.form.hideText">{{cb.form.title}}</span><span ng-if="cb.form.iconClass" class="{{cb.form.iconClass}}"></span></button>'),e.put("scripts/directives/coh-canvas-preview/coh-canvas-preview.html",'<ul class="coh-section-actions coh-canvas-preview-toolbar" role="menu"><li ng-if="::cp.toolbar.columns" class="coh-canvas-preview-dropdown coh-canvas-preview-width" uib-dropdown is-open="cp.columnMenuOpen" auto-close="outsideClick" on-toggle="toggled(open)" role="menuitem"><label for="coh-width-dropdown-btn">Width</label> <button type="button" class="coh-icon-caret-down" id="coh-width-dropdown-btn" uib-dropdown-toggle><ng-pluralize count="cp.state.columnWidth" when="{\'one\': \'1 column\', \'other\': \'{} columns\'}"></ng-pluralize></button><ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu role="menu" aria-labelledby="coh-width-dropdown-btn"><li class="coh-canvas-preview-width-toggle" role="menuitem">Boxed<div class="coh-checkbox-toggle"><coh-checkbox-toggle ng-click="cp.onToggleContainerType()" model="cp.state.boxedWidth" form="{trueValue: true, falseValue: false}" tabindex="-1"></coh-checkbox-toggle></div></li><li role="menuitem" ng-repeat="n in cp._range(12,0)" ng-class="{\'coh-selected\': n === cp.state.columnWidth}"><button type="button" ng-disabled="n === cp.state.columnWidth" ng-click="cp.setWidth(n)"><ng-pluralize count="n" when="{\'one\': \'1 column\', \'other\': \'{} columns\'}"></ng-pluralize></button></li></ul></li><li ng-if="::cp.toolbar.scale" class="coh-canvas-preview-dropdown coh-canvas-preview-scale" uib-dropdown keyboard-nav on-toggle="toggled(open)" role="menuitem"><label for="coh-scale-dropdown-btn">Scale</label> <button type="button" class="coh-icon-caret-down" id="coh-scale-dropdown-btn" uib-dropdown-toggle>{{cp.state.autoScaleOn ? \'Auto \' + cp.getZoom() : \'Actual size\'}}</button><ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu role="menu" aria-labelledby="coh-scale-dropdown-btn"><li role="menuitem" ng-class="{\'coh-selected\': !cp.state.autoScaleOn}"><button type="button" ng-click="cp.toggleScale()" ng-disabled="!cp.state.autoScaleOn">Actual size</button></li><li role="menuitem" ng-class="{\'coh-selected\': cp.state.autoScaleOn}"><button type="button" ng-click="cp.toggleScale()" ng-disabled="cp.state.autoScaleOn">Auto {{cp.getZoom()}}</button></li></ul></li><li ng-if="::cp.toolbar.grid" class="coh-canvas-preview-dropdown coh-canvas-preview-grid" uib-dropdown keyboard-nav on-toggle="toggled(open)" role="menuitem"><button aria-label="Show or hide grid guide" class="coh-icon-caret-down" id="coh-grid-dropdown-btn" tooltip-class="coh-tooltip" tooltip-placement="{{ cp.options.standAlone ? \'bottom-right\' : \'top-right\' }}" type="button" uib-dropdown-toggle uib-tooltip="Show/hide grid guide"><span class="coh-icon-ban" ng-class="{\'coh-icon-guides-boxed\': cp.state.gridType === \'boxed\', \'coh-icon-guides-fluid\': cp.state.gridType === \'fluid\'}"></span></button><ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu role="menu" aria-labelledby="coh-grid-dropdown-btn"><li role="menuitem" ng-class="{\'coh-selected\': !cp.state.gridType}"><button type="button" class="coh-icon-ban" ng-click="cp.setGridType()" ng-disabled="!cp.state.gridType">Guides off</button></li><li role="menuitem" ng-class="{\'coh-selected\': cp.state.gridType === \'boxed\'}"><button type="button" class="coh-icon-guides-boxed" ng-click="cp.setGridType(\'boxed\')" ng-disabled="cp.state.gridType === \'boxed\'">Guides boxed</button></li><li role="menuitem" ng-class="{\'coh-selected\': cp.state.gridType === \'fluid\'}"><button type="button" class="coh-icon-guides-fluid" ng-click="cp.setGridType(\'fluid\')" ng-disabled="cp.state.gridType === \'fluid\'">Guides fluid</button></li></ul></li><li ng-if="::cp.toolbar.breakpoints" class="coh-canvas-preview-tool coh-breakpoints" role="menuitem"><coh-simple-breakpoints ng-model="cp.state.selectedBreakpoint" h-breakpoints="cp.breakpoints" hide-larger-than-window="cp.options.standAlone" show-responsive="cp.options.standAlone"></coh-simple-breakpoints></li><li ng-if="::cp.toolbar.colorpicker" class="coh-canvas-preview-tool coh-canvas-preview-colour" role="menuitem"><div class="coh-colour-picker" tooltip-class="coh-tooltip" tooltip-placement="{{ cp.options.standAlone ? \'bottom-right\' : \'top-right\' }}" uib-tooltip="Select preview background color"><coh-colour-picker ng-model="cp.state.colorModel" spinner-size="\'small\'" colour="cp.iFrameColor" options="cp.colorPickerOptions"></coh-colour-picker></div></li></ul><div class="coh-canvas-preview-container" ng-if="!cp.disconnectedFromParent" ng-init="cp.registerElements()"><div class="coh-canvas-preview" ng-style="cp.getContainerStyle()" ng-class="{\'coh-canvas-preview-scrollable\': cp.isPreviewScrollable()}" coh-resizeable resize-options="cp.resizeOptions"><iframe class="coh-canvas-preview-iframe" ng-class="cp.iframeClasses" ng-src="{{ cp.previewSrc }}" ng-style="cp.getFrameStyle()" frameborder="0" ng-click="cp.iframeClicked()" title="Layout canvas preview"></iframe></div><div ng-show="::cp.resizable" class="coh-iframe-resize ui-resizable-handle ui-resizable-s"></div></div><div class="coh-canvas-preview-container" ng-if="cp.disconnectedFromParent"><p>Disconnected from parent window. Please wait or <a href ng-click="cp.closeWindow()">close this window.</a></p></div>'),e.put("scripts/directives/coh-checkbox-toggle/coh-checkbox-toggle.html",'<button aria-checked="{{ctw.model === ctw.form.trueValue }}" btn-checkbox-false="ctw.form.falseValue" btn-checkbox-true="ctw.form.trueValue" class="coh-checkbox-toggle-btn form-control coh-var-switch" id="{{ctw.form.cohIdKey}}" ng-class="[ctw.form.fieldHtmlClass, {\n            \'active\':ctw.startActive,\n            \'disabled\': $eval(ctw.form.readonly.toString())\n        }]" ng-disabled="$eval(ctw.form.readonly.toString())" ng-model="ctw.model" ng-model-options="ctw.form.ngModelOptions" role="switch" sf-changed="ctw.form" sf-field-model="replaceAll" type="button" uib-btn-checkbox uib-uncheckable="$eval(ctw.form.readonly.toString())"><span class="checkbox-toggle-on">On</span> <span class="checkbox-toggle-off">Off</span></button>'),e.put("scripts/directives/coh-clean-form-button/coh-clean-form-button.html",'<button aria-label="Remove empty properties" class="coh-clean-form-btn coh-icon-clean" ng-click="ceb.cleanForm()" ng-disabled="$eval(form.readonly.toString())" tooltip-class="coh-tooltip" tooltip-placement="top-left" type="button" uib-tooltip="Remove empty properties"></button>'),e.put("scripts/directives/coh-colour-picker-opener/coh-colour-picker-opener.html",'<div class="background" ng-class="{\'no-model\' : !ccpo.model.value.hex && !ccpo.model.value.rgba}" ng-hide="ccpo.loading"><button aria-label="Click to select a color" class="colour-representation" id="{{ccpo.form.cohIdKey}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-style="{{ccpo.model.value.rgba ? \'background-color : \' + ccpo.model.value.rgba : undefined}}" ng-click="ccpo.openPickerMenu()" type="button"></button></div><div class="coh-is-loading coh-preloader-small" ng-if="ccpo.loading"></div><div class="colour-text-value" ng-if="ccpo.model">{{ccpo.model | cohPreferredColourFormat : ccpo.options.preferredFormat : ccpo.opacity}}</div><div class="colour-text-value" ng-if="!ccpo.model.value.rgba">None</div>'),e.put("scripts/directives/coh-colour-picker/coh-colour-picker.html",'<div class="colour-picker-input-wrap"><div class="text-center loader coh-is-loading coh-preloader-{{ccp.spinnerSize}}" ng-if="ccp.loading"></div><spectrum-colorpicker class="coh-colour-picker-input-wrap-inner" on-before-show="ccp.onBeforeShow(color)" options="ccp.options" ng-change="ccp.modelChange()" ng-if="!ccp.loading" ng-model="ccp.currentModel" ng-model-options="{debounce: 250}"></spectrum-colorpicker><div class="colourpicker-value" ng-if="ccp.model">{{ccp.model | cohPreferredColourFormat : ccp.options.preferredFormat : ccp.opacity}}</div><div class="colourpicker-value" ng-if="!ccp.model.value.rgba">None</div></div>'),e.put("scripts/directives/coh-component-form/coh-component-form.html",'<div coh-var-switcher-shortcut><div class="coh-style-builder-container"><sf-decorator class="coh-type-{{form.items[0].type}}" form="form.items[0]"></sf-decorator><div class="form-body-main main-vertical-scrollbar coh-scrollbars" coh-scrollbar-container><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="{\'coh-remove-padding\': form.removePadding}" ng-repeat="item in form.items | orderBy: \'weight\' | limitTo: 1 - form.items.length"></sf-decorator></div></div></div>'),e.put("scripts/directives/coh-component-translation-settings/coh-component-translation-settings.html",'<div class="coh-component-translation-settings"><fieldset><legend>Translatable by TMGMT</legend><sf-decorator class="coh-type-{{item.type}}" form="item" ng-repeat="item in form.items| orderBy: \'weight\'"></sf-decorator></fieldset></div>'),e.put("scripts/directives/coh-edited-field-indicator/coh-edited-field-indicator.html",'<button class="coh-edited-field-btn" ng-click="efi.revert()" ng-if="efi.isEdited()" ng-animate-disabled type="button" uib-tooltip="Reset to default">Edited</button>'),e.put("scripts/directives/coh-element-browser/coh-element-browser-modal.html",'<div class="modal-header"><div class="modal-header-nav"><button aria-label="{{ toggled ? \'Close sidebar browser\' : \'Open sidebar browser\' }}" class="coh-btn coh-btn-alt close" ng-click="toggleElementBrowser()" type="button"></button></div></div><div class="modal-body" ng-if="toggled"><div class="coh-layout-canvas-menu"><button type="button" class="coh-nav-dropdown {{ navOpen ? \'coh-icon-caret-up\' : \'coh-icon-caret-down\'}}" ng-if="::tabs.available.length > 1" ng-click="toggleNav()">{{tabs.available[tabs.selected]}}</button> <button type="button" class="coh-nav-dropdown disabled" ng-if="::tabs.available.length <= 1">{{tabs.available[tabs.selected]}}</button> <button type="button" class="coh-element-list-mobile-close" type="button" ng-click="close()"></button><div class="tab-pane"><uib-tabset active="tabs.selected" vertical="true"><uib-tab index="$index" ng-repeat="tab in tabs.available" heading="{{tab}}" uib-collapse="!navOpen" collapsing="navAnimStart()" expanding="navAnimStart()" collapsed="navAnimComplete()" expanded="navAnimComplete()" accesskey="{{getAccessKey(tab)}}"><div class="coh-element-browser-tools" ng-if="nodes[tab].length"><div class="coh-form coh-element-browser-search"><input class="form-control" type="text" ng-model="search.title" ng-model-options="{debounce: 200}" placeholder="Search for {{tab}}" autofocus> <span class="coh-icon coh-icon-search"></span> <button type="button" class="coh-icon coh-icon-cancel-circle" ng-click="search.title = \'\'" ng-show="search.title.length"></button></div><button aria-label="{{showThumbs ? \'Show titles\' : \'Show thumbnails\'}}" class="coh-toggle-thumbnail-view coh-icon-eye" ng-class="{\'coh-icon-list-ul\': showThumbs}" ng-click="toggleThumbnailView()" ng-if="showThumbToggleButton(tab)" tooltip-append-to-body="true" tooltip-class="coh-tooltip coh-tooltip--element-browser" tooltip-placement="right" type="button" uib-tooltip="{{showThumbs ? \'Show titles\' : \'Show thumbnails\'}}"></button></div><div ng-if="tab === tabs.available[tabs.selected]" class="coh-element-list-container coh-scrollbars" coh-prevent-parent-scroll coh-scrollbar-container ng-class="{\'coh-is-loading coh-preloader-large\':!nodes[tab]}"><div class="coh-category-container-wrapper"><div class="coh-category-message" ng-if="nodes[tab].length && noSearchResults(nodes[tab])">No matches for "{{search.title}}".</div><div class="coh-category-message" ng-if="!nodes[tab].length">No {{tab | lowercase}} available.</div><div class="coh-category-container {{::node.class}}" ng-repeat="node in nodes[tab] track by node.id"><coh-element-browser-nodes-renderer></coh-element-browser-nodes-renderer></div></div></div></uib-tab></uib-tabset></div></div></div>'),e.put("scripts/directives/coh-element-browser/coh-element-browser-nodes-renderer.html",'<p class="category-title" ng-if="node.children.length">{{::node.label}}</p><div class="coh-layout-canvas-zone"><ol class="coh-layout-canvas-list" ui-sortable="sortableOptions" ng-model="node.children"><li data-element="{{::element.uid}}" ng-repeat="element in node.children track by element.uid" class="coh-layout-canvas-list-item coh-layout-canvas-list-item-type-{{::element.type}}" data-type="{{::element.type}}" data-uid="{{::element.uid}}" data-title="{{::element.model.settings.title || element.title}}" ng-attr-uib-tooltip-template="{{(element.type === \'helper\' || element.type === \'component\' || element.type === \'component-content\' ) && \'\\\'scripts/directives/coh-element-browser/coh-element-browser-tooltip.html\\\'\' || undefined }}" tooltip-append-to-body="true" tooltip-class="coh-tooltip coh-tooltip--element-browser" tooltip-placement="right"><div class="coh-layout-canvas-utils" ng-dblclick="appendElement($event, element, node.children, node)" tabindex="-1"><span class="layout-canvas-type-{{::element.isCustom === undefined ? element.uid : \'custom\'}}" ng-class="{\n                        \'{{::element.category}}\' : element.type === \'helper\' || element.type === \'component\' || element.type === \'component-content\'\n                      }"><span>{{::element.model.settings.title || element.title}}</span> </span><button type="button" class="coh-icon-plus-circle" ng-dblclick="$event.stopPropagation();" ng-click="appendElement($event, element, node.children, node)" aria-label="add to canvas"></button></div></li></ol></div>'),e.put("scripts/directives/coh-element-browser/coh-element-browser-thumbs-nodes-renderer.html",'<p class="category-title" ng-if="node.children.length">{{::node.label}}</p><div class="coh-layout-canvas-zone"><ol class="coh-layout-canvas-list coh-layout-canvas-list-thumb" ui-sortable="sortableOptions" ng-model="node.children"><li data-element="{{::element.uid}}" ng-repeat="element in node.children track by element.uid" class="coh-layout-canvas-list-item-thumb" tabindex="-1" data-type="{{::element.type}}" data-uid="{{::element.uid}}" data-title="{{::element.title}}" ng-dblclick="appendElement($event, element, node.children, node)" ng-class="{\n                \'coh-type-{{::element.category}}\' : element.category,\n                \'layout-canvas-type-{{::element.uid}}\' : !element.isCustom,\n                \'layout-canvas-type-custom\' : element.isCustom,\n                \'coh-element-thumb-preview\' : (element.type === \'helper\' || element.type === \'component\' || element.type === \'component-content\') && element.preview_image.url,\n                \'coh-element-thumb-no-preview\': (element.type === \'helper\' || element.type === \'component\' || element.type === \'component-content\') && !element.preview_image.url\n            }" ng-attr-uib-tooltip-template="{{(element.type === \'helper\' || element.type === \'component\' || element.type === \'component-content\' ) && \'\\\'scripts/directives/coh-element-browser/coh-element-browser-tooltip.html\\\'\' || undefined }}" tooltip-append-to-body="true" tooltip-class="coh-tooltip coh-tooltip--element-browser" tooltip-placement="right"><img ng-if="element.preview_image.url" class="coh-element-thumb" tabindex="-1" ng-src="{{element.preview_image.url}}" alt="{{::(element.model.settings.title || element.title) + \' thumbnail\'}}"><div class="coh-layout-canvas-utils"><button type="button" class="coh-icon-plus-circle" ng-dblclick="$event.stopPropagation();" ng-click="appendElement($event, element, node.children, node)" aria-label="add to canvas"></button></div><div class="coh-element-thumb-title">{{::element.model.settings.title || element.title}}</div></li></ol></div>'),e.put("scripts/directives/coh-element-browser/coh-element-browser-tooltip.html",'<figure><img ng-if="element.preview_image.url" class="coh-element-thumb" tabindex="-1" ng-src="{{element.preview_image.url}}" alt="{{::(element.model.settings.title || element.title) + \' thumbnail\'}}"><figcaption>{{::element.model.settings.title || element.title}}</figcaption></figure>'),e.put("scripts/directives/coh-element-settings/coh-element-settings.html",""),e.put("scripts/directives/coh-entity-browser/coh-entity-browser.html",'<sf-decorator class="section-decorator coh-type-{{item.type}}" form="item" ng-repeat="item in cmeb.items| orderBy: \'weight\'"></sf-decorator>'),e.put("scripts/directives/coh-entity-picker/coh-entity-picker.html",'<sf-decorator class="section-decorator coh-type-{{item.type}}" form="item" ng-repeat="item in cep.items| orderBy: \'weight\'"></sf-decorator>'),e.put("scripts/directives/coh-field-machine-name/coh-field-machine-name.html",'<div class="coh-field-machine-name__inner" ng-class="{\'input-group\' : (cmn.form.fieldAddonLeft || cmn.form.fieldAddonRight)}"><span class="input-group-addon input-group-addon--left" ng-bind-html="cmn.form.fieldAddonLeft" ng-if="cmn.form.fieldAddonLeft"></span> <input class="form-control" id="{{cmn.form.cohIdKey}}" name="{{cmn.form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? cmn.form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::cmn.form.required}}" ng-attr-coh-component-variable-formatter="{{cmn.form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::cmn.form.placeholder}}" ng-class="cmn.form.fieldHtmlClass" ng-disabled="$eval(cmn.form.readonly.toString())" ng-model="cmn.ngModel" ng-model-options="cmn.form.ngModelOptions" ng-readonly="!cmn.editable" ng-show="cmn.form.key" schema-validate="cmn.form" sf-changed="cmn.form" sf-field-model="replaceAll" type="text"> <button aria-label="Edit machine name" class="coh-field-machine-name__button coh-icon-edit" ng-click="cmn.makeEditable()" ng-if="!cmn.editable" type="button"></button> <span class="input-group-addon input-group-addon--right" ng-if="cmn.form.fieldAddonRight" ng-bind-html="cmn.form.fieldAddonRight"></span></div>'),e.put("scripts/directives/coh-file-browser/coh-file-browser-image-uploader.html",'<button aria-label="Click to upload image" class="coh-file-browser-image-uploader" id="{{form.cohIdKey}}" ng-attr-aria-describedby="{{\n            hasError() ? form.cohIdKey + \'_error \' : undefined +\n            options.allowedDescription ? form.cohIdKey + \'_allowed\' : undefined\n         }}" ng-attr-aria-required="{{::form.required}}" ng-click="launchBrowser($event, form)" type="button"><div class="image-placeholder-wrapper"><img class="image-placeholder" ng-attr-title="{{preview ? preview.label : \'Placeholder image\'}}" ng-class="{\'coh-file-browser-preview coh-file-browser-preview-interactive\' : preview}" ng-src="{{preview ? preview.path : \'data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22220%22%20height%3D%22104%22%20viewBox%3D%220%200%20220%20104%22%3E%3Cpath%20fill%3D%22%23555%22%20d%3D%22M0%200h220v104H0z%22%2F%3E%3Cpath%20fill%3D%22%23333%22%20d%3D%22M3%2092l63-58%2044%2040%2055-50%2052%2048V3H3v89zm94-65a13%2013%200%201125%200%2013%2013%200%2001-25%200z%22%2F%3E%3C%2Fsvg%3E\'}}"></div></button> <span class="coh-description-allowed" id="{{form.cohIdKey + \'_allowed\'}}" ng-if="options.allowedDescription">{{options.allowedDescription}}</span>'),e.put("scripts/directives/coh-file-browser/coh-file-browser.html",'<div class="coh-file-browser-wrapper"><div class="row"><div class="col-xxs-12 col-xs-6"><button class="coh-btn coh-file-browser-button" id="{{form.cohIdKey}}" ng-attr-aria-describedby="{{\n                        hasError() ? form.cohIdKey + \'_error \' : undefined +\n                        options.allowedDescription ? form.cohIdKey + \'_allowed\' : undefined\n                    }}" ng-attr-aria-required="{{::form.required}}" ng-click="launchBrowser($event, form)" type="button">{{options.buttonText ? options.buttonText : \'Select file\'}}</button> <span class="coh-description-allowed" id="{{form.cohIdKey + \'_allowed\'}}" ng-if="options.allowedDescription">{{options.allowedDescription}}</span></div><div ng-if="preview.path" class="col-xxs-12 col-xs-6"><figure class="coh-file-browser-preview" ng-click="launchBrowser($event, form)"><img alt="{{preview.label}}" class="img-responsive" ng-src="{{preview.path}}" title="{{preview.label}}"><figcaption>{{preview.label}}</figcaption></figure></div><div ng-if="preview && !preview.path" class="coh-entity-preview col-xs-12"><div class="coh-entity-preview--inner" ng-click="launchBrowser($event, form)"><span>{{preview.label}}</span></div><button class="coh-file-browser-remove" ng-attr-aria-label="{{!form.options.removeLabel || form.options.imageUploader === true ? \'Remove\' : undefined}}" ng-click="remove()" ng-if="!dir.isVariableMode" type="button">{{form.options.imageUploader !== true ? form.options.removeLabel : undefined}}</button></div></div></div>'),e.put("scripts/directives/coh-file-uploader/coh-file-uploader.html",'<button class="coh-btn coh-btn-upload" ngf-accept="cfu.options.accept" ngf-change="cfu.uploadFile($file, $invalidFiles)" ngf-disabled="cfu.options.disabled" ngf-max-size="{{maxSize}}" ngf-model-options="cfu.options.modelOptions" ngf-multiple="cfu.options.multiple" ngf-select type="file"><span>{{cfu.form.buttonText ? cfu.form.buttonText : \'Select file\'}}</span> <span class="coh-btn-upload-icon coh-icon-circle-o" ng-if="!cfu.success && !cfu.loading && !cfu.model"></span> <span aria-label="Uploading" class="coh-btn-upload-icon coh-is-loading coh-preloader-x-small" ng-if="cfu.loading" role="alert"></span> <span aria-label="Upload successful" class="coh-btn-upload-icon coh-icon-check-circle" ng-if="!cfu.loading && (cfu.success || cfu.model)" role="alert"></span></button>'),e.put("scripts/directives/coh-form-builder-toolbar/coh-form-builder-toolbar.html",'<div class="coh-actions-bar" ng-if="!form.hideActionsBar"><div class="coh-title-input" ng-if="form.childField" ng-transclude></div><h2 class="tab-title" ng-if="form.label">{{form.label}}</h2><button aria-label="Add or remove CSS selectors" class="coh-btn coh-btn-default-parent" ng-click="openTreeMenu()" ng-if="!form.disableTreeMenu" tooltip-append-to-body="true" tooltip-class="coh-tooltip" type="button" uib-tooltip="Add/remove CSS selectors"><span class="coh-style-tree-selector">{{form.currentLevelTitle}}</span> <small class="coh-style-tree-badge" ng-if="showChildStyleCount()">{{getChildStyleCount()}}</small></button><coh-button form="fbtb.buttonOptions.variableSwitcher" ng-if="fbtb.variableModeAvailable"></coh-button><coh-button form="fbtb.buttonOptions.tokenBrowser" ng-if="fbtb.variableModeAvailable"></coh-button><coh-clean-form-button form="form" model="model" ng-if="!form.disableTreeMenu"></coh-clean-form-button><button aria-label="Open style helper menu" class="coh-style-helper-btn coh-icon-list-ul" ng-click="openStyleHelperMenu()" ng-if="!form.disableTreeMenu" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-left" type="button" uib-tooltip="Open style helper menu"></button> <button class="coh-btn coh-properties" ng-click="openPropertiesMenu()" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" type="button" uib-tooltip="{{ form.disableTreeMenu ? \'Open properties menu\' : \'Add CSS properties\' }}">Properties</button></div><coh-blades-menu change-form-fn="changeForm" form="form" initialise-tree-menu="initialiseTreeMenu" loaded="loaded" model="model" open-tree-fn="openTreeFn"></coh-blades-menu><coh-properties-menu form="form" model="model" open-properties-menu-fn="openPropertiesMenuFn" options-key="form.propertyOptionsKey"></coh-properties-menu><coh-style-helper form="form" model="model" open-style-helper-menu-fn="openStyleHelperMenuFn"></coh-style-helper>'),e.put("scripts/directives/coh-form-builder/coh-form-builder.html",'<div coh-var-switcher-shortcut><div class="coh-style-builder-container"><coh-form-builder-toolbar><sf-decorator form="form.childField"></sf-decorator></coh-form-builder-toolbar><div class="form-body-main main-vertical-scrollbar coh-scrollbars" coh-scrollbar-container><sf-decorator class="coh-type-{{item.type}}" form="item" ng-repeat="item in form.items | orderBy: \'weight\'"></sf-decorator></div></div></div>'),e.put("scripts/directives/coh-form-preview/coh-form-preview.html",'<form class="coh-form-preview" isolate-form><div class="coh-form-preview-inner"><div class="coh-form-preview-header">{{fpw.formTitle}}</div><div class="coh-form-preview-body"><div class="" ng-if="fpw.loaded && fpw.sf.form[0].items.length < 2">This form doesn\'t have any editable settings.</div><div ng-class="fpw.loaded === true ? \'coh-is-loaded\' : \'coh-is-loading\'" sf-schema="fpw.sf.schema" sf-form="fpw.sf.form" sf-model="fpw.sf.model" class="coh-form coh-layout-canvas-settings-form coh-preloader-large" ng-submit="false"><sf-decorator ng-repeat="item in fpw.sf.form" form="item"></sf-decorator></div></div><div class="coh-form-preview-footer"></div></div></form>'),e.put("scripts/directives/coh-google-marker/coh-google-marker.html",'<div class="coh-google-map-marker"><div class="row"><div class="col-xs-12"><div class="form-group coh-text-box"><div class="form-group-inner"><label class="control-label" for="address-{{gmw.form.key | join:\'-\'}}"><coh-label-text tt-text="::gmw.form.tooltipText" tt-place="::gmw.form.tooltipPlacement" tt-label="::\'Address\'"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-cohTextbox"><input class="form-control" id="address-{{gmw.form.key | join:\'-\'}}" ng-model="address" ng-value="{{address}}" step="any" type="text"> <input name="{{gmw.form.key.slice(-1)[0]}}" ng-model="gmw.ngModel" schema-validate="gmw.form" type="hidden"></div></div></div></div><div class="form-group coh-btn-container"><div class="form-group-inner"><button class="coh-btn" ng-click="findCoordinates(address)" type="button"><span>Find coordinates</span></button></div></div></div></div><div class="row"><div class="col-xxs-12 col-xs-6"><div class="form-group coh-text-box coh-form-group-lat-lng"><div class="form-group-inner"><label class="control-label" for="latitude-{{ gmw.form.key | join:\'-\' }}" ng-class="::{\'coh-required\' : gmw.form.required}">Latitude</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-cohTextbox" ng-class="{\'has-error\': $parent.disableErrorState !== true && hasSchemaError($parent)}"><input class="form-control" id="latitude-{{ gmw.form.key | join:\'-\' }}" ng-attr-aria-describedby="{{hasSchemaError($parent) ? gmw.form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-invalid="{{hasSchemaError($parent)}}" ng-attr-aria-required="{{::gmw.form.required}}" ng-model="latCode" ng-value="{{latCode}}" step="any" type="text"></div></div></div></div></div><div class="col-xxs-12 col-xs-6"><div class="form-group coh-text-box coh-form-group-lat-lng"><div class="form-group-inner"><label class="control-label" for="longitude-{{ gmw.form.key | join:\'-\' }}" ng-class="::{\'coh-required\' : gmw.form.required}">Longitude</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-cohTextbox" ng-class="{\'has-error\': $parent.disableErrorState !== true && hasSchemaError($parent)}"><input class="form-control" id="longitude-{{ gmw.form.key | join:\'-\' }}" ng-attr-aria-describedby="{{hasSchemaError($parent) ? gmw.form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-invalid="{{hasSchemaError($parent)}}" ng-attr-aria-required="{{::gmw.form.required}}" ng-model="longCode" ng-value="{{longCode}}" step="any" type="text"></div></div></div></div></div><div class="col-xs-12"><div class="form-group"><div class="form-group-inner"><ng-transclude></ng-transclude></div></div></div><div class="col-xs-12"><div class="form-group coh-btn-container"><div class="form-group-inner"><button class="coh-btn" ng-click="previewMarker(latCode, longCode)" type="button"><span>Preview</span></button></div></div></div></div><div class="row"><div class="col-xs-12"><label class="control-label">Preview</label><div class="coh-preview-marker-container" ng-class="{\'coh-preview-marker-container-error\': error}"><iframe frameborder="0" height="100%" ng-if="!error" ng-src="{{previewUrl}}" title="Google Map preview" width="100%"></iframe><p ng-if="error">{{ error }}</p></div></div></div></div>'),e.put("scripts/directives/coh-gradient-picker/coh-gradient-picker.html",'<div class="gradient-preview-wrap"><div class="gradient-preview-model" ng-click="togglePicker();$event.stopPropagation()" ng-show="model" ng-attr-style="{{\'background:\' + model}}"></div><div class="gradient-preview-no-model" ng-click="togglePicker();$event.stopPropagation()" ng-show="!model"></div></div><input ng-hide="true" ng-model="model" schema-validate="form"> <span class="coh-description" ng-class="{\'coh-form-hidden\': !form.description}" sf-message="form.description"></span><div ng-show="open" class="gradient-picker-popup" ng-click="$event.stopPropagation();"></div>'),e.put("scripts/directives/coh-grid-preview/coh-grid-preview.html",'<div class="coh-responsive-grid-preview-pane"><div class="coh-responsive-grid-preview-container coh-scrollbars"><div class="coh-responsive-grid-preview-container-rule"><div class="coh-responsive-grid-preview-container-inner" ng-style="cgp.containerInnerStyle"><div class="coh-responsive-grid-preview-row-wrapper"><div class="coh-responsive-grid-preview-row" ng-style="cgp.rowStyle"><div class="coh-responsive-grid-preview-column" ng-repeat="n in cgp.bp.previewColumns|number|range track by $index" ng-if="(cgp.bp.previewColumns|number) > 0" ng-style="cgp.colStyle"><span class="coh-responsive-grid-preview-column-inner"></span></div></div></div></div></div></div></div>'),e.put("scripts/directives/coh-helper-switcher/coh-helper-switcher.html",'<button ng-click="chsw.toggleHelpers()" class="coh-btn coh-btn-icon-only {{chsw.form.style}} {{chsw.form.fieldHtmlClass}}" ng-disabled="chsw.form.readonly"><span ng-class="{on:chsw.helperMode}" class="coh-icon-question-circle"></span></button>'),e.put("scripts/directives/coh-hidden-field-selector/coh-hidden-field-selector.html",'<div class="coh-ellipsis-dropdown" keyboard-nav ng-click="$event.stopPropagation();" on-toggle="hfs.onToggleDrop(open)" tabindex="-1" uib-dropdown><button aria-label="Add or remove properties" class="coh-icon-ellipsis" id="coh-ellipsis-dropdown-btn-{{::$id}}" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" type="button" uib-dropdown-toggle uib-tooltip="Add/remove properties"></button><ul aria-labelledby="coh-ellipsis-dropdown-btn-{{::$id}}" class="dropdown-menu dropdown-menu-right" role="menu" uib-dropdown-menu><li class="dropdown-item" ng-class="{\'coh-checked\' : item.isActive}" ng-if="!item.conditional" ng-repeat="item in ::hfs.availableFields" role="menuitem"><label><span class="coh-checkbox-label">{{::item.title}}</span> <span class="coh-checkbox-input-wrapper"><input class="coh-checkbox-input" id="{{::item.key|join:\'-\'}}-{{$index}}" ng-change="hfs.toggleActive(false, item)" ng-disabled="item.conditional" ng-model="item.isActive" type="checkbox"></span></label></li></ul></div>'),e.put("scripts/directives/coh-icon-picker-opener/coh-icon-picker-opener.html",'<button type="button" id="{{ipo.form.cohIdKey}}" ng-click="ipo.openPickerMenu()" class="picker-representation"><span class="current-icon" ng-class="{\'current-icon-empty\': !ipo.model.iconName}"><span ng-if="!ipo.model.iconName">Choose icon</span></span></button>'),e.put("scripts/directives/coh-icon-picker/coh-icon-picker.html",'<div><div ng-show="!form.iconPickerLoading"><input type="text" id="font-icon-picker" name="e9_element"></div><div class="loader" ng-class="{\'coh-is-loading coh-preloader-medium\' : form.iconPickerLoading && !form.noIconLibraries}" ng-show="form.iconPickerLoading || form.noIconLibraries"><p ng-if="form.noIconLibraries">No icon libraries found.</p></div></div>'),e.put("scripts/directives/coh-label-text/coh-label-text.html",'<span class="coh-label-text" tooltip-append-to-body="true" ng-attr-tooltip-class="{{::clt.ttText ? \'coh-tooltip coh-tooltip--field\' : undefined}}" ng-attr-tooltip-placement="{{::clt.ttText ? clt.ttPlace : undefined}}" ng-attr-uib-tooltip="{{::clt.ttText}}" ng-class="{\'coh-field-tooltip-enabled\' : clt.ttText}">{{:: clt.ttLabel}}</span>'),e.put("scripts/directives/coh-layout-canvas/coh-layout-canvas-image-browser-modal.html",'<div class="coh-modal coh-layout-canvas-image-browser-modal"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">{{cibm.title}}</h4><span ng-click="$dismiss(\'cancel\')" class="coh-icon-cancel-circle"></span></div><div class="modal-body coh-preloader-large" ng-class="{\'coh-is-loaded\': cibm.loaded, \'coh-is-loading\': !cibm.loaded}" id="modal-body"><iframe ng-onload="cibm.iframeLoaded();" onload="entityBrowserCallback(this);" ng-src="{{cibm.url}}" ng-class="{\'visible\': cibm.loaded, \'hidden\': !cibm.loaded}" title="{{cibm.title}}"></iframe></div></div></div>'),e.put("scripts/directives/coh-layout-canvas/coh-layout-canvas-nodes-renderer.html",'<coh-dynamic-nodes-renderer class="coh-layout-canvas-list-container coh-disable-animation" coh-dynamic-nodes-renderer-view="clnr.getView" coh-suspendable ng-if="node.isContainer && !clnr.node.status.collapsed" ng-model="node" node="node" uib-collapse="node.status.collapsed"></coh-dynamic-nodes-renderer><script id="coh-layout-canvas-nodes-renderer-list.html" type="text/ng-template"><ol class="coh-layout-canvas-list coh-layout-canvas-list-dropzone"\n        data-element="{{::node.type}}"\n        data-uid="{{::node.uid}}"\n        data-mimicparent="{{::node.mimicParent}}"\n        data-parentuid="{{node.parentUid}}"\n        id="{{node.uuid}}"\n        ng-class="[clnr.getFlexColClass(node), {\n            \'coh-layout-canvas-list-empty\' : node.isContainer && node.children.length <= 0,\n            \'coh-layout-canvas-root\' : node.uid === \'root\',\n            \'coh-layout-canvas-root-empty\' : node.uid === \'root\' && node.children.length <= 0,\n            \'coh-layout-canvas-column-parent\' : node.uid !== \'root\' && clnr.isColumnParent(node),\n            \'coh-sortable-disabled\': node.type === \'component\' || node.disabled == true\n        }]"\n        ng-model="node.children"\n        ui-sortable="clnr.sortableOptions">\n        <li class="coh-layout-canvas-list-item ng-animate-disabled"\n            coh-column-classes="{{child.uuid}}"\n            coh-keyboard-select="clnr.addElement(child)"\n            data-element="{{child.uid}}"\n            data-type="{{clnr.getName(child)}}"\n            ng-attr-tabindex="{{ !child.isContainer || child.uid === \'cpt_dropzone\' ? -1 : 0 }}"\n            ng-class="[clnr.nodeStatus[child.uuid].breakpointClasses, {\n                \'coh-layout-canvas-list-item-type-{{child.type}}\': true,\n                \'coh-layout-canvas-list-item-collapsed\' : child.status.collapsed === true,\n                \'coh-layout-canvas-list-item-loading\': clnr.nodeStatus[child.uuid].loading === true,\n                \'coh-layout-canvas-list-item-selected\' : clnr.nodeStatus[child.uuid].selected === true,\n                \'coh-layout-canvas-list-item-error\' : clnr.nodeStatus[child.uuid].error === true,\n                \'coh-layout-canvas-list-item-edited\' : clnr.nodeStatus[child.uuid].modified === true,\n                \'coh-layout-canvas-list-item-new\' : clnr.nodeStatus[child.uuid].new === true,\n                \'coh-layout-canvas-list-item-highlighted\' : clnr.nodeStatus[child.uuid].previewHighlighted === true,\n                \'coh-sortable-disabled coh-layout-canvas-component-drop-zone\' : child.uid === \'component-drop-zone\',\n                \'coh-layout-canvas-list-item-disabled coh-sortable-disabled\' : child.disabled === true\n            }]"\n            ng-if="!child.status.disabled && child.uuid !== \'placeholder\'"\n            ng-mouseenter="clnr.mouseEnter($event, child)"\n            ng-mouseleave="clnr.mouseLeave($event, child)"\n            ng-repeat="child in node.children track by child.uuid">\n            <div class="coh-layout-canvas-utils coh-layout-canvas-utils-item {{child.isContainer ? \'coh-layout-canvas-utils-container\' : \'\'}}"\n                 coh-keyboard-select="clnr.editElement($event, child)"\n                 ng-click="$event.stopPropagation();"\n                 ng-dblclick="clnr.editElement($event, child)"\n                 ng-attr-tabindex="{{ child.uid === \'component-drop-zone\' ? -1 : 0 }}">\n                <span ng-class="clnr.getChildClasses(child)" ng-click="clnr.addElement(child)" tabindex="-1">\n                    {{clnr.getName(child)}}<code ng-if="child.type === \'form-field\' || child.type === \'form-field-container\'" ng-class="{\'coh-machine-name-error\': clnr.getFieldName(child) === \'\'}">{{clnr.getFieldName(child) || \'[Machine name not set]\'}}</code>\n                </span>\n                <div class="coh-layout-canvas-toolbar"\n                     ng-dblclick="$event.stopPropagation();"\n                     ng-click="$event.stopPropagation();"\n                     tabindex="-1">\n                    <button class="coh-expand-btn coh-expand-icon"\n                            ng-attr-aria-label="{{child.status.collapsed ? \'Expand element\' : \'Collapse element\'}}"\n                            ng-class="{\'coh-layout-canvas-expand-highlighted\': clnr.nodeStatus[child.uuid].previewHighlightedParent === true}"\n                            ng-click="clnr.toggleElement(child, child.children)"\n                            ng-if="child.isContainer && !child.componentContentId"\n                            tooltip-append-to-body="true"\n                            tooltip-class="coh-tooltip"\n                            tooltip-placement="top-right"\n                            type="button"\n                            uib-tooltip="{{ child.status.collapsed ? \'Expand element\' : \'Collapse element\' }}"></button>\n                    <button class="coh-add-btn coh-icon-plus"\n                            ng-click="clnr.addElement(child);"\n                            ng-if="::child.uid === \'component-drop-zone\'"\n                            type="button"></button>\n                    <div auto-close="outsideClick"\n                         class="coh-layout-canvas-utils-dropdown"\n                         coh-suspendable\n                         dropdown-append-to-body="true"\n                         is-open="clnr.nodeStatus[child.uuid].ellipsisOpen"\n                         keyboard-nav\n                         ng-if="::child.uid !== \'component-drop-zone\'"\n                         uib-dropdown>\n                        <button aria-label="More actions"\n                                class="coh-menu-btn"\n                                tooltip-append-to-body="true"\n                                tooltip-class="coh-tooltip"\n                                tooltip-placement="top-right"\n                                type="button"\n                                uib-dropdown-toggle\n                                uib-tooltip="{{ child.type === \'component\' ? \'Component options\' : child.type === \'form-field\' ? \'Field options\' : \'Element options\' }}">\n                        </button>\n                        <ul class="dropdown-menu-right coh-layout-canvas-utils-dropdown-menu coh-dropdown-menu" uib-dropdown-menu>\n                            <li>\n                                <button class="coh-edit-btn" ng-click="clnr.editElement($event, child)" type="button">\n                                    <span>Edit (Double click)</span>\n                                </button>\n                                <hr ng-if="::!child.isContainer">\n                            </li>\n                            <li ng-if="::child.isContainer && !child.componentId">\n                                <button class="coh-add-btn" ng-click="clnr.addElement(child)" type="button">\n                                    <span>Add</span>\n                                </button>\n                                <hr>\n                            </li>\n                            <li ng-if="::clnr.showCopy(child, node)">\n                                <button class="coh-copy-btn" ng-click="clnr.copyElement(child, node, $index)" type="button">\n                                    <span>Duplicate</span>\n                                </button>\n                            </li>\n                            <li ng-if="clnr.showSave(child, node)">\n                                <button class="coh-save-btn" ng-click="clnr.saveElement(child, node)" type="button">\n                                    <span>Save</span>\n                                </button>\n                            </li>\n                            <li ng-if="::clnr.showConfigureLink(child)">\n                                <a class="btn coh-configure-btn" ng-href="{{clnr.getConfigureLink(child.componentId, child.componentContentId)}}" type="button">\n                                    <span>Configure</span>\n                                </a>\n                            </li>\n                            <li ng-if="::clnr.showDeleteDisable(child, node)">\n                                <button class="coh-delete-btn" ng-click="clnr.deleteElement(child, node, $index)" ng-if="clnr.showDelete(child, node)" type="button">\n                                    <span>Delete</span>\n                                </button>\n                                <button class="coh-disable-btn" ng-click="clnr.disableElement(child, node, $index)" ng-if="!clnr.showDelete(child, node)" type="button">\n                                    <span>Disable</span>\n                                </button>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <coh-dynamic-nodes-renderer\n                class="coh-layout-canvas-list-container coh-disable-animation"\n                coh-dynamic-nodes-renderer-view="clnr.getView"\n                coh-suspendable\n                ng-if="child.isContainer && !child.status.collapsed && !child.componentContentId"\n                ng-model="child"\n                node="child"\n                uib-collapse="node.status.collapsed">\n            </coh-dynamic-nodes-renderer>\n        </li>\n    </ol><\/script>'),e.put("scripts/directives/coh-layout-canvas/coh-layout-canvas-save-modal.html",'<div class="coh-modal coh-layout-canvas-save-modal"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">Save layout</h4><span ng-click="$dismiss(\'cancel\')" class="coh-icon-cancel-circle"></span></div><div class="modal-body" id="modal-body"><form ng-class="csem.loaded == true ? \'coh-is-loaded\' : \'coh-is-loading\'" sf-schema="csem.form.schema" sf-form="csem.form.form" sf-model="csem.form.model" class="coh-form save-modal-form coh-preloader-large"></form></div><div class="modal-footer"><button type="button" class="coh-btn coh-modal-btn--cancel" ng-click="$dismiss(\'cancel\')">Cancel</button> <button type="button" class="coh-btn coh-btn-alt coh-modal-btn--save" ng-disabled="!csem.form.model.title || !csem.form.model.category" ng-click="csem.saveBlock()">Save</button></div></div></div>'),e.put("scripts/directives/coh-layout-canvas/coh-layout-canvas-settings-modal.html",'<div class="modal-header"><div class="modal-header-nav"><h1 class="coh-modal-title">{{element.title}}</h1><button aria-label="Close sidebar editor" autofocus class="coh-btn coh-btn-alt close" ng-click="close()" type="button"></button></div></div><div class="modal-body" tabindex="-1"><form class="coh-form coh-layout-canvas-settings-form coh-preloader-large coh-layout-canvas-settings-form-{{element.type}}" ng-class="loaded == true ? \'coh-is-loaded\' : \'coh-is-loading\'" sf-schema="sf.schema" sf-form="sf.form" sf-options="sf.options" sf-model="model" name="elementForm"></form></div><div class="modal-footer"><div class="modal-footer-nav"><ul><li><button type="button" class="cancel" ng-click="close()">Cancel</button></li><li ng-if="elementForm.$invalid && elementForm.$submitted" class="coh-invalid">Please ensure you have no invalid properties.</li><li ng-if="canSaveAsComponentContent(element) && !element.componentContentId" class="coh-multi-button"><div class="btn-group apply dropup" auto-close="true" is-open="saveButton.isOpen" uib-dropdown><button type="button" class="coh-btn coh-btn-alt" ng-disabled="!loaded" ng-click="save()">Apply</button> <button aria-label="More options" type="button" uib-dropdown-toggle class="coh-btn coh-btn-alt" ng-disabled="!loaded"><span ng-class="{\'coh-icon-caret-down\':!saveButton.isOpen,\'coh-icon-caret-up\':saveButton.isOpen}"></span></button><div class="dropdown-menu" uib-dropdown-menu><div class="form-group"><button type="button" class="coh-btn coh-btn-alt" ng-click="saveContent()" ng-disabled="!loaded">Save as component content</button></div></div></div></li><li ng-if="canSaveAsComponentContent(element) && element.componentContentId"><button type="button" ng-disabled="!loaded" class="apply" ng-click="close()">Done</button></li><li ng-if="!canSaveAsComponentContent(element)"><button type="button" ng-disabled="!loaded" class="apply" ng-click="save()">Apply</button></li></ul></div></div>'),e.put("scripts/directives/coh-layout-canvas/coh-layout-canvas.html",'<div class="coh-layout-canvas" ng-class="{\'coh-form-canvas\' : clc.layoutOptions.formBuilder}"><div class="coh-layout-canvas-mode-switch" ng-if="clc.options.showPreview"><span class="coh-preview-label">Preview</span> <button class="ng-animate-disabled" ng-class="{\n                    \'coh-icon-eye\' : clc.mode === \'layout\',\n                    \'coh-icon-eye-slash\' : clc.mode === \'preview\'\n                    }" ng-click="clc.toggleMode()" tooltip-class="coh-tooltip" tooltip-placement="top-right" type="button" uib-tooltip="{{ clc.mode === \'layout\' ? \'Show inline preview\' : \'Hide inline preview\' }}"><span class="button-text visually-hidden">{{ clc.mode === \'layout\' ? \'Show inline preview\' : \'Hide inline preview\' }}</span></button> <a class="ng-animate-disabled coh-icon-eye-external" aria-label="Open preview in new window" ng-click="clc.toggleMode(\'layout\')" href="{{clc.popupUrl}}" target="_blank" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Open preview in new window"></a></div><div class="coh-layout-canvas-preview" ng-if="bUseDX8 && clc.options.showPreview && clc.mode === \'preview\'"><coh-canvas-preview options="clc.form.previewOptions" coh-canvas-name="clc.canvasName" coh-in-canvas="true" coh-key="clc.key"></div><div class="coh-layout-canvas-layout" ng-if="bUseDX8 && clc.mode === \'layout\'"><div class="coh-layout-canvas-header" ng-if="!clc.options.hideHeader"><div class="coh-layout-canvas-nav"><ul><li ng-if="clc.showAddElement()"><button aria-label="{{ clc.layoutOptions.formBuilder ? \'Add form fields\' : \'Add content\' }}" class="coh-btn coh-icon-plus element-browser coh-default-browser-launcher" ng-class="clc.nodeStatus[clc.node.uuid].selected && clc.isTop() ? \'coh-is-active\' : \'coh-btn-alt\'" ng-click="clc.addElement(clc.node, true)" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-left" type="button" uib-tooltip="{{ clc.layoutOptions.formBuilder ? \'Add form fields\' : \'Add content\' }}"></button></li><li ng-if="clc.showAddElement() && clc.node.disabled"><i class="coh-icon-locked disabled" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-left" uib-tooltip="The layout canvas is locked. You cannot add components outside of the component content."></i></li><li><div class="btn-group" dropdown-append-to-body="true" is-open="status.isopen" keyboard-nav uib-dropdown><button class="coh-btn coh-layout-canvas-options-btn" ng-attr-id="{{\'coh-canvas-options-btn-top-\' + clc.key + (clc.layoutOptions.formBuilder ? \'_fb\' : \'_lc\')}}" ng-class="status.isopen ? \'coh-icon-caret-up\' : \'coh-icon-caret-down\'" ng-disabled="disabled" uib-dropdown-toggle type="button">Options</button><ul class="coh-dropdown-menu dropdown-menu-right" ng-attr-aria-labelledby="{{\'coh-canvas-options-btn-top-\' + clc.key + clc.layoutOptions.formBuilder ? \'_fb\' : \'_lc\'}}" role="menu" uib-dropdown-menu><li role="menuitem"><button class="btn btn-text coh-save-all-btn" ng-click="clc.saveAll()" type="button"><span>Save as</span></button></li><li role="menuitem"><button class="btn btn-text coh-collapse-all-btn" ng-click="clc.toggleAll(true)" type="button"><span>Collapse all</span></button></li></ul></div></li></ul></div></div><div class="coh-layout-canvas-body"><div class="coh-layout-canvas-zone"><coh-layout-canvas-nodes-renderer add-element-fn="clc.addElement" coh-suspendable disabled-nodes="clc.disabledNodes" forms="clc.forms" layout-options="clc.layoutOptions" modals="clc.modals" ng-model="clc.model" node="clc.node"></coh-layout-canvas-nodes-renderer></div></div><div class="coh-layout-canvas-footer" ng-if="!clc.options.hideFooter"><div class="coh-layout-canvas-nav"><ul><li ng-if="clc.showAddElement()"><button aria-label="{{ clc.layoutOptions.formBuilder ? \'Add form fields\' : \'Add content\' }}" class="coh-btn coh-icon-plus element-browser" ng-class="clc.nodeStatus[clc.node.uuid].selected && !clc.isTop() ? \'coh-is-active\' : \'coh-btn-alt\'" ng-click="clc.addElement(clc.node, false)" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-left" type="button" uib-tooltip="{{ clc.layoutOptions.formBuilder ? \'Add form fields\' : \'Add content\' }}"></button></li><li ng-if="clc.showAddElement() && clc.node.disabled"><i class="coh-icon-locked disabled" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-left" uib-tooltip="The layout canvas is locked. You cannot add components outside of the component content."></i></li><li><div class="btn-group" dropdown-append-to-body="true" is-open="status.isopen" keyboard-nav uib-dropdown><button class="coh-btn coh-layout-canvas-options-btn" ng-attr-id="{{\'coh-canvas-options-btn-bottom-\' + clc.key + (clc.layoutOptions.formBuilder ? \'_fb\' : \'_lc\')}}" ng-class="status.isopen ? \'coh-icon-caret-up\' : \'coh-icon-caret-down\'" ng-disabled="disabled" uib-dropdown-toggle type="button">Options</button><ul class="coh-dropdown-menu dropdown-menu-right" ng-attr-aria-labelledby="{{\'coh-canvas-options-btn-bottom-\' + clc.key + clc.layoutOptions.formBuilder ? \'_fb\' : \'_lc\'}}" role="menu" uib-dropdown-menu><li role="menuitem"><button class="btn btn-text coh-save-all-btn" ng-click="clc.saveAll()" type="button"><span>Save as</span></button></li><li role="menuitem"><button class="btn btn-text coh-collapse-all-btn" ng-click="clc.toggleAll(true)" type="button"><span>Collapse all</span></button></li></ul></div></li></ul></div></div></div><div class="coh-layout-canvas-disabled" ng-if="::!bUseDX8">Layout canvas disabled</div></div>'),e.put("scripts/directives/coh-media-embed/coh-media-embed.html",'<div class="coh-media-embed-preview"><div class="coh-media-embed-preview-container" ng-class="{\'no-preview\': !cme.previewUrl}"><label class="control-label">Preview<div class="coh-media-embed-preview-container-inner"><p ng-if="!cme.previewUrl && cme.ngModel.$valid">No preview available</p><div ng-if="cme.model.styles.settings.element === \'media\' && cme.ngModel.$invalid"><p>The video URL you have entered is not supported. Supported formats include Youtube, Vimeo, MP4, OGG, WebM and MKV.</p><p>Please read the <a href="{{::cme.helpUrl}}" target="_blank">Video element support documentation</a> for more information.</p></div><div ng-if="cme.model.styles.settings.element === \'video-background\' && cme.ngModel.$invalid"><p>The video URL you have entered is not supported. Supported formats include MP4, OGG, WebM and MKV.</p><p>Please read the <a href="{{::cme.helpUrl}}" target="_blank">Video background element support documentation</a> for more information.</p></div><video class="coh-media-embed-player" controls="{{cme.model.styles.settings.element === \'video-background\'}}" id="{{cme.getPlayerID()}}" ng-class="{\'mejs__player\':cme.model.styles.settings.element !== \'video-background\'}" ng-if="cme.previewUrl" ng-src="{{cme.previewUrl | trustUrl}}"></video></div></label></div></div>'),e.put("scripts/directives/coh-modal-section/coh-modal-section-modal.html",'<div class="coh-modal coh-layout-canvas-save-modal"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">{{cmsm.formElement.modalTitle}}</h4><span ng-click="$dismiss(\'cancel\')" class="coh-icon-cancel-circle"></span></div><div class="modal-body" id="modal-body"><form ng-class="cmsm.loaded == true ? \'coh-is-loaded\' : \'coh-is-loading\'" sf-schema="cmsm.form.schema" sf-form="cmsm.form.form" sf-model="cmsm.form.model" class="coh-form save-modal-form coh-preloader-large"></form></div><div class="modal-footer"><button type="button" ng-if="cmsm.formElement.showDelete" class="btn-link coh-btn-modal-warn" ng-click="cmsm.clear()">Delete</button> <button type="button" class="coh-btn" ng-click="$dismiss(\'cancel\')">Cancel</button> <button type="button" class="coh-btn coh-btn-alt" ng-click="cmsm.save()">Save</button></div></div></div>'),e.put("scripts/directives/coh-modal-section/coh-modal-section.html",'<button class="coh-btn coh-btn-upload" ng-click="cms.openModal($event, form)" ng-disabled="$eval(form.readonly.toString()) || $eval(form.disabled.toString())" title="{{form.title && form.hideText ? form.title : \'\'}}" type="button"><span ng-if="form.title && !form.hideText">{{form.title}}</span> <span class="coh-btn-upload-icon {{form.iconClass}}" ng-if="form.iconClass"></span></button><ng-transclude></ng-transclude>'),e.put("scripts/directives/coh-multi-button/coh-multi-button.html",'<div class="coh-multi-button" ng-class="form.htmlClass"><div auto-close="{{form.autoClose || true}}" class="btn-group" is-open="form.isOpen" ng-class="form.style" uib-dropdown><button class="coh-btn coh-btn-alt" ng-disabled="$eval(form.readonly.toString()) || $eval(form.disabled.toString())" ng-click="buttonClick($event,form)" type="button">{{form.title}}</button> <button aria-label="More options" class="coh-btn coh-btn-alt" type="button" uib-dropdown-toggle><span ng-class="{\'coh-icon-caret-down\':!form.isOpen,\'coh-icon-caret-up\':form.isOpen}"></span></button><div class="dropdown-menu" uib-dropdown-menu><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="{\'coh-form-group-last\':$last}" ng-repeat="item in form.items"></sf-decorator></div></div><span class="coh-description" ng-class="{\'coh-form-hidden\': !form.description}" sf-message="form.description"></span></div>'),e.put("scripts/directives/coh-picker-menu/coh-picker-menu.html",'<div class="coh-blades-menu coh-picker-menu" ng-class="{active:cpim.menu.open}"><div class="blade blade1 not-active" ng-class="{\'not-active\': !cpim.menu.blades[1].currentPicker}" ng-if="cpim.menu.blades[1].currentPicker"><div class="lockout" ng-click="cpim.selectSubBlade()" tabindex="-1"></div><div class="content"><div class="content-inner" coh-sticky><div class="back-container"><button aria-label="Back to previous menu" class="coh-back-btn coh-icon-angle-double-left" coh-auto-focus ng-click="cpim.back()" type="button"></button></div><div class="coh-colour-picker picker"><coh-colour-picker ng-model="cpim.fieldModel.subColour" sf-field-model="replaceAll" options="cpim.subColourPickerForm.colourPickerOptions" reset="cpim.reset" coh-tag-id spinner-size="\'medium\'" form="cpim.subColourPickerForm"></coh-colour-picker></div><div class="picker-actions-bar"><button type="button" class="coh-btn" ng-click="cpim.revertSubBlade()">Revert</button> <button type="button" class="coh-btn coh-btn-alt" ng-click="cpim.selectSubBlade()">Select</button></div></div></div></div><div class="blade blade2 not-active" ng-class="{\'not-active\':!cpim.menu.blades[0].currentPicker}" ng-if="cpim.menu.blades[0].currentPicker"><div class="lockout" ng-click="cpim.close()" tabindex="-1"></div><div class="content"><div class="content-inner" coh-sticky><div class="back-container"><button aria-label="Close menu" class="coh-back-btn coh-icon-angle-double-left" coh-auto-focus ng-click="cpim.close()" type="button"></button></div><div ng-show="cpim.menu.blades[0].currentPicker===\'colour\'" class="coh-colour-picker picker"><coh-colour-picker ng-model="cpim.fieldModel.colour" sf-field-model="replaceAll" options="cpim.form.colourPickerOptions" reset="cpim.reset" coh-tag-id spinner-size="\'medium\'" form="cpim.form"></coh-colour-picker></div><div ng-if="cpim.menu.blades[0].currentPicker===\'icon\'" class="picker coh-icon-picker" ng-class="{\'picker-hidden\': cpim.menu.blades[0].currentPicker!==\'icon\'}"><coh-icon-picker model="cpim.fieldModel.icon" form="cpim.form"></coh-icon-picker></div><div ng-if="cpim.menu.blades[0].currentPicker===\'gradient\'" class="picker coh-gradient-picker" ng-class="{\'picker-hidden\': cpim.menu.blades[0].currentPicker!==\'gradient\'}"><coh-gradient-picker ng-model="cpim.fieldModel.gradient" form="cpim.form" options="cpim.form.options" grad-x="cpim.gradX"></coh-gradient-picker></div><div class="picker-actions-bar"><button type="button" class="coh-btn coh-picker-btn--revert" ng-click="cpim.revert()">Revert</button> <button type="button" class="coh-btn coh-btn-alt coh-picker-btn--select" ng-click="cpim.close()">Select</button></div></div></div></div></div>'),e.put("scripts/directives/coh-preview-warning-icon/coh-preview-warning-icon.html",'<span ng-if="!cpwi.canPreview" class="coh-icon-eye-slash" uib-tooltip="This value will not be reflected in the preview." tooltip-placement="left"></span>'),e.put("scripts/directives/coh-properties-menu-button/coh-properties-menu-button.html",'<span class="coh-btn properties" ng-click="pmb.openPropertiesMenu()">Properties <span class="coh-icon-plus-circle"></span></span>'),e.put("scripts/directives/coh-properties-menu/coh-properties-menu.html",'<div class="coh-blades-menu coh-properties-menu" ng-class="{active:cpm.menu.open}"><div class="blade {{\'blade\'+($index+1)}}" ng-repeat="blade in cpm.menu.blades| orderBy:\'+\': true"><div class="lockout" ng-click="cpm.closePropertiesMenu()" ng-if="$index === 0" tabindex="-1"></div><div class="content"><div class="level-selector" ng-click="cpm.back()" ng-if="cpm.menu.blades.length===2"></div><div class="content-inner" coh-sticky><div class="back-container"><button aria-label="Back to previous menu" class="coh-back-btn coh-icon-angle-double-left" coh-auto-focus ng-click="cpm.back()" type="button"></button></div><div ng-class="{\'coh-checked\' : option.active}" ng-repeat="option in blade.options"><div class="list-element title" ng-click="cpm.openSubOptions(option, $event)" ng-if="option.options"><span class="coh-property-title">{{option.title}}</span> <span class="coh-icon-caret-right options-icon {{option.icon?\'coh-icon-\'+option.icon:\'\'}}"></span></div><label class="list-element" for="{{\'property-\'+option.title}}" ng-click="cpm.fnOptionClick(option)" ng-if="!option.options" ng-hide="option.disabled" tabindex="-1"><span class="coh-checkbox-label">{{option.title}}</span> <span class="coh-checkbox-input-wrapper" ng-if="!option.noCheckbox"><input class="coh-checkbox-input" id="{{\'property-\'+option.title}}" ng-change="cpm.togglePropertyGroup(option)" ng-disabled="cpm.working" ng-model="option.active" type="checkbox"> </span><span ng-if="option.icon" class="options-icon {{\'coh-icon-\'+option.icon}}"></span></label></div></div></div></div></div>'),e.put("scripts/directives/coh-range/coh-range.html",'<div class="coh-range-container"><span class="coh-range-value coh-range-value--min">{{ form.min }}</span><div class="coh-range-container-inner" ng-transclude></div><span class="coh-range-value coh-range-value--max">{{ form.max }}</span></div>'),e.put("scripts/directives/coh-section/coh-section.html",'<div class="coh-section-inner" is-disabled="form.isDisabled" ng-class="form.htmlClass"><div class="coh-section-header" ng-if="!form.hideRowHeading && form.title"><h3 class="coh-section-heading" ng-show="!form.editing"><span>{{::form.title}}</span></h3><ul class="coh-section-actions" ng-if="helpUrl || form.breakpoints || !form.disableEllipsisMenu"><li class="coh-section-help" ng-if="helpUrl"><a aria-label="Open support article in new window" class="coh-icon-question-circle" href="{{::helpUrl}}" target="_blank" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Help and support"></a></li><li class="coh-breakpoints" ng-if="form.breakpoints"><coh-breakpoint-selector form="form" model="model" sf-field-model="replaceAll"></coh-breakpoint-selector></li><li class="coh-section-ellipsis" ng-if="!form.disableEllipsisMenu"><coh-hidden-field-selector form="form" model="model" sf-field-model="replaceAll"></coh-hidden-field-selector></li></ul></div><div class="coh-section-main breakpoints" ng-class="{\'no-breakpoints\': !form.breakpoints,\'coh-remove-padding\': form.removePadding}"><div class="breakpoint-icons" ng-if="form.currentBreakpoints.length"><div class="breakpoint-image" ng-repeat="breakpoint in form.currentBreakpoints | orderBy : getBreakpointWidth : reverse" style="{{\'height:\'+breakpoint.height+\';\'}}"><span class="coh-breakpoint-icon {{::\'coh-icon-\' + breakpoint.iconName}}"></span><div class="coh-field-group-row scrollbar-container" coh-scrollbar-container ng-class="{\'coh-scrollbars-horizontal-only\' : !form.disableScrollbar}"><div ng-repeat="fieldset in form.items"><sf-decorator class="section-decorator coh-type-{{item.type}}" form="item" ng-repeat="item in fieldset.items | orderBy: \'weight\' | filter: {\'title\': breakpoint.name}"></sf-decorator></div></div></div></div><div class="coh-field-group-row {{form.columnCount }} scrollbar-container" coh-scrollbar-container ng-if="!form.currentBreakpoints.length" ng-class="[form.breakpointIcon, {\n                \'coh-scrollbars-horizontal-only\' : !form.disableScrollbar\n             }]"><sf-decorator class="section-decorator coh-type-{{item.type}}" form="item" ng-if="!form.breakpointIcon" ng-repeat="item in form.items | orderBy: \'weight\' | filter: { isActive: \'!false\' }"></sf-decorator><div class="coh-breakpoint-icon__fields" ng-if="form.breakpointIcon"><sf-decorator class="section-decorator coh-type-{{item.type}}" form="item" ng-repeat="item in form.items | orderBy: \'weight\' | filter: { isActive: \'!false\' }"></sf-decorator></div></div></div></div>'),e.put("scripts/directives/coh-select-picker/coh-select-picker.html",'<div class="csp-container"><div class="csp-row form-group" ng-repeat="row in csp.aSelectTree"><label for="row-{{$index}}">{{::row.sLabel}}</label> <select name="row-{{$index}}" id="row-{{$index}}" ng-model="csp.aSelectModel[$index]" ng-change="csp.hnSelectChange($index+1)" ng-options="item.sValue as item.sLabel for item in row.aOptions"></select></div><div class="coh-is-loading coh-preloader-small" ng-if="!csp.aSelectTree.length"></div></div>'),e.put("scripts/directives/coh-simple-breakpoints/coh-simple-breakpoints.html",'<div class="coh-breakpoints-dropdown" keyboard-nav on-toggle="toggled(open)" uib-dropdown><button aria-label="Preview breakpoint" class="coh-breakpoints-dropdown-btn" id="coh-breakpoints-dropdown-btn-{{::$id}}" ng-class="csb.hBreakpoints[csb.sSelectedBreakpoint].class || \'coh-icon-responsive\'" tooltip-append-to-body="{{ !csb.showResponsive ? true : undefined }}" tooltip-class="coh-tooltip" tooltip-placement="{{ !csb.showResponsive ? \'top-right\' : \'bottom-right\' }}" type="button" uib-dropdown-toggle uib-tooltip="Preview breakpoint"></button><ul aria-labelledby="coh-breakpoints-dropdown-btn-{{::$id}}" class="dropdown-menu" role="menu" uib-dropdown-menu><li ng-if="csb.showResponsive" ng-class="{\'selected\': !csb.sSelectedBreakpoint}" role="menuitem"><button aria-label="Responsive" aria-pressed="{{!csb.sSelectedBreakpoint}}" class="coh-icon-responsive" ng-click="csb.hnSelectSize()" ng-disabled="!csb.sSelectedBreakpoint" type="button"></button></li><li ng-class="{\'selected\': csb.sSelectedBreakpoint === sSize}" ng-repeat="(sSize, data) in csb.hBreakpoints" role="menuitem"><button aria-label="{{csb.hBreakpoints[sSize].label}}" aria-pressed="{{csb.sSelectedBreakpoint === sSize}}" class="{{csb.hBreakpoints[sSize].class}}" ng-disabled="csb.isDisabled(sSize) || csb.sSelectedBreakpoint === sSize" ng-click="csb.hnSelectSize(sSize)" type="button"></button></li></ul></div>'),e.put("scripts/directives/coh-style-guide-layout/coh-style-guide-layout.html",'<button class="coh-style-guide-preview-toggle" ng-attr-aria-label="{{sglo.previewHidden ? \'Show preview\' : \'Hide preview\'}}" ng-class="sglo.previewHidden ? \'coh-icon-eye\' : \'coh-icon-eye-slash\'" ng-click="sglo.togglePreview()" tooltip-class="coh-tooltip" tooltip-placement="top-right" type="button" uib-tooltip="{{sglo.previewHidden ? \'Show preview\' : \'Hide preview\'}}"></button> <a class="ng-animate-disabled coh-style-guide-preview-external coh-icon-eye-external" aria-label="Open preview in new window" ng-href="{{sglo.popupUrl}}" ng-click="sglo.togglePreview(true)" target="_blank" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Open preview in new window"></a><div class="schema-form-section coh-style-guide-layout ng-animate-disabled" ng-class="[form.htmlClass, sglo.previewHidden ? \'coh-style-guide-preview-hidden\' : \'coh-style-guide-preview-visible\']"><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="form.decoratorClass" ng-repeat="item in form.items | filter: { isActive: \'!false\' }"></sf-decorator></div>'),e.put("scripts/directives/coh-style-guide-list/coh-style-guide-list.html",'<div class="coh-style-guide-list__empty" ng-if="!sgl.styleGuides.length">There are currently no style guides available.</div><div class="coh-style-guide-list__inner" ng-if="sgl.styleGuides.length"><div class="coh-style-guide-list__dropdown" ng-attr-keyboard-nav="{{sglo.isStacked()}}" ng-attr-uib-dropdown="{{sglo.isStacked()}}" ng-class="sglo.isStacked() ? \'dropdown\' : \'\'"><button class="coh-style-guide-list__toggle" ng-if="sglo.isStacked()" type="button" uib-dropdown-toggle>{{sgl.selectedGuide.label}}</button><ul class="coh-style-guide-list__entity-list" ng-attr-uib-dropdown-menu="{{sglo.isStacked()}}" ng-class="sglo.isStacked() ? \'dropdown-menu\' : \'\' "><li class="coh-style-guide-list__entity-list-item" ng-class="{ selected: sgl.selectedGuide.uuid === styleGuide.uuid }" ng-repeat="styleGuide in sgl.styleGuides"><button class="coh-style-guide-list__entity-select-btn" ng-click="sgl.view(styleGuide.uuid)" ng-disabled="sgl.selectedGuide.uuid === styleGuide.uuid" type="button">{{styleGuide.label}}</button></li></ul></div><div class="coh-style-guide-list__form-preview coh-preloader-large" ng-class="sgl.loaded === true ? \'coh-is-loaded\' : \'coh-is-loading\'"><div ng-if="sgl.loaded" sf-schema="sgl.styleGuideForm.schema" sf-form="sgl.styleGuideForm.form" sf-model="sgl.model" class="coh-form-preview-body"></div></div></div>'),e.put("scripts/directives/coh-style-helper-button/coh-style-helper-button.html",'<button type="button" ng-click="" class="coh-btn coh-btn-icon-only {{form.style}} {{form.fieldHtmlClass}}" ng-disabled="form.readonly"><span class="coh-icon-list-ul"></span></button>'),e.put("scripts/directives/coh-style-helper/coh-style-helper.html",'<coh-properties-menu form="csh.form" model="csh.model" options-key="csh.sStyleHelperKey" open-properties-menu-fn="csh.openStyleHelperMenuFn" option-callback="csh.hnOptionCallback"></coh-properties-menu>'),e.put("scripts/directives/coh-style-preview/coh-style-preview.html",'<ul class="coh-accordion-actions coh-style-preview-toolbar"><li class="coh-style-preview-tool coh-accordion-help"><a aria-label="Help and support" class="coh-icon-question-circle" href="{{supportUrlPrefix}}style-builder-style-preview" target="_blank" tooltip-append-to-body="true" tooltip-class="coh-tooltip" uib-tooltip="Help and support"></a></li><li class="coh-style-preview-tool coh-style-preview-refresh" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Refresh preview"><label ng-class="{\'coh-checked\' : bAutoRefresh}"><span class="coh-checkbox-label visually-hidden">Enable auto refresh</span> <span class="coh-checkbox-input-wrapper"><input class="coh-checkbox-input coh-auto-refresh" ng-change="hnRefresh();" ng-model="bAutoRefresh" type="checkbox"></span></label> <button aria-label="Refresh preview" class="coh-icon-refresh {{bActiveRefresh?\'coh-is-active\':\'\'}}" ng-click="hnRefresh();" type="button"></button></li><li class="coh-style-preview-tool coh-style-preview-colour"><div class="coh-colour-picker" tooltip-append-to-body="true" tooltip-class="coh-tooltip" tooltip-placement="top-right" uib-tooltip="Select preview background color"><coh-colour-picker colour="sBackgroundColour" ng-model="oColourModel" spinner-size="\'small\'"></coh-colour-picker></div></li><li class="coh-style-preview-tool coh-breakpoints"><coh-simple-breakpoints h-breakpoints="hBreakpoints" ng-model="sSelectedBreakpoint"></coh-simple-breakpoints></li></ul>'),e.put("scripts/directives/coh-tabs/coh-tabs.html",'<div class="schema-form-tabs coh-schema-form-tabs"><uib-tabset active="active"><uib-tab ng-repeat="tab in ::form.tabs track by $index" index="tab.key" select="updateTab(tab)" deselect="deselectTab()" class="{{ active == tab.key || parentActive == tab.key ? \'active\' : \'\' }} {{ tab.ellipsis === true ? \'nav-tabs-ellipsis\' : \'\' }} {{tab.classes}}" classes="tab.classes" disable="tab.readonly == true || tab.ellipsis === true" ng-if="tab.hasPermission" template-url="scripts/directives/coh-tabs/tab-heading-template.html"><uib-tab-heading><span ng-if="!tab.ellipsis">{{::tab.title}}</span><ul ng-if="tab.ellipsis" uib-dropdown keyboard-nav on-toggle="toggled(open)" class="dropdown"><li><button uib-dropdown-toggle type="button"></button></li><ul class="dropdown-menu" uib-dropdown-menu><li ng-class="{\'active\': activeChild === t.key}" ng-repeat="t in ::tab.items[0][\'tabs\'] track by $index" ng-if="t.hasPermission"><button type="button" ng-if="!t.onClick && !t.drupalDialog" ng-click="selectChildTab(t.key, tab.key, $event)">{{ ::t.title }}</button> <button type="button" ng-if="t.onClick" ng-click="cohTabsOnAction($event, t.onClick)">{{ ::t.title }}</button> <button type="button" ng-if="t.drupalDialog" ng-click="openDrupalDialog($event, t.drupalSettingsUriKey)">{{ ::t.title }}</button></li></ul></ul></uib-tab-heading><div class="coh-tab-pane-{{::tab.key}}" ng-if="tab.loaded"><sf-decorator ng-if="!tab.ellipsis" class="coh-type-{{item.type}}" form="item" ng-repeat="item in ::tab.items | orderBy: \'weight\'"></sf-decorator></div><div ng-if="!tab.loaded" class="coh-empty-tab coh-is-loading coh-preloader-large"></div><uib-tab select="updateTab(t)" deselect="deselectTab()" ng-if="tab.ellipsis && !t.onClick && !t.href" ng-repeat="t in ::tab.items[0][\'tabs\']" index="t.key"><div class="coh-tab-pane-{{::t.key}}" ng-if="t.loaded"><sf-decorator class="coh-type-{{item.type}}" form="item" ng-repeat="item in t.items | orderBy: \'weight\'"></sf-decorator></div><div ng-if="!t.loaded" class="coh-empty-tab coh-is-loading coh-preloader-large"></div></uib-tab></uib-tab></uib-tabset></div>'),e.put("scripts/directives/coh-tabs/tab-heading-template.html",'<li ng-class="[{active: active, disabled: disabled}, classes]" class="uib-tab nav-item"><a class="nav-link" href ng-attr-tabindex="{{disabled || active ? -1 : undefined}}" ng-click="select($event);  $emit(\'cohTabClicked\');" uib-tab-heading-transclude>{{heading}}</a></li>'),e.put("scripts/directives/coh-tags-input/coh-tags-input.html",'<tags-input ng-model="cti.ngModel" display-property="{{ ::cti.options.displayProperty }}" placeholder="{{ ::cti.options.placeholder }}" add-on-blur="{{ ::cti.options.addOnBlur }}" replace-spaces-with-dashes="{{ ::cti.options.replaceSpacesWithDashes }}" add-from-autocomplete-only="{{ ::cti.options.addFromAutocompleteOnly }}" on-tag-added="cti.addTag($tag)" input-id="cti.form.cohIdKey"><div class="coh-tags-autocomplete"><auto-complete source="cti.getTags($query)" select-first-match="{{ cti.options.selectFirstMatch }}"></auto-complete></div></tags-input>'),e.put("scripts/directives/coh-tree-menu-button/coh-tree-menu-button.html",'<button style="min-width:100px;" type="button" class="coh-btn coh-btn-default-parent" ng-click="tmb.openMenu()">{{tmb.currentLevelTitle}}</button>'),e.put("scripts/directives/coh-typeahead/coh-typeahead-popup.html",'<div class="dropdown-menu" ng-show="isOpen() && !moveInProgress" ng-style="{top: position().top+\'px\', left: position().left+\'px\'}" role="listbox" aria-hidden="{{!isOpen()}}"><ul ng-repeat="(key, matchGroup) in matches | groupBy: \'model.group\' track by $index"><li ng-if="key && key !== \'undefined\'" class="coh-group-heading">{{key}}</li><li class="uib-typeahead-match" ng-repeat="match in matchGroup track by match.model.id" ng-class="{active: isActive(match.model.index) }" ng-mouseenter="selectActive(match.model.index)" ng-click="selectMatch(match.model.index || $index, $event)" role="option" id="{{::match.id}}"><div uib-typeahead-match index="match.model.index" match="match" query="query" template-url="templateUrl"></div></li></ul></div>'),e.put("scripts/directives/coh-typeahead/coh-typeahead.html",'<input autocomplete="off" ng-if="ctd.firstLoaded" class="form-control coh-disable-animation" id="{{ctd.form.cohIdKey}}" ng-attr-aria-describedby="{{hasError() ? ctd.form.cohIdKey + \'_error\' : undefined}}" ng-attr-placeholder="{{ctd.placeholder}}" ng-blur="ctd.onBlur()" ng-class="{\'loading\':ctd.loading, \'no-results\':ctd.noResults, \'has-results\':!ctd.noResults, \'first-load\': ctd.firstLoad}" ng-model="ctd.model" type="text" typeahead-input-formatter="ctd.getLabel($model)" typeahead-editable="ctd.typeaheadEditable" typeahead-loading="ctd.loading" typeahead-no-results="ctd.noResults" typeahead-wait-ms="250" typeahead-template-url="{{ctd.templateUrl}}" typeahead-popup-template-url="scripts/directives/coh-typeahead/coh-typeahead-popup.html" uib-typeahead="item[ctd.valueProperty] as item[ctd.labelProperty] for item in ctd.getOptions($viewValue)"> <span class="coh-typeahead-icon coh-icon-circle-o" ng-if="ctd.firstLoaded && !ctd.model && !ctd.loading"></span> <span aria-label="Finding results" class="coh-typeahead-icon coh-is-loading coh-preloader-x-small" ng-if="ctd.firstLoaded && ctd.loading" role="alert"></span> <input autocomplete="off" ng-if="!ctd.firstLoaded" type="text" class="form-control coh-typeahead loading coh-disable-animation" readonly="readonly">'),e.put("scripts/directives/coh-var-name-tag/coh-var-name-tag.html",'<pre class="coh-variable-label ng-animate-disabled" ng-class="{\'coh-variable-label-full\': cvnt.full}" ng-click="cvnt.full = !cvnt.full" tabindex="-1">{{cvnt.getVariableName()}}<span ng-if="cvnt.showEllipses">&hellip;</span></pre>'),e.put("scripts/directives/coh-var-switcher/coh-var-switcher.html",'<div ng-if="!dir.disable && form.type !== \'section\' && form.type !== \'cohSection\'" ng-show="dir.isVariableMode" class="input-group coh-variable-input-group ng-animate-disabled"><input class="form-control coh-variable-input ng-animate-disabled" coh-component-variable-formatter id="{{dir.cohIdKey + \'_var\'}}" placeholder="{{dir.variablePlaceholder}}" type="text" ng-model="dir.variableModeModel" ng-model-options="{ getterSetter: true }" ng-mouseenter="dir.showTooltip = true" ng-mouseleave="dir.showTooltip = false" ng-if="dir.isVariableMode"> <span ng-if="form.notComponentField && dir.isVariableMode" class="input-group-addon input-group-addon--right coh-component-var-warning" tooltip-append-to-body="true" tooltip-class="coh-tooltip coh-tooltip--component-warning" tooltip-is-open="dir.showTooltip" tooltip-placement="top-right" uib-tooltip="This field cannot be linked to a component form field"><span class="coh-icon-exclamation-triangle"></span> </span><span ng-if="dir.getVariableName()" class="input-group-addon input-group-addon--right coh-valid-var"><span class="coh-icon-check-circle"></span></span></div><coh-var-name-tag ng-if="!dir.hideLabel && !dir.isVariableMode && dir.hasVariable()" field-data="dir" class="ng-animate-disabled"></coh-var-name-tag>'),e.put("scripts/directives/coh-variable-button/coh-variable-button.html",""),e.put("scripts/directives/coh-wysiwyg/coh-wysiwyg.html",""),e.put("scripts/directives/coh-youtube-embed/coh-youtube-embed.html",'<div class="coh-youtube-embed-preview"><div class="coh-youtube-embed-preview-container" ng-class="{\'no-preview\': !cye.previewUrl}"><label class="control-label">Preview<div class="coh-youtube-embed-preview-container-inner"><p ng-if="!cye.previewUrl">No preview available</p><iframe autoplay="0" controls="0" frameborder="0" height="316" ng-class="{\n                            \'has-error\' : cye.form.disableErrorState !== true && hasError(),\n                            \'has-success\' : cye.form.disableSuccessState !== true && hasSuccess(),\n                            \'has-feedback\' : cye.form.feedback !== false\n                        }" ng-if="cye.previewUrl" ng-src="{{cye.previewUrl | trustUrl}}" rel="0" type="text/html" width="100%"></iframe></div></label></div></div>'),e.put("scripts/form-elements/coh-accordion/coh-accordion.html",'<coh-accordion class="coh-accordion" form="form[0]" sf-decorator></coh-accordion>'),e.put("scripts/form-elements/coh-array/coh-array.html",'<div class="coh-array" coh-form-model-manager coh-id-tagger form="form" ng-class="form.htmlClass" ng-if="!form.condition" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" for="{{form.key.slice(-1)[0]}}" ng-class="[form.labelHtmlClass, {\'visually-hidden\': form.noTitle}]" ng-if="::form.title">{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-{{form.type}}"><coh-array form="form" model="model" ng-model="$$value$$" sf-field-model="replaceAll"></coh-array></div></div></div></div>'),e.put("scripts/form-elements/coh-available-color-select/coh-available-color-select.html",'<div coh-form-model-manager form="form" class="form-group coh-textarea has-feedback {{::form.htmlClass}}" ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess()}" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label {{::form.labelHtmlClass}}" ng-class="::{\'visually-hidden\': form.noTitle, \'coh-required\' : form.required}" for="{{ form.key | join:\'-\' }}">{{::form.title}}</label><coh-available-color-select ng-model="$$value$$" model="model" form="form" schema-validate="form"></coh-available-color-select></div></div>'),e.put("scripts/form-elements/coh-breakpoint-fieldset/coh-breakpoint-fieldset.html",'<div class="coh-breakpoint-fieldset {{form.htmlClass}}"><div class="form-group-inner"><fieldset ng-disabled="form.readonly" class="schema-form-fieldset"><legend class="visually-hidden">{{ form.title }}</legend><sf-decorator class="field coh-type-{{item.type}}" ng-repeat="item in form.items | filter: { isActive: \'!false\' }" form="item"></sf-decorator></fieldset></div></div>'),e.put("scripts/form-elements/coh-button/coh-button.html",""),e.put("scripts/form-elements/coh-canvas-preview/coh-canvas-preview.html",'<div><coh-canvas-preview ng-hide="form.options.hideIframe" options="form.options" class="ng-animate-disabled"></coh-canvas-preview></div>'),e.put("scripts/form-elements/coh-checkbox-group/coh-checkbox-group.html",'<div class="schema-form-section {{form.htmlClass}} coh-toggle-group" coh-checkbox-group><fieldset class="coh-toggle-group__fieldset" ng-if="form.title"><legend class="coh-toggle-group__legend">{{form.title}}</legend><sf-decorator ng-repeat="item in form.items | orderBy: \'items[0].title\'" class="coh-type-{{item.type}}" form="item"></sf-decorator></fieldset><sf-decorator ng-if="!form.title" ng-repeat="item in form.items | orderBy: \'items[0].title\'" class="coh-type-{{item.type}}" form="item"></sf-decorator></div>'),e.put("scripts/form-elements/coh-checkbox-toggle/coh-checkbox-toggle.html",'<div class="form-group ng-animate-disabled coh-checkbox-toggle" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner" ng-class="{\'coh-inline-label\' : form.inlineLabel}"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\'visually-hidden\' : form.noTitle}]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-checkbox-toggle form="form" model="$$value$$" ng-model="$$value$$" sf-field-model="replaceAll"></coh-checkbox-toggle></div><code ng-class="{\'coh-machine-name-error\' : !form.machineName}" ng-if="form.showMachineName">{{ !form.machineName ? \'[Machine name not set]\' : \'[field.\' + form.machineName + \']\' }}</code><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator></div></div>'),e.put("scripts/form-elements/coh-checkbox/coh-checkbox.html",'<div coh-id-tagger coh-form-model-manager form="form" class="form-group coh-checkbox" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label ng-show="dir.isVariableMode" coh-tag-for class="control-label {{form.labelHtmlClass}}" ng-show="showTitle()">{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><div class="checkbox schema-form-checkbox {{form.htmlClass}}" ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess()}"><label class="{{form.labelHtmlClass}}"><input type="checkbox" sf-changed="form" ng-disabled="$eval(form.readonly.toString())" sf-field-model="replaceAll" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" class="{{form.fieldHtmlClass}}" coh-tag-id> <span ng-bind-html="form.title"></span></label></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-colour-picker-opener/coh-colour-picker-opener.html",'<div class="form-group coh-colour-picker-opener ng-animate-disabled" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\'visually-hidden\' : form.noTitle}]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div class="coh-form-input ng-animate-disabled" ng-class="{\'coh-has-var-switcher\' : !dir.disable}" ng-if="!dir.isVariableMode"><coh-colour-picker-opener form="form" ng-model="$$value$$" options="form.options" schema-validate="form" sf-field-model="replaceAll"></coh-colour-picker-opener></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-colour-picker/coh-colour-picker.html",'<div class="form-group ng-animate-disabled coh-colour-picker" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\'visually-hidden\' : form.noTitle}]" ng-if="::form.title">{{::form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-colour-picker form="form" id="{{form.cohIdKey}}" ng-model="$$value$$" options="form.colourPickerOptions" schema-validate="form" sf-field-model="replaceAll" spinner-size="\'medium\'"></coh-colour-picker></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-combi-box/coh-combi-box-text.html",'<div class="form-group schema-form-{{form.type}} {{form.htmlClass}}" ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess(), \'has-feedback\': form.feedback !== false }"><label class="control-label {{form.labelHtmlClass}}" ng-class="{\'visually-hidden\': form.noTitle}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-show="form.key" type="{{form.type}}" step="any" sf-changed="form" placeholder="{{form.placeholder}}" class="form-control {{form.fieldHtmlClass}}" id="{{form.key[0]+\':\'+randIdKey}}" ng-model-options="form.ngModelOptions" ng-model="$$value$$" ng-disabled="$eval(form.readonly.toString())" schema-validate="form" name="{{form.key.slice(-1)[0]}}" aria-describedby="{{form.key.slice(-1)[0] + \'Status\'}}"><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\': (form.fieldAddonLeft || form.fieldAddonRight)}"><span ng-if="form.fieldAddonLeft" class="input-group-addon input-group-addon--left" ng-bind-html="form.fieldAddonLeft"></span> <input ng-show="form.key" type="{{form.type}}" step="any" sf-changed="form" placeholder="{{form.placeholder}}" class="form-control {{form.fieldHtmlClass}}" id="{{form.key[0]+\':\'+randIdKey}}" test="test" ng-model-options="form.ngModelOptions" ng-model="$$value$$" ng-disabled="$eval(form.readonly.toString())" schema-validate="form" name="{{form.key.slice(-1)[0]}}" aria-describedby="{{form.key.slice(-1)[0] + \'Status\'}}"> <span ng-if="form.fieldAddonRight" class="input-group-addon input-group-addon--right" ng-bind-html="form.fieldAddonRight"></span></div><span ng-if="hasError() || hasSuccess()" id="{{form.key.slice(-1)[0] + \'Status\'}}" class="visually-hidden">{{ hasSuccess() ? \'(success)\' : \'(error)\' }}</span><div class="help-block" ng-class="{\'coh-form-hidden\': !form.description}" sf-message="form.description"></div></div>'),e.put("scripts/form-elements/coh-combi-box/coh-combi-box.html",'<div coh-form-model-manager form="form" class="coh-combi-box form-group" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-id-tagger coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label coh-tag-for>{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><sf-decorator ng-repeat="item in form.items" class="coh-type-{{item.type}}" form="item"></sf-decorator></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-component-form/coh-component-form.html",'<div class="coh-form-builder"><coh-component-form sf-decorator></coh-component-form></div>'),e.put("scripts/form-elements/coh-component-translation-settings/coh-component-translation-settings.html",'<coh-component-translation-settings form="form" model="model" sf-field-model="replaceAll"></coh-component-translation-settings>'),e.put("scripts/form-elements/coh-context-edit-component/coh-context-edit-component.html",'<coh-context-edit-wrapper><sf-decorator ng-repeat="item in form.items" class="coh-type-{{item.type}}" form="item"></sf-decorator></coh-context-edit-wrapper>'),e.put("scripts/form-elements/coh-custom-select/coh-custom-select.html",'<div coh-id-tagger coh-form-model-manager form="form" class="form-group coh-custom-select" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label {{form.labelHtmlClass}}" ng-class="{\'visually-hidden\': form.noTitle}" coh-tag-for>{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><select coh-tag-id sf-field-model schema-validate="form" placeholder="{{form.placeholder}}"><option ng-if="form.placeholder" disabled="disabled" selected="selected" value>{{form.placeholder}}</option><option ng-repeat="option in form.selectOptions" value="{{option.value}}">{{option.label}}</option></select></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-custom-settings-button/coh-custom-settings-button.html",'<div class="form-group schema-form-submit coh-custom-settings-button {{form.htmlClass}}"><div class="form-group-inner"><button class="coh-btn {{form.style}} {{form.fieldHtmlClass}}" ng-disabled="$eval(form.readonly.toString())"><span>Options</span> <span class="coh-icon-cog"></span></button></div></div>'),e.put("scripts/form-elements/coh-element-settings/coh-element-settings.html","<coh-element-settings></coh-element-settings>"),e.put("scripts/form-elements/coh-entity-browser/coh-entity-browser.html","<div class=\"form-group coh-entity-browser-group\" coh-id-tagger ng-class=\"[\n        dir.hasVariable() ? 'coh-has-variable' : 'coh-no-variable',\n        dir.isVariableMode ? 'coh-input-variable-mode' : 'coh-not-variable-mode'\n"+'     ]" ng-if="!clc.loading && (!form.condition || form.isVariableMode)"><div class="ng-animate-disabled"><coh-entity-browser form="form" model="model" ng-show="!dir.isVariableMode" ng-model="$$value$$" sf-field-model="replaceAll"></coh-entity-browser><div><label class="control-label" ng-if="dir.isVariableMode  || !dir.isVariableMode && dir.hasVariable()" coh-tag-for-attr><coh-label-text tt-text="::form.entityBrowserTooltipText" tt-place="::form.entityBrowserTooltipPlacement" tt-label="::\'Entity browser\'"></coh-label-text></label><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator></div></div></div>'),e.put("scripts/form-elements/coh-entity-picker/coh-entity-picker.html","<div class=\"form-group\" coh-id-tagger ng-class=\"[\n        dir.hasVariable() ? 'coh-has-variable' : 'coh-no-variable',\n        dir.isVariableMode ? 'coh-input-variable-mode' : 'coh-not-variable-mode'\n"+'     ]" ng-if="!clc.loading && (!form.condition || form.isVariableMode)"><div class="ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-entity-picker form="form" model="model" ng-model="$$value$$" sf-field-model="replaceAll"></coh-entity-picker></div><label class="control-label" coh-tag-for-attr ng-if="dir.isVariableMode || !dir.isVariableMode && dir.hasVariable()"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::\'Entity reference picker\'"></coh-label-text></label><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator></div>'),e.put("scripts/form-elements/coh-field-machine-name/coh-field-machine-name.html",'<div class="form-group ng-animate-disabled coh-text-box" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[form.htmlClass]" ng-if="!form.condition" sf-field-model="replaceAll"><div class="form-group-inner" ng-class="{\'coh-inline-label\' : form.inlineLabel}"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div class="coh-form-input ng-animate-disabled"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }"><coh-field-machine-name class="coh-field-machine-name" form="form" model="model" ng-model="$$value$$"></coh-field-machine-name></div></div><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-file-browser/coh-file-browser.html",'<div class="form-group coh-file-browser has-feedback" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\', {\n        \'has-error\' : form.disableErrorState !== true && hasError(),\n        \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n        \'coh-file-browser-type-image\' : form.options.imageUploader === true,\n        \'coh-file-browser-type-button\' : form.options.imageUploader === false\n     }]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><div class="coh-file-browser-label"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                       \'visually-hidden\' : form.noTitle,\n                       \'coh-required\' : form.required\n                   }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label> <button class="coh-file-browser-remove" ng-attr-aria-label="{{!form.options.removeLabel || form.options.imageUploader === true ? \'Remove\' : undefined}}" ng-click="remove()" ng-if="preview.path && !dir.isVariableMode" type="button">{{form.options.imageUploader !== true ? form.options.removeLabel : undefined}}</button></div><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-file-browser form="form" name="{{form.key[form.key.length-1]}}" ng-model="$$value$$" options="form.options" preview="preview" remove="remove" sf-field-model="replaceAll" schema-validate="form" sf-changed="form"></coh-file-browser></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-file-uploader/coh-file-uploader.html",'<div class="form-group coh-file-uploader has-feedback" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\', {\n        \'has-error\' : form.disableErrorState !== true && hasError(),\n        \'has-success\' : form.disableSuccessState !== true && hasSuccess()\n     }]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title">{{::form.title}}<coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-file-uploader form="form" form-model="model" name="{{form.key[form.key.length-1]}}" ng-model="$$value$$" options="form.options" sf-field-model="replaceAll"></coh-file-uploader></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-form-builder/coh-form-builder.html",'<div class="coh-form-builder"><coh-form-builder></coh-form-builder></div>'),e.put("scripts/form-elements/coh-form-button/coh-form-button.html",'<button ng-if="!form.condition" class="{{form.style}} {{form.fieldHtmlClass}} {{form.iconClass && !form.title ? \'coh-btn-icon-only\' : \'\'}}" ng-attr-aria-label="{{ form.ariaLabel }}" ng-attr-tooltip-append-to-body="{{ form.tooltipAppendBody }}" ng-attr-tooltip-class="{{ form.tooltipClass }}" ng-attr-tooltip-placement="{{ form.tooltipPlacement }}" ng-attr-uib-tooltip="{{ form.tooltip }}" ng-click="buttonClick($event,form)" ng-disabled="$eval(form.readonly.toString()) || $eval(form.disabled.toString())" type="button"><span ng-if="form.title && !form.hideText">{{form.title}}</span> <span ng-if="form.iconClass" class="{{form.iconClass}}"></span></button>'),e.put("scripts/form-elements/coh-form-header-message/coh-form-header-message.html",'<div class="coh-modal-banner coh-form-header-message {{::form.htmlClass}}" ng-if="::!form.condition"><div class="coh-modal-banner-inner"><strong>{{::form.titleText}}</strong> <span>{{::form.bannerText}}</span> <a ng-href="{{::form.cta.href}}" ng-if="form.cta.href && form.cta.text" target="{{::form.cta.target}}">{{::form.cta.text}} <span ng-if="form.cta.target === \'_blank\'" class="coh-icon-external-link-square"></span></a></div></div>'),e.put("scripts/form-elements/coh-form-preview/coh-form-preview.html",'<coh-form-preview ng-if="!clc.loading" ng-model="model" ng-change="clc.modelChange()" form="form" options="form.options"></coh-form-preview>'),e.put("scripts/form-elements/coh-front-end-edit-component/coh-front-end-edit-component.html",'<coh-front-end-edit-wrapper><sf-decorator ng-repeat="item in form.items" class="coh-type-{{item.type}}" form="item"></sf-decorator></coh-front-end-edit-wrapper>'),e.put("scripts/form-elements/coh-google-marker/coh-google-marker.html","<div class=\"form-group\" coh-id-tagger ng-class=\"[\n        dir.hasVariable() ? 'coh-has-variable' : 'coh-no-variable',\n        dir.isVariableMode ? 'coh-input-variable-mode' : 'coh-not-variable-mode'\n"+'     ]"><label class="control-label" coh-tag-for-attr ng-if="dir.isVariableMode"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::\'Latitude, longitude\'"></coh-label-text></label><div ng-if="!dir.isVariableMode"><coh-google-marker form="form" model="model" ng-model="$$value$$" schema-validate="form" coh-form-model-manager><coh-var-name-tag class="coh-var-switcher-transcluded" field-data="dir" ng-if="!dir.isVariableMode && dir.hasVariable()"></coh-var-name-tag><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></coh-google-marker></div><coh-var-switcher hide-tag="true"></coh-var-switcher></div>'),e.put("scripts/form-elements/coh-gradient-picker/coh-gradient-picker.html",'<div coh-id-tagger coh-form-model-manager form="form" class="form-group coh-gradient-picker" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label {{form.labelHtmlClass}}" ng-class="{\'visually-hidden\': form.noTitle}" coh-tag-for>{{form.title}}<coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-gradient-picker ng-model="$$value$$" form="form" options="form.options" sf-field-model="replaceAll"></coh-gradient-picker></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-helper-switcher/coh-helper-switcher.html",'<div class="form-group coh-helper-switcher {{form.htmlClass}}"><div class="form-group-inner"><coh-helper-switcher></coh-helper-switcher></div></div>'),e.put("scripts/form-elements/coh-helptext/coh-helptext.html",'<div class="form-group" ng-attr-coh-remove-on-click="{{form.options.showClose ? \'\' : undefined}}" ng-class="form.htmlClass"><div class="form-group-inner"><div class="coh-help-text {{form.options.helpType}}" sf-field-model="replaceAll"><button arial-label="Close" class="coh-help-text__close" ng-click="remove(form.key)" ng-if="form.options.showClose" type="button"></button><div class="coh-help-text__inner" markdown-it="form.options.helpText" ng-if="form.options.helpText && !form.options.markdownLegend && !form.options.visibilityLegend"></div><details class="coh-help-text__inner coh-help-text__inner--markdown" ng-if="!form.options.helpText && form.options.markdownLegend"><summary class="coh-help-text__summary"><h3 class="coh-help-text__h3">Formatting options</h3></summary><p>You can format your help text with the following syntax:</p><dl class="coh-help-text__dl"><div class="coh-help-text__div coh-help-text__div--header"><h4 class="coh-help-text__h4 coh-help-text__h4--type">Type</h4><h4 class="coh-help-text__h4 coh-help-text__h4--desc">Description</h4><h4 class="coh-help-text__h4 coh-help-text__h4--example">Example</h4></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Heading</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><code>#</code><span>followed by</span><code>space</code><span>, text.</span></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code># Heading</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Bold</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><code>**</code><span>followed by text, followed by</span><code>**</code></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>**Bold**</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Italic</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><code>*</code><span>followed by text, followed by</span><code>*</code></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>*Italic*</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Ordered list</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><span>Number followed by</span><code>.</code>, <code>space</code><span>, text.</span></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>1. List item</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Unordered list</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><code>-</code><span>followed by</span><code>space</code><span>, text.</span></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>- List item</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type">Link</dt><dd class="coh-help-text__dd coh-help-text__dd--desc"><span>Link text in</span><code>[]</code><span>, URL in</span><code>()</code><span>.</span></dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[Text](http://url.com)</code></dd></div></dl></details><details class="coh-help-text__inner coh-help-text__inner--visibility" ng-if="!form.options.helpText && form.options.visibilityLegend"><summary class="coh-help-text__summary"><h3 class="coh-help-text__h3">Condition options</h3></summary><p>You can add visibility conditions to this field using the following syntax:</p><dl class="coh-help-text__dl"><div class="coh-help-text__div coh-help-text__div--header"><h4 class="coh-help-text__h4 coh-help-text__h4--type">Value/operator</h4><h4 class="coh-help-text__h4 coh-help-text__h4--desc">Description</h4><h4 class="coh-help-text__h4 coh-help-text__h4--example">Example</h4></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>[field.one]</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Form field value</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] == \'foo\'</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>3</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Number value</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] == 3</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>\'foo\'</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">String value</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] == \'foo\'</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is equal to</code> or <code>==</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Equal to</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] == [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is not equal to</code> or <code>!=</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Not equal to</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] != [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is lt</code> or <code>&lt;</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Less than</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] &lt; [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is gt</code> or <code>&gt;</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Greater than</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] &gt; [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is lte</code> or <code>&lt;=</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Less than or equal to</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] is lte [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>is gte</code> or <code>&gt;=</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Greater than or equal to</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] is gte [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>AND</code> or <code>&&</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">And</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] AND [field.two]</code></dd></div><div class="coh-help-text__div"><dt class="coh-help-text__dt coh-help-text__dt--type"><code>OR</code>or<code>||</code></dt><dd class="coh-help-text__dd coh-help-text__dd--desc">Or</dd><dd class="coh-help-text__dd coh-help-text__dd--example"><code>[field.one] OR [field.two]</code></dd></div></dl></details></div></div></div>'),e.put("scripts/form-elements/coh-hidden/coh-hidden.html",'<input coh-form-model-manager type="hidden" model="model" form="form" ng-value="$$value$$" sf-field-model="replaceAll" name="{{form.key.slice(-1)[0]}}">'),e.put("scripts/form-elements/coh-icon-picker-opener/coh-icon-picker-opener.html",'<div class="form-group coh-icon-picker-opener" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label {{form.labelHtmlClass}}" coh-tag-for-attr ng-class="{\'visually-hidden\': form.noTitle}"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div class="coh-form-input ng-animate-disabled" ng-class="{\'coh-has-var-switcher\' : !dir.disable}" ng-show="!dir.isVariableMode"><div class="schema-form-{{form.type}}" ng-class="{\n                    \'has-error\': form.disableErrorState !== true && hasError(),\n                    \'has-success\': form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\': form.feedback !== false\n                 }"><coh-icon-picker-opener ng-model="$$value$$" sf-field-model="replaceAll" form="form"></coh-icon-picker-opener></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" ng-if="hasError()" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-icon-picker/coh-icon-picker.html",'<div coh-form-model-manager form="form" class="form-group coh-icon-picker" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label ng-class="{\'visually-hidden\': form.noTitle}" coh-tag-for>{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-icon-picker model="$$value$$" sf-field-model="replaceAll" form="form"></coh-icon-picker></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-layout-canvas/coh-layout-canvas.html",'<coh-layout-canvas ng-if="!clc.loading" ng-model="model" form="form" options="form.options"></coh-layout-canvas>'),e.put("scripts/form-elements/coh-media-embed/coh-media-embed.html",'<div class="form-group coh-media-embed" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }" ng-if="!dir.isVariableMode"><input class="form-control" coh-unique-value id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text"><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\': (form.fieldAddonLeft || form.fieldAddonRight)}"><span class="input-group-addon input-group-addon--left" ng-if="form.fieldAddonLeft" ng-bind-html="form.fieldAddonLeft"></span> <input class="form-control" id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text" unique-value="$$value$$"> <span class="input-group-addon input-group-addon--right" ng-if="form.fieldAddonRight" ng-bind-html="form.fieldAddonRight"></span></div><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><coh-media-embed form="form" model="model" ng-if="!dir.isVariableMode" ng-model="ngModel"></coh-media-embed></div></div></div>'),e.put("scripts/form-elements/coh-modal-section/coh-modal-section.html",'<div class="form-group" ng-class="form.htmlClass"><div class="form-group-inner"><coh-modal-section form="form" sf-field-model="replaceAll" ng-model="$$value$$" form-model="model"><sf-decorator ng-repeat="item in form.items" class="coh-type-{{item.type}}" form="item"></sf-decorator></coh-modal-section></div></div>'),e.put("scripts/form-elements/coh-multi-button/coh-multi-button.html",'<coh-multi-button ng-model="$$value$$" model="model" form="form" schema-validate="form"></coh-multi-button>'),e.put("scripts/form-elements/coh-number/coh-number.html",'<div class="form-group ng-animate-disabled coh-number" coh-form-model-manager coh-id-tagger coh-is-active form="form" model="$$value$$" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner" form="form" model="$$value$$"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title">{{::form.title}}<coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-if="!dir.isVariableMode"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }"><input class="form-control" coh-number-validator id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-min="{{form.schema.minimum}}" ng-attr-max="{{form.schema.maximum}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="{{form.schema.multipleOf ? form.schema.multipleOf : \'any\'}}" type="{{form.type}}"><div ng-class="{\'input-group\': (form.fieldAddonLeft || form.fieldAddonRight)}" ng-if="form.fieldAddonLeft || form.fieldAddonRight"><span class="input-group-addon input-group-addon--left" ng-bind-html="form.fieldAddonLeft" ng-if="form.fieldAddonLeft"></span> <input class="form-control" coh-number-validator id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-min="{{form.schema.minimum}}" ng-attr-max="{{form.schema.maximum}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="{{form.step ? form.step : \'any\'}}" type="{{form.type}}"> <span class="input-group-addon input-group-addon--right" ng-bind-html="form.fieldAddonRight" ng-if="form.fieldAddonRight"></span></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-picker-menu/coh-picker-menu-form-element.html","<coh-picker-menu></coh-picker-menu>"),e.put("scripts/form-elements/coh-radios/coh-radios.html",'<div coh-form-model-manager form="form" class="form-group coh-radio" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" coh-is-active ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" class="control-label {{form.labelHtmlClass}}" ng-show="showTitle()">{{form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><div class="schema-form-radios" ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess()}"><div class="radio" ng-repeat="item in form.titleMap"><label><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-value="item.value" name="{{form.key.join(\'.\')}}"> <span ng-bind-html="item.name"></span></label></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span ng-if="hasError()" class="coh-description" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-range/coh-range.html",'<div class="form-group ng-animate-disabled coh-range" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\', {\n        \'has-error\' : form.disableErrorState !== true && hasError(),\n        \'has-success\' : form.disableSuccessState !== true && hasSuccess()\n     }]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-range ng-model="$$value$$" sf-field-model="replaceAll" sf-decorator ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}"><output class="coh-range-output" ng-bind-html="getValueLabel($$value$$)" sf-field-model="replaceAll"></output><input class="form-control coh-range-input" id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="initialised" ng-model="initialRangeVal" ng-show="form.key" step="{{form.step}}" min="{{form.min}}" max="{{form.max}}" type="range"></coh-range></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-section/coh-section.html",'<coh-section class="coh-section" ng-class="{\'coh-remove-padding\': form.removePadding}" ng-if="!form.condition || form.isVariableMode" coh-var-switch-watcher></coh-section>'),e.put("scripts/form-elements/coh-section/section-template.html",'<div class="schema-form-section" ng-class="form.htmlClass" ng-if="!form.condition || form.isVariableMode" coh-var-switch-watcher><sf-decorator class="coh-type-{{item.type}}" form="item" ng-class="form.decoratorClass" ng-repeat="item in form.items | filter: { isActive: \'!false\' }"></sf-decorator></div>'),e.put("scripts/form-elements/coh-select-picker/coh-select-picker.html",'<coh-select-picker model="model" form="form" first-label="form.firstLabel"></coh-select-picker>'),e.put("scripts/form-elements/coh-select/coh-select.html",'<div class="form-group ng-animate-disabled coh-select" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\': form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><div class="schema-form-select" ng-class="{\n                    \'has-error\': form.disableErrorState !== true && hasError(),\n                    \'has-success\': form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\': form.feedback !== false\n                 }"><div class="coh-is-loading coh-preloader-small" ng-show="form.loading"></div><div ng-show="!form.loading"><select array-index="arrayIndex" id="{{form.cohIdKey}}" class="form-control {{ form.key | join:\'-\' }}" coh-options-getter form="form" model="model" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-options="{{\'item.value as item.label group by item.group disable when item.disabled for item in form.options | orderBy: [\\\'-group\\\']\'}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" schema-validate="form" sf-changed="form" sf-field-model="replaceAll"></select></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-style-builder-menu/coh-style-builder-menu.html","<coh-blades-menu></coh-blades-menu>"),e.put("scripts/form-elements/coh-style-guide-layout/coh-style-guide-layout.html","<coh-style-guide-layout sf-decorator></coh-style-guide-layout>"),e.put("scripts/form-elements/coh-style-guide-list/coh-style-guide-list.html",'<coh-style-guide-list class="coh-style-guide-list" sf-decorator></coh-style-guide-list>'),e.put("scripts/form-elements/coh-style-helper-button/coh-style-helper-button.html",'<div aria-label="Open style helper menu" class="form-group coh-style-helper-btn {{form.htmlClass}}"><div class="form-group-inner"><coh-style-helper-button></coh-style-helper-button></div></div>'),e.put("scripts/form-elements/coh-submit/coh-submit.html",'<div class="form-group schema-form-submit {{form.htmlClass}}"><div class="form-group-inner"><input type="submit" class="coh-btn {{form.style}} {{form.fieldHtmlClass}}" value="{{form.title}}" ng-disabled="$eval(form.readonly.toString())"></div></div>'),e.put("scripts/form-elements/coh-success-label/coh-success-label.html",'<div class="coh-success-label" ng-class="form.htmlClass"><strong class="coh-success-label-title">{{form.title}}</strong> <span class="coh-success-label-icon" sf-field-model="replaceAll" ng-class="{\'coh-icon-check-circle\': $$value$$, \'coh-icon-circle-o\': !$$value$$}"></span></div>'),e.put("scripts/form-elements/coh-tab-container/coh-tab-container.html",'<div class="coh-tab-container" ng-class="{\'coh-tab-container--responsive\' : form.responsiveMode}"><uib-tabset active="::form.items[0].key.join(\'-\')"><li class="coh-tab-item coh-tab-item--ellipsis" ng-class="{\'coh-tabs-visible\' : form.showTabs}" ng-if="form.responsiveMode"><button aria-checked="{{form.showTabs}}" aria-label="{{form.showTabs ? \'Hide other tabs\' : \'Show other tabs\'}}" class="coh-icon-ellipsis" coh-auto-focus="cohTabClicked" ng-model="form.showTabs" role="switch" type="button" uib-btn-checkbox></button></li><uib-tab classes="coh-tab-item {{item.breakpointIcon}}" data-form="{{ngModelOptions | json}}" heading="{{item.title}}" index="item.key.join(\'-\')" ng-repeat="item in form.items" select="$broadcast(\'tabSelect\', active); form.showTabs = false" ng-if="!item.condition || $eval(item.condition)" template-url="scripts/directives/coh-tabs/tab-heading-template.html"><div class="coh-tab-content" form="item" sf-decorator></div></uib-tab></uib-tabset></div>'),e.put("scripts/form-elements/coh-tab-item/coh-tab-item.html",'<sf-decorator ng-repeat="item in form.items" class="coh-type-{{item.type}}" form="item"></sf-decorator>'),e.put("scripts/form-elements/coh-tabs/coh-tabs.html","<coh-tabs></coh-tabs>"),e.put("scripts/form-elements/coh-tags-input/coh-tags-input.html",'<div class="form-group ng-animate-disabled coh-tags-input" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title">{{::form.title}}</label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-if="!form.isVariableMode"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }"><coh-tags-input form="form" ng-model="$$value$$" sf-field-model="replaceAll"></coh-tags-input><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\' : (form.fieldAddonLeft || form.fieldAddonRight)}"><span class="input-group-addon" ng-bind-html="form.fieldAddonLeft" ng-if="form.fieldAddonLeft"></span><coh-tags-input form="form" ng-model="$$value$$" sf-field-model="replaceAll"></coh-tags-input><span class="input-group-addon" ng-if="form.fieldAddonRight" ng-bind-html="form.fieldAddonRight"></span></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-text-box/coh-text-box.html",'<div class="form-group ng-animate-disabled coh-text-box" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\',\n        efi.isEdited() ? \'coh-efi-edited\' : \'\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner" ng-class="{\'coh-inline-label\' : form.inlineLabel}"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text><coh-preview-warning-icon ng-if="::form.previewWarningIcon" key="form.key.slice(-1)[0]"></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-if="!form.isVariableMode"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }"><input class="form-control" coh-unique-value id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text"><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\' : (form.fieldAddonLeft || form.fieldAddonRight)}"><span class="input-group-addon input-group-addon--left" ng-bind-html="form.fieldAddonLeft" ng-if="form.fieldAddonLeft"></span> <input class="form-control" id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text" unique-value="$$value$$"> <span class="input-group-addon input-group-addon--right" ng-if="form.fieldAddonRight" ng-bind-html="form.fieldAddonRight"></span></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-textarea/coh-textarea.html",'<div class="form-group ng-animate-disabled coh-textarea" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\', {\n        \'has-error\' : form.disableErrorState !== true && hasError(),\n        \'has-success\' : form.disableSuccessState !== true && hasSuccess()\n     }]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><textarea class="form-control" coh-component-variable-formatter id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" rows="{{:: form.rows}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" sf-changed="form" sf-field-model="replaceAll">\n            </textarea><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\': (form.fieldAddonLeft || form.fieldAddonRight)}"><span ng-if="form.fieldAddonLeft" class="input-group-addon input-group-addon--left" ng-bind-html="form.fieldAddonLeft"></span> <textarea class="form-control" coh-component-variable-formatter id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" sf-changed="form" sf-field-model="replaceAll">\n                </textarea> <span ng-if="form.fieldAddonRight" class="input-group-addon input-group-addon--right" ng-bind-html="form.fieldAddonRight"></span></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\': (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-typeahead/coh-typeahead.html",'<div class="form-group ng-animate-disabled coh-typeahead" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\'coh-required\' : form.required}]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled" ng-show="!dir.isVariableMode"><coh-typeahead form="form" form-model="model" initial-option="form.initialOption" label-property="form.labelProperty" ng-model="$$value$$" ng-if="dir.varSwitcherLoaded" schema-validate="form" sf-changed="form" options="form.typeaheadOptions" placeholder="{{form.placeholder}}" sf-field-model="replaceAll" template-url="form.templateUrl" typeahead-editable="form.typeaheadEditable" value-property="form.valueProperty" variable-mode="dir.isVariableMode"></coh-typeahead></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div></div>'),e.put("scripts/form-elements/coh-variable-button/coh-variable-button.html",'<div class="coh-variable-button form-group schema-form-submit {{form.htmlClass}}"><div class="form-group-inner"><coh-variable-button></coh-variable-button></div></div>'),e.put("scripts/form-elements/coh-workflow-status/coh-workflow-status.html",'<div class="form-group {{form.htmlClass}}"><div class="form-group-inner"><p sf-field-model="replaceAll">Current status: <span class="status">{{:: model.settings.workflowState}}</span></p></div></div>'),e.put("scripts/form-elements/coh-wysiwyg/coh-wysiwyg.html",'<div class="form-group ng-animate-disabled coh-wysiwyg has-feedback" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\', {\n        \'coh-style-preview-container\' : form.isPreview,\n        \'has-error\' : form.disableErrorState !== true && hasError(),\n        \'has-success\' : form.disableSuccessState !== true && hasSuccess()\n     }]" ng-if="!form.condition || form.isVariableMode"><coh-style-preview ng-if="form.isPreview" j-styles="model"></coh-style-preview><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\'visually-hidden\': form.noTitle}]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled coh-wysiwyg-container" ng-disabled ng-show="!dir.isVariableMode"><textarea class="form-control" coh-unique-value coh-wysiwyg form="form" model="$$value$$" ng-disabled="$eval(form.readonly.toString())" id="{{form.instance}}" name="{{form.instance}}" ng-class="form.fieldHtmlClass" ng-model="$$value$$" schema-validate="form" sf-changed="form" sf-field-model="replaceAll">\n            </textarea><div class="coh-wysiwyg-text-format" ng-if="$$value$$" ng-show="formats.length > 1"><div class="coh-wysiwyg-text-format-col coh-wysiwyg-text-format-select"><label><span>Text format</span> <select coh-wysiwyg-format ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$[\'textFormat\']" ng-options="format.value as format.label for format in formats" sf-field-model="replaceAll"></select></label></div><div class="coh-wysiwyg-text-format-col coh-wysiwyg-text-format-link"><a href="/filter/tips" target="_blank" title="About text formats">About text formats</a></div></div></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator></div></div>'),e.put("scripts/form-elements/coh-youtube-embed/coh-youtube-embed.html",'<div class="form-group coh-youtube-embed" coh-form-model-manager coh-id-tagger coh-is-active form="form" ng-class="[\n        form.htmlClass,\n        dir.hasVariable() ? \'coh-has-variable\' : \'coh-no-variable\',\n        dir.isVariableMode ? \'coh-input-variable-mode\' : \'coh-not-variable-mode\'\n     ]" ng-if="!form.condition || form.isVariableMode" sf-field-model="replaceAll"><div class="form-group-inner"><label class="control-label" coh-tag-for-attr ng-class="[form.labelHtmlClass, {\n                   \'visually-hidden\' : form.noTitle,\n                   \'coh-required\' : form.required\n               }]" ng-if="::form.title"><coh-label-text tt-text="::form.tooltipText" tt-place="::form.tooltipPlacement" tt-label="::form.title"></coh-label-text></label><div ng-class="{\'coh-has-var-switcher\' : !dir.disable}" class="coh-form-input ng-animate-disabled"><div class="schema-form-{{::form.type}}" ng-class="{\n                    \'has-error\' : form.disableErrorState !== true && hasError(),\n                    \'has-success\' : form.disableSuccessState !== true && hasSuccess(),\n                    \'has-feedback\' : form.feedback !== false\n                 }" ng-if="!dir.isVariableMode"><input class="form-control" coh-unique-value id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-if="!form.fieldAddonLeft && !form.fieldAddonRight" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text"><div ng-if="form.fieldAddonLeft || form.fieldAddonRight" ng-class="{\'input-group\': (form.fieldAddonLeft || form.fieldAddonRight)}"><span class="input-group-addon input-group-addon--left" ng-if="form.fieldAddonLeft" ng-bind-html="form.fieldAddonLeft"></span> <input class="form-control" id="{{form.cohIdKey}}" name="{{form.key.slice(-1)[0]}}" ng-attr-aria-describedby="{{hasError() ? form.cohIdKey + \'_error\' : undefined}}" ng-attr-aria-required="{{::form.required}}" ng-attr-coh-component-variable-formatter="{{form.variableFormatter ? \'\' : undefined}}" ng-attr-placeholder="{{::form.placeholder}}" ng-class="form.fieldHtmlClass" ng-disabled="$eval(form.readonly.toString())" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-show="form.key" schema-validate="form" sf-changed="form" sf-field-model="replaceAll" step="any" type="text" unique-value="$$value$$"> <span class="input-group-addon input-group-addon--right" ng-if="form.fieldAddonRight" ng-bind-html="form.fieldAddonRight"></span></div><span class="coh-description" id="{{form.cohIdKey + \'_error\'}}" ng-class="{\'coh-form-hidden\' : (hasError() || form.description) === false}" ng-if="hasError()" role="alert" sf-message="form.description"></span></div><coh-var-switcher></coh-var-switcher><coh-edited-field-indicator ng-if="form.trackEdits"></coh-edited-field-indicator><coh-youtube-embed form="form" model="model" ng-if="!dir.isVariableMode" ng-model="$$value$$" sf-field-model="replaceAll"></coh-youtube-embed></div></div></div>')}]);